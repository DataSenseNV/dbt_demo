{{
	config(
		materialized='view',
		alias='VW_F0010',
		schema='JDEDWARDS_DFV',
		tags=['view', 'JDEDWARDS', 'SRC_JDE_COMPANY_TDFV_INCR']
	)
}}
	WITH "DELTA_WINDOW" AS 
	( 
		SELECT 
			  "LWT_SRC"."FMC_BEGIN_LW_TIMESTAMP" AS "FMC_BEGIN_LW_TIMESTAMP"
			, "LWT_SRC"."FMC_END_LW_TIMESTAMP" AS "FMC_END_LW_TIMESTAMP"
		FROM {{ source('JDEDWARDS_MTD', 'FMC_LOADING_WINDOW_TABLE') }} "LWT_SRC"
	)
	, "DELTA_VIEW_FILTER" AS 
	( 
		SELECT 
			  "CDC_SRC"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP"
			, "CDC_SRC"."JRN_FLAG" AS "JRN_FLAG"
			, TO_CHAR('S' ) AS "RECORD_TYPE"
			, "CDC_SRC"."CCCO" AS "CCCO"
			, "CDC_SRC"."CCAN8" AS "CCAN8"
			, "CDC_SRC"."CCNAME" AS "CCNAME"
			, "CDC_SRC"."CCALTC" AS "CCALTC"
			, "CDC_SRC"."CCDFYJ" AS "CCDFYJ"
			, "CDC_SRC"."CCPNC" AS "CCPNC"
			, "CDC_SRC"."CCDOT1" AS "CCDOT1"
			, "CDC_SRC"."CCCRYR" AS "CCCRYR"
			, "CDC_SRC"."CCCRYC" AS "CCCRYC"
			, "CDC_SRC"."CCDOT2" AS "CCDOT2"
			, "CDC_SRC"."CCMCUA" AS "CCMCUA"
			, "CDC_SRC"."CCMCUD" AS "CCMCUD"
			, "CDC_SRC"."CCMCUC" AS "CCMCUC"
			, "CDC_SRC"."CCMCUB" AS "CCMCUB"
			, "CDC_SRC"."CCDPRC" AS "CCDPRC"
			, "CDC_SRC"."CCBKTX" AS "CCBKTX"
			, "CDC_SRC"."CCTXBM" AS "CCTXBM"
			, "CDC_SRC"."CCTXBO" AS "CCTXBO"
			, "CDC_SRC"."CCNWXJ" AS "CCNWXJ"
			, "CDC_SRC"."CCGLIE" AS "CCGLIE"
			, "CDC_SRC"."CCABIN" AS "CCABIN"
			, "CDC_SRC"."CCCALD" AS "CCCALD"
			, "CDC_SRC"."CCDTPN" AS "CCDTPN"
			, "CDC_SRC"."CCPNF" AS "CCPNF"
			, "CDC_SRC"."CCDFF" AS "CCDFF"
			, "CDC_SRC"."CCCRCD" AS "CCCRCD"
			, "CDC_SRC"."CCSMI" AS "CCSMI"
			, "CDC_SRC"."CCSMU" AS "CCSMU"
			, "CDC_SRC"."CCSMS" AS "CCSMS"
			, "CDC_SRC"."CCDNLT" AS "CCDNLT"
			, "CDC_SRC"."CCSTMT" AS "CCSTMT"
			, "CDC_SRC"."CCATCS" AS "CCATCS"
			, "CDC_SRC"."CCALGM" AS "CCALGM"
			, "CDC_SRC"."CCAGEM" AS "CCAGEM"
			, "CDC_SRC"."CCCRDY" AS "CCCRDY"
			, "CDC_SRC"."CCAGR1" AS "CCAGR1"
			, "CDC_SRC"."CCAGR2" AS "CCAGR2"
			, "CDC_SRC"."CCAGR3" AS "CCAGR3"
			, "CDC_SRC"."CCAGR4" AS "CCAGR4"
			, "CDC_SRC"."CCAGR5" AS "CCAGR5"
			, "CDC_SRC"."CCAGR6" AS "CCAGR6"
			, "CDC_SRC"."CCAGR7" AS "CCAGR7"
			, "CDC_SRC"."CCFRY" AS "CCFRY"
			, "CDC_SRC"."CCFRP" AS "CCFRP"
			, "CDC_SRC"."CCNNP" AS "CCNNP"
			, "CDC_SRC"."CCFP" AS "CCFP"
			, "CDC_SRC"."CCAGE" AS "CCAGE"
			, "CDC_SRC"."CCDAG" AS "CCDAG"
			, "CDC_SRC"."CCARPN" AS "CCARPN"
			, "CDC_SRC"."CCAPPN" AS "CCAPPN"
			, "CDC_SRC"."CCARFJ" AS "CCARFJ"
			, "CDC_SRC"."CCAPFJ" AS "CCAPFJ"
			, "CDC_SRC"."CCSGBK" AS "CCSGBK"
			, "CDC_SRC"."CCPTCO" AS "CCPTCO"
			, "CDC_SRC"."CCX1" AS "CCX1"
			, "CDC_SRC"."CCX2" AS "CCX2"
			, "CDC_SRC"."CCUSER" AS "CCUSER"
			, "CDC_SRC"."CCPID" AS "CCPID"
			, "CDC_SRC"."CCUPMJ" AS "CCUPMJ"
			, "CDC_SRC"."CCJOBN" AS "CCJOBN"
			, "CDC_SRC"."CCUPMT" AS "CCUPMT"
			, "CDC_SRC"."CCTSID" AS "CCTSID"
			, "CDC_SRC"."CCTSCO" AS "CCTSCO"
			, "CDC_SRC"."CCTHCO" AS "CCTHCO"
			, "CDC_SRC"."CCAN8C" AS "CCAN8C"
		FROM {{ source('JDEDWARDS_CDC', 'CDC_F0010') }} "CDC_SRC"
		INNER JOIN "DELTA_WINDOW" "DELTA_WINDOW" ON  1 = 1
		WHERE  "CDC_SRC"."CDC_TIMESTAMP" > "DELTA_WINDOW"."FMC_BEGIN_LW_TIMESTAMP" AND "CDC_SRC"."CDC_TIMESTAMP" <= "DELTA_WINDOW"."FMC_END_LW_TIMESTAMP"
	)
	, "DELTA_VIEW" AS 
	( 
		SELECT 
			  "DELTA_VIEW_FILTER"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP"
			, "DELTA_VIEW_FILTER"."JRN_FLAG" AS "JRN_FLAG"
			, "DELTA_VIEW_FILTER"."RECORD_TYPE" AS "RECORD_TYPE"
			, "DELTA_VIEW_FILTER"."CCCO" AS "CCCO"
			, "DELTA_VIEW_FILTER"."CCAN8" AS "CCAN8"
			, "DELTA_VIEW_FILTER"."CCNAME" AS "CCNAME"
			, "DELTA_VIEW_FILTER"."CCALTC" AS "CCALTC"
			, "DELTA_VIEW_FILTER"."CCDFYJ" AS "CCDFYJ"
			, "DELTA_VIEW_FILTER"."CCPNC" AS "CCPNC"
			, "DELTA_VIEW_FILTER"."CCDOT1" AS "CCDOT1"
			, "DELTA_VIEW_FILTER"."CCCRYR" AS "CCCRYR"
			, "DELTA_VIEW_FILTER"."CCCRYC" AS "CCCRYC"
			, "DELTA_VIEW_FILTER"."CCDOT2" AS "CCDOT2"
			, "DELTA_VIEW_FILTER"."CCMCUA" AS "CCMCUA"
			, "DELTA_VIEW_FILTER"."CCMCUD" AS "CCMCUD"
			, "DELTA_VIEW_FILTER"."CCMCUC" AS "CCMCUC"
			, "DELTA_VIEW_FILTER"."CCMCUB" AS "CCMCUB"
			, "DELTA_VIEW_FILTER"."CCDPRC" AS "CCDPRC"
			, "DELTA_VIEW_FILTER"."CCBKTX" AS "CCBKTX"
			, "DELTA_VIEW_FILTER"."CCTXBM" AS "CCTXBM"
			, "DELTA_VIEW_FILTER"."CCTXBO" AS "CCTXBO"
			, "DELTA_VIEW_FILTER"."CCNWXJ" AS "CCNWXJ"
			, "DELTA_VIEW_FILTER"."CCGLIE" AS "CCGLIE"
			, "DELTA_VIEW_FILTER"."CCABIN" AS "CCABIN"
			, "DELTA_VIEW_FILTER"."CCCALD" AS "CCCALD"
			, "DELTA_VIEW_FILTER"."CCDTPN" AS "CCDTPN"
			, "DELTA_VIEW_FILTER"."CCPNF" AS "CCPNF"
			, "DELTA_VIEW_FILTER"."CCDFF" AS "CCDFF"
			, "DELTA_VIEW_FILTER"."CCCRCD" AS "CCCRCD"
			, "DELTA_VIEW_FILTER"."CCSMI" AS "CCSMI"
			, "DELTA_VIEW_FILTER"."CCSMU" AS "CCSMU"
			, "DELTA_VIEW_FILTER"."CCSMS" AS "CCSMS"
			, "DELTA_VIEW_FILTER"."CCDNLT" AS "CCDNLT"
			, "DELTA_VIEW_FILTER"."CCSTMT" AS "CCSTMT"
			, "DELTA_VIEW_FILTER"."CCATCS" AS "CCATCS"
			, "DELTA_VIEW_FILTER"."CCALGM" AS "CCALGM"
			, "DELTA_VIEW_FILTER"."CCAGEM" AS "CCAGEM"
			, "DELTA_VIEW_FILTER"."CCCRDY" AS "CCCRDY"
			, "DELTA_VIEW_FILTER"."CCAGR1" AS "CCAGR1"
			, "DELTA_VIEW_FILTER"."CCAGR2" AS "CCAGR2"
			, "DELTA_VIEW_FILTER"."CCAGR3" AS "CCAGR3"
			, "DELTA_VIEW_FILTER"."CCAGR4" AS "CCAGR4"
			, "DELTA_VIEW_FILTER"."CCAGR5" AS "CCAGR5"
			, "DELTA_VIEW_FILTER"."CCAGR6" AS "CCAGR6"
			, "DELTA_VIEW_FILTER"."CCAGR7" AS "CCAGR7"
			, "DELTA_VIEW_FILTER"."CCFRY" AS "CCFRY"
			, "DELTA_VIEW_FILTER"."CCFRP" AS "CCFRP"
			, "DELTA_VIEW_FILTER"."CCNNP" AS "CCNNP"
			, "DELTA_VIEW_FILTER"."CCFP" AS "CCFP"
			, "DELTA_VIEW_FILTER"."CCAGE" AS "CCAGE"
			, "DELTA_VIEW_FILTER"."CCDAG" AS "CCDAG"
			, "DELTA_VIEW_FILTER"."CCARPN" AS "CCARPN"
			, "DELTA_VIEW_FILTER"."CCAPPN" AS "CCAPPN"
			, "DELTA_VIEW_FILTER"."CCARFJ" AS "CCARFJ"
			, "DELTA_VIEW_FILTER"."CCAPFJ" AS "CCAPFJ"
			, "DELTA_VIEW_FILTER"."CCSGBK" AS "CCSGBK"
			, "DELTA_VIEW_FILTER"."CCPTCO" AS "CCPTCO"
			, "DELTA_VIEW_FILTER"."CCX1" AS "CCX1"
			, "DELTA_VIEW_FILTER"."CCX2" AS "CCX2"
			, "DELTA_VIEW_FILTER"."CCUSER" AS "CCUSER"
			, "DELTA_VIEW_FILTER"."CCPID" AS "CCPID"
			, "DELTA_VIEW_FILTER"."CCUPMJ" AS "CCUPMJ"
			, "DELTA_VIEW_FILTER"."CCJOBN" AS "CCJOBN"
			, "DELTA_VIEW_FILTER"."CCUPMT" AS "CCUPMT"
			, "DELTA_VIEW_FILTER"."CCTSID" AS "CCTSID"
			, "DELTA_VIEW_FILTER"."CCTSCO" AS "CCTSCO"
			, "DELTA_VIEW_FILTER"."CCTHCO" AS "CCTHCO"
			, "DELTA_VIEW_FILTER"."CCAN8C" AS "CCAN8C"
		FROM "DELTA_VIEW_FILTER" "DELTA_VIEW_FILTER"
	)
	, "PREPJOINBK" AS 
	( 
		SELECT 
			  "DELTA_VIEW"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP"
			, "DELTA_VIEW"."JRN_FLAG" AS "JRN_FLAG"
			, "DELTA_VIEW"."RECORD_TYPE" AS "RECORD_TYPE"
			, COALESCE("DELTA_VIEW"."CCCO","MEX_BK_SRC"."KEY_ATTRIBUTE_VARCHAR") AS "CCCO"
			, COALESCE("DELTA_VIEW"."CCAN8", CAST("MEX_BK_SRC"."KEY_ATTRIBUTE_FLOAT" AS FLOAT)) AS "CCAN8"
			, "DELTA_VIEW"."CCNAME" AS "CCNAME"
			, "DELTA_VIEW"."CCALTC" AS "CCALTC"
			, "DELTA_VIEW"."CCDFYJ" AS "CCDFYJ"
			, "DELTA_VIEW"."CCPNC" AS "CCPNC"
			, "DELTA_VIEW"."CCDOT1" AS "CCDOT1"
			, "DELTA_VIEW"."CCCRYR" AS "CCCRYR"
			, "DELTA_VIEW"."CCCRYC" AS "CCCRYC"
			, "DELTA_VIEW"."CCDOT2" AS "CCDOT2"
			, "DELTA_VIEW"."CCMCUA" AS "CCMCUA"
			, "DELTA_VIEW"."CCMCUD" AS "CCMCUD"
			, "DELTA_VIEW"."CCMCUC" AS "CCMCUC"
			, "DELTA_VIEW"."CCMCUB" AS "CCMCUB"
			, "DELTA_VIEW"."CCDPRC" AS "CCDPRC"
			, "DELTA_VIEW"."CCBKTX" AS "CCBKTX"
			, "DELTA_VIEW"."CCTXBM" AS "CCTXBM"
			, "DELTA_VIEW"."CCTXBO" AS "CCTXBO"
			, "DELTA_VIEW"."CCNWXJ" AS "CCNWXJ"
			, "DELTA_VIEW"."CCGLIE" AS "CCGLIE"
			, "DELTA_VIEW"."CCABIN" AS "CCABIN"
			, "DELTA_VIEW"."CCCALD" AS "CCCALD"
			, "DELTA_VIEW"."CCDTPN" AS "CCDTPN"
			, "DELTA_VIEW"."CCPNF" AS "CCPNF"
			, "DELTA_VIEW"."CCDFF" AS "CCDFF"
			, "DELTA_VIEW"."CCCRCD" AS "CCCRCD"
			, "DELTA_VIEW"."CCSMI" AS "CCSMI"
			, "DELTA_VIEW"."CCSMU" AS "CCSMU"
			, "DELTA_VIEW"."CCSMS" AS "CCSMS"
			, "DELTA_VIEW"."CCDNLT" AS "CCDNLT"
			, "DELTA_VIEW"."CCSTMT" AS "CCSTMT"
			, "DELTA_VIEW"."CCATCS" AS "CCATCS"
			, "DELTA_VIEW"."CCALGM" AS "CCALGM"
			, "DELTA_VIEW"."CCAGEM" AS "CCAGEM"
			, "DELTA_VIEW"."CCCRDY" AS "CCCRDY"
			, "DELTA_VIEW"."CCAGR1" AS "CCAGR1"
			, "DELTA_VIEW"."CCAGR2" AS "CCAGR2"
			, "DELTA_VIEW"."CCAGR3" AS "CCAGR3"
			, "DELTA_VIEW"."CCAGR4" AS "CCAGR4"
			, "DELTA_VIEW"."CCAGR5" AS "CCAGR5"
			, "DELTA_VIEW"."CCAGR6" AS "CCAGR6"
			, "DELTA_VIEW"."CCAGR7" AS "CCAGR7"
			, "DELTA_VIEW"."CCFRY" AS "CCFRY"
			, "DELTA_VIEW"."CCFRP" AS "CCFRP"
			, "DELTA_VIEW"."CCNNP" AS "CCNNP"
			, "DELTA_VIEW"."CCFP" AS "CCFP"
			, "DELTA_VIEW"."CCAGE" AS "CCAGE"
			, "DELTA_VIEW"."CCDAG" AS "CCDAG"
			, "DELTA_VIEW"."CCARPN" AS "CCARPN"
			, "DELTA_VIEW"."CCAPPN" AS "CCAPPN"
			, "DELTA_VIEW"."CCARFJ" AS "CCARFJ"
			, "DELTA_VIEW"."CCAPFJ" AS "CCAPFJ"
			, "DELTA_VIEW"."CCSGBK" AS "CCSGBK"
			, "DELTA_VIEW"."CCPTCO" AS "CCPTCO"
			, "DELTA_VIEW"."CCX1" AS "CCX1"
			, "DELTA_VIEW"."CCX2" AS "CCX2"
			, "DELTA_VIEW"."CCUSER" AS "CCUSER"
			, "DELTA_VIEW"."CCPID" AS "CCPID"
			, "DELTA_VIEW"."CCUPMJ" AS "CCUPMJ"
			, "DELTA_VIEW"."CCJOBN" AS "CCJOBN"
			, "DELTA_VIEW"."CCUPMT" AS "CCUPMT"
			, "DELTA_VIEW"."CCTSID" AS "CCTSID"
			, "DELTA_VIEW"."CCTSCO" AS "CCTSCO"
			, "DELTA_VIEW"."CCTHCO" AS "CCTHCO"
			, "DELTA_VIEW"."CCAN8C" AS "CCAN8C"
		FROM "DELTA_VIEW" "DELTA_VIEW"
		INNER JOIN {{ source('JDEDWARDS_MTD', 'MTD_EXCEPTION_RECORDS') }} "MEX_BK_SRC" ON  1 = 1
		WHERE  "MEX_BK_SRC"."RECORD_TYPE" = 'N'
	)
	SELECT 
		  "PREPJOINBK"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP"
		, "PREPJOINBK"."JRN_FLAG" AS "JRN_FLAG"
		, "PREPJOINBK"."RECORD_TYPE" AS "RECORD_TYPE"
		, "PREPJOINBK"."CCCO" AS "CCCO"
		, "PREPJOINBK"."CCAN8" AS "CCAN8"
		, "PREPJOINBK"."CCNAME" AS "CCNAME"
		, "PREPJOINBK"."CCALTC" AS "CCALTC"
		, "PREPJOINBK"."CCDFYJ" AS "CCDFYJ"
		, "PREPJOINBK"."CCPNC" AS "CCPNC"
		, "PREPJOINBK"."CCDOT1" AS "CCDOT1"
		, "PREPJOINBK"."CCCRYR" AS "CCCRYR"
		, "PREPJOINBK"."CCCRYC" AS "CCCRYC"
		, "PREPJOINBK"."CCDOT2" AS "CCDOT2"
		, "PREPJOINBK"."CCMCUA" AS "CCMCUA"
		, "PREPJOINBK"."CCMCUD" AS "CCMCUD"
		, "PREPJOINBK"."CCMCUC" AS "CCMCUC"
		, "PREPJOINBK"."CCMCUB" AS "CCMCUB"
		, "PREPJOINBK"."CCDPRC" AS "CCDPRC"
		, "PREPJOINBK"."CCBKTX" AS "CCBKTX"
		, "PREPJOINBK"."CCTXBM" AS "CCTXBM"
		, "PREPJOINBK"."CCTXBO" AS "CCTXBO"
		, "PREPJOINBK"."CCNWXJ" AS "CCNWXJ"
		, "PREPJOINBK"."CCGLIE" AS "CCGLIE"
		, "PREPJOINBK"."CCABIN" AS "CCABIN"
		, "PREPJOINBK"."CCCALD" AS "CCCALD"
		, "PREPJOINBK"."CCDTPN" AS "CCDTPN"
		, "PREPJOINBK"."CCPNF" AS "CCPNF"
		, "PREPJOINBK"."CCDFF" AS "CCDFF"
		, "PREPJOINBK"."CCCRCD" AS "CCCRCD"
		, "PREPJOINBK"."CCSMI" AS "CCSMI"
		, "PREPJOINBK"."CCSMU" AS "CCSMU"
		, "PREPJOINBK"."CCSMS" AS "CCSMS"
		, "PREPJOINBK"."CCDNLT" AS "CCDNLT"
		, "PREPJOINBK"."CCSTMT" AS "CCSTMT"
		, "PREPJOINBK"."CCATCS" AS "CCATCS"
		, "PREPJOINBK"."CCALGM" AS "CCALGM"
		, "PREPJOINBK"."CCAGEM" AS "CCAGEM"
		, "PREPJOINBK"."CCCRDY" AS "CCCRDY"
		, "PREPJOINBK"."CCAGR1" AS "CCAGR1"
		, "PREPJOINBK"."CCAGR2" AS "CCAGR2"
		, "PREPJOINBK"."CCAGR3" AS "CCAGR3"
		, "PREPJOINBK"."CCAGR4" AS "CCAGR4"
		, "PREPJOINBK"."CCAGR5" AS "CCAGR5"
		, "PREPJOINBK"."CCAGR6" AS "CCAGR6"
		, "PREPJOINBK"."CCAGR7" AS "CCAGR7"
		, "PREPJOINBK"."CCFRY" AS "CCFRY"
		, "PREPJOINBK"."CCFRP" AS "CCFRP"
		, "PREPJOINBK"."CCNNP" AS "CCNNP"
		, "PREPJOINBK"."CCFP" AS "CCFP"
		, "PREPJOINBK"."CCAGE" AS "CCAGE"
		, "PREPJOINBK"."CCDAG" AS "CCDAG"
		, "PREPJOINBK"."CCARPN" AS "CCARPN"
		, "PREPJOINBK"."CCAPPN" AS "CCAPPN"
		, "PREPJOINBK"."CCARFJ" AS "CCARFJ"
		, "PREPJOINBK"."CCAPFJ" AS "CCAPFJ"
		, "PREPJOINBK"."CCSGBK" AS "CCSGBK"
		, "PREPJOINBK"."CCPTCO" AS "CCPTCO"
		, "PREPJOINBK"."CCX1" AS "CCX1"
		, "PREPJOINBK"."CCX2" AS "CCX2"
		, "PREPJOINBK"."CCUSER" AS "CCUSER"
		, "PREPJOINBK"."CCPID" AS "CCPID"
		, "PREPJOINBK"."CCUPMJ" AS "CCUPMJ"
		, "PREPJOINBK"."CCJOBN" AS "CCJOBN"
		, "PREPJOINBK"."CCUPMT" AS "CCUPMT"
		, "PREPJOINBK"."CCTSID" AS "CCTSID"
		, "PREPJOINBK"."CCTSCO" AS "CCTSCO"
		, "PREPJOINBK"."CCTHCO" AS "CCTHCO"
		, "PREPJOINBK"."CCAN8C" AS "CCAN8C"
	FROM "PREPJOINBK" "PREPJOINBK"
