{{
	config(
		materialized='view',
		alias='VW_F42019',
		schema='JDEDWARDS_DFV',
		tags=['view', 'JDEDWARDS', 'SRC_JDE_SOHEADERHIST_TDFV_INCR']
	)
}}
	WITH "DELTA_WINDOW" AS 
	( 
		SELECT 
			  "LWT_SRC"."FMC_BEGIN_LW_TIMESTAMP" AS "FMC_BEGIN_LW_TIMESTAMP"
			, "LWT_SRC"."FMC_END_LW_TIMESTAMP" AS "FMC_END_LW_TIMESTAMP"
		FROM {{ source('JDEDWARDS_MTD', 'FMC_LOADING_WINDOW_TABLE') }} "LWT_SRC"
	)
	, "DELTA_VIEW_FILTER" AS 
	( 
		SELECT 
			  "CDC_SRC"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP"
			, "CDC_SRC"."JRN_FLAG" AS "JRN_FLAG"
			, TO_CHAR('S' ) AS "RECORD_TYPE"
			, "CDC_SRC"."SHKCOO" AS "SHKCOO"
			, "CDC_SRC"."SHDOCO" AS "SHDOCO"
			, "CDC_SRC"."SHDCTO" AS "SHDCTO"
			, "CDC_SRC"."SHMCU" AS "SHMCU"
			, "CDC_SRC"."SHAN8" AS "SHAN8"
			, "CDC_SRC"."SHSFXO" AS "SHSFXO"
			, "CDC_SRC"."SHCO" AS "SHCO"
			, "CDC_SRC"."SHOKCO" AS "SHOKCO"
			, "CDC_SRC"."SHOORN" AS "SHOORN"
			, "CDC_SRC"."SHOCTO" AS "SHOCTO"
			, "CDC_SRC"."SHRKCO" AS "SHRKCO"
			, "CDC_SRC"."SHRORN" AS "SHRORN"
			, "CDC_SRC"."SHRCTO" AS "SHRCTO"
			, "CDC_SRC"."SHSHAN" AS "SHSHAN"
			, "CDC_SRC"."SHPA8" AS "SHPA8"
			, "CDC_SRC"."SHDRQJ" AS "SHDRQJ"
			, "CDC_SRC"."SHTRDJ" AS "SHTRDJ"
			, "CDC_SRC"."SHPDDJ" AS "SHPDDJ"
			, "CDC_SRC"."SHOPDJ" AS "SHOPDJ"
			, "CDC_SRC"."SHADDJ" AS "SHADDJ"
			, "CDC_SRC"."SHCNDJ" AS "SHCNDJ"
			, "CDC_SRC"."SHPEFJ" AS "SHPEFJ"
			, "CDC_SRC"."SHPPDJ" AS "SHPPDJ"
			, "CDC_SRC"."SHVR01" AS "SHVR01"
			, "CDC_SRC"."SHVR02" AS "SHVR02"
			, "CDC_SRC"."SHDEL1" AS "SHDEL1"
			, "CDC_SRC"."SHDEL2" AS "SHDEL2"
			, "CDC_SRC"."SHINMG" AS "SHINMG"
			, "CDC_SRC"."SHPTC" AS "SHPTC"
			, "CDC_SRC"."SHRYIN" AS "SHRYIN"
			, "CDC_SRC"."SHASN" AS "SHASN"
			, "CDC_SRC"."SHPRGP" AS "SHPRGP"
			, "CDC_SRC"."SHTRDC" AS "SHTRDC"
			, "CDC_SRC"."SHPCRT" AS "SHPCRT"
			, "CDC_SRC"."SHTXA1" AS "SHTXA1"
			, "CDC_SRC"."SHEXR1" AS "SHEXR1"
			, "CDC_SRC"."SHTXCT" AS "SHTXCT"
			, "CDC_SRC"."SHATXT" AS "SHATXT"
			, "CDC_SRC"."SHPRIO" AS "SHPRIO"
			, "CDC_SRC"."SHBACK" AS "SHBACK"
			, "CDC_SRC"."SHSBAL" AS "SHSBAL"
			, "CDC_SRC"."SHHOLD" AS "SHHOLD"
			, "CDC_SRC"."SHPLST" AS "SHPLST"
			, "CDC_SRC"."SHINVC" AS "SHINVC"
			, "CDC_SRC"."SHNTR" AS "SHNTR"
			, "CDC_SRC"."SHANBY" AS "SHANBY"
			, "CDC_SRC"."SHCARS" AS "SHCARS"
			, "CDC_SRC"."SHMOT" AS "SHMOT"
			, "CDC_SRC"."SHCOT" AS "SHCOT"
			, "CDC_SRC"."SHROUT" AS "SHROUT"
			, "CDC_SRC"."SHSTOP" AS "SHSTOP"
			, "CDC_SRC"."SHZON" AS "SHZON"
			, "CDC_SRC"."SHCNID" AS "SHCNID"
			, "CDC_SRC"."SHFRTH" AS "SHFRTH"
			, "CDC_SRC"."SHAFT" AS "SHAFT"
			, "CDC_SRC"."SHFUF1" AS "SHFUF1"
			, "CDC_SRC"."SHFRTC" AS "SHFRTC"
			, "CDC_SRC"."SHMORD" AS "SHMORD"
			, "CDC_SRC"."SHRCD" AS "SHRCD"
			, "CDC_SRC"."SHFUF2" AS "SHFUF2"
			, "CDC_SRC"."SHOTOT" AS "SHOTOT"
			, "CDC_SRC"."SHTOTC" AS "SHTOTC"
			, "CDC_SRC"."SHWUMD" AS "SHWUMD"
			, "CDC_SRC"."SHVUMD" AS "SHVUMD"
			, "CDC_SRC"."SHAUTN" AS "SHAUTN"
			, "CDC_SRC"."SHCACT" AS "SHCACT"
			, "CDC_SRC"."SHCEXP" AS "SHCEXP"
			, "CDC_SRC"."SHSBLI" AS "SHSBLI"
			, "CDC_SRC"."SHCRMD" AS "SHCRMD"
			, "CDC_SRC"."SHCRRM" AS "SHCRRM"
			, "CDC_SRC"."SHCRCD" AS "SHCRCD"
			, "CDC_SRC"."SHCRR" AS "SHCRR"
			, "CDC_SRC"."SHLNGP" AS "SHLNGP"
			, "CDC_SRC"."SHFAP" AS "SHFAP"
			, "CDC_SRC"."SHFCST" AS "SHFCST"
			, "CDC_SRC"."SHORBY" AS "SHORBY"
			, "CDC_SRC"."SHTKBY" AS "SHTKBY"
			, "CDC_SRC"."SHURCD" AS "SHURCD"
			, "CDC_SRC"."SHURDT" AS "SHURDT"
			, "CDC_SRC"."SHURAT" AS "SHURAT"
			, "CDC_SRC"."SHURAB" AS "SHURAB"
			, "CDC_SRC"."SHURRF" AS "SHURRF"
			, "CDC_SRC"."SHUSER" AS "SHUSER"
			, "CDC_SRC"."SHPID" AS "SHPID"
			, "CDC_SRC"."SHJOBN" AS "SHJOBN"
			, "CDC_SRC"."SHUPMJ" AS "SHUPMJ"
			, "CDC_SRC"."SHTDAY" AS "SHTDAY"
			, "CDC_SRC"."SHIR01" AS "SHIR01"
			, "CDC_SRC"."SHIR02" AS "SHIR02"
			, "CDC_SRC"."SHIR03" AS "SHIR03"
			, "CDC_SRC"."SHIR04" AS "SHIR04"
			, "CDC_SRC"."SHIR05" AS "SHIR05"
			, "CDC_SRC"."SHVR03" AS "SHVR03"
			, "CDC_SRC"."SHSOOR" AS "SHSOOR"
			, "CDC_SRC"."SHPMDT" AS "SHPMDT"
			, "CDC_SRC"."SHRSDT" AS "SHRSDT"
			, "CDC_SRC"."SHRQSJ" AS "SHRQSJ"
			, "CDC_SRC"."SHPSTM" AS "SHPSTM"
			, "CDC_SRC"."SHPDTT" AS "SHPDTT"
			, "CDC_SRC"."SHOPTT" AS "SHOPTT"
			, "CDC_SRC"."SHDRQT" AS "SHDRQT"
			, "CDC_SRC"."SHADTM" AS "SHADTM"
			, "CDC_SRC"."SHADLJ" AS "SHADLJ"
			, "CDC_SRC"."SHPBAN" AS "SHPBAN"
			, "CDC_SRC"."SHITAN" AS "SHITAN"
			, "CDC_SRC"."SHFTAN" AS "SHFTAN"
			, "CDC_SRC"."SHDVAN" AS "SHDVAN"
			, "CDC_SRC"."SHDOC1" AS "SHDOC1"
			, "CDC_SRC"."SHDCT4" AS "SHDCT4"
			, "CDC_SRC"."SHCORD" AS "SHCORD"
			, "CDC_SRC"."SHBSC" AS "SHBSC"
			, "CDC_SRC"."SHBCRC" AS "SHBCRC"
			, "CDC_SRC"."SHAUFT" AS "SHAUFT"
			, "CDC_SRC"."SHAUFI" AS "SHAUFI"
			, "CDC_SRC"."SHOPBO" AS "SHOPBO"
			, "CDC_SRC"."SHOPTC" AS "SHOPTC"
			, "CDC_SRC"."SHOPLD" AS "SHOPLD"
			, "CDC_SRC"."SHOPBK" AS "SHOPBK"
			, "CDC_SRC"."SHOPSB" AS "SHOPSB"
			, "CDC_SRC"."SHOPPS" AS "SHOPPS"
			, "CDC_SRC"."SHOPPL" AS "SHOPPL"
			, "CDC_SRC"."SHOPMS" AS "SHOPMS"
			, "CDC_SRC"."SHOPSS" AS "SHOPSS"
			, "CDC_SRC"."SHOPBA" AS "SHOPBA"
			, "CDC_SRC"."SHOPLL" AS "SHOPLL"
			, "CDC_SRC"."SHPRAN8" AS "SHPRAN8"
			, "CDC_SRC"."SHOPPID" AS "SHOPPID"
			, "CDC_SRC"."SHSDATTN" AS "SHSDATTN"
			, "CDC_SRC"."SHSPATTN" AS "SHSPATTN"
			, "CDC_SRC"."SHOTIND" AS "SHOTIND"
			, "CDC_SRC"."SHPRCIDLN" AS "SHPRCIDLN"
			, "CDC_SRC"."SHCCIDLN" AS "SHCCIDLN"
			, "CDC_SRC"."SHSHCCIDLN" AS "SHSHCCIDLN"
		FROM {{ source('JDEDWARDS_CDC', 'CDC_F42019') }} "CDC_SRC"
		INNER JOIN "DELTA_WINDOW" "DELTA_WINDOW" ON  1 = 1
		WHERE  "CDC_SRC"."CDC_TIMESTAMP" > "DELTA_WINDOW"."FMC_BEGIN_LW_TIMESTAMP" AND "CDC_SRC"."CDC_TIMESTAMP" <= "DELTA_WINDOW"."FMC_END_LW_TIMESTAMP"
	)
	, "DELTA_VIEW" AS 
	( 
		SELECT 
			  "DELTA_VIEW_FILTER"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP"
			, "DELTA_VIEW_FILTER"."JRN_FLAG" AS "JRN_FLAG"
			, "DELTA_VIEW_FILTER"."RECORD_TYPE" AS "RECORD_TYPE"
			, "DELTA_VIEW_FILTER"."SHKCOO" AS "SHKCOO"
			, "DELTA_VIEW_FILTER"."SHDOCO" AS "SHDOCO"
			, "DELTA_VIEW_FILTER"."SHDCTO" AS "SHDCTO"
			, "DELTA_VIEW_FILTER"."SHMCU" AS "SHMCU"
			, "DELTA_VIEW_FILTER"."SHAN8" AS "SHAN8"
			, "DELTA_VIEW_FILTER"."SHSFXO" AS "SHSFXO"
			, "DELTA_VIEW_FILTER"."SHCO" AS "SHCO"
			, "DELTA_VIEW_FILTER"."SHOKCO" AS "SHOKCO"
			, "DELTA_VIEW_FILTER"."SHOORN" AS "SHOORN"
			, "DELTA_VIEW_FILTER"."SHOCTO" AS "SHOCTO"
			, "DELTA_VIEW_FILTER"."SHRKCO" AS "SHRKCO"
			, "DELTA_VIEW_FILTER"."SHRORN" AS "SHRORN"
			, "DELTA_VIEW_FILTER"."SHRCTO" AS "SHRCTO"
			, "DELTA_VIEW_FILTER"."SHSHAN" AS "SHSHAN"
			, "DELTA_VIEW_FILTER"."SHPA8" AS "SHPA8"
			, "DELTA_VIEW_FILTER"."SHDRQJ" AS "SHDRQJ"
			, "DELTA_VIEW_FILTER"."SHTRDJ" AS "SHTRDJ"
			, "DELTA_VIEW_FILTER"."SHPDDJ" AS "SHPDDJ"
			, "DELTA_VIEW_FILTER"."SHOPDJ" AS "SHOPDJ"
			, "DELTA_VIEW_FILTER"."SHADDJ" AS "SHADDJ"
			, "DELTA_VIEW_FILTER"."SHCNDJ" AS "SHCNDJ"
			, "DELTA_VIEW_FILTER"."SHPEFJ" AS "SHPEFJ"
			, "DELTA_VIEW_FILTER"."SHPPDJ" AS "SHPPDJ"
			, "DELTA_VIEW_FILTER"."SHVR01" AS "SHVR01"
			, "DELTA_VIEW_FILTER"."SHVR02" AS "SHVR02"
			, "DELTA_VIEW_FILTER"."SHDEL1" AS "SHDEL1"
			, "DELTA_VIEW_FILTER"."SHDEL2" AS "SHDEL2"
			, "DELTA_VIEW_FILTER"."SHINMG" AS "SHINMG"
			, "DELTA_VIEW_FILTER"."SHPTC" AS "SHPTC"
			, "DELTA_VIEW_FILTER"."SHRYIN" AS "SHRYIN"
			, "DELTA_VIEW_FILTER"."SHASN" AS "SHASN"
			, "DELTA_VIEW_FILTER"."SHPRGP" AS "SHPRGP"
			, "DELTA_VIEW_FILTER"."SHTRDC" AS "SHTRDC"
			, "DELTA_VIEW_FILTER"."SHPCRT" AS "SHPCRT"
			, "DELTA_VIEW_FILTER"."SHTXA1" AS "SHTXA1"
			, "DELTA_VIEW_FILTER"."SHEXR1" AS "SHEXR1"
			, "DELTA_VIEW_FILTER"."SHTXCT" AS "SHTXCT"
			, "DELTA_VIEW_FILTER"."SHATXT" AS "SHATXT"
			, "DELTA_VIEW_FILTER"."SHPRIO" AS "SHPRIO"
			, "DELTA_VIEW_FILTER"."SHBACK" AS "SHBACK"
			, "DELTA_VIEW_FILTER"."SHSBAL" AS "SHSBAL"
			, "DELTA_VIEW_FILTER"."SHHOLD" AS "SHHOLD"
			, "DELTA_VIEW_FILTER"."SHPLST" AS "SHPLST"
			, "DELTA_VIEW_FILTER"."SHINVC" AS "SHINVC"
			, "DELTA_VIEW_FILTER"."SHNTR" AS "SHNTR"
			, "DELTA_VIEW_FILTER"."SHANBY" AS "SHANBY"
			, "DELTA_VIEW_FILTER"."SHCARS" AS "SHCARS"
			, "DELTA_VIEW_FILTER"."SHMOT" AS "SHMOT"
			, "DELTA_VIEW_FILTER"."SHCOT" AS "SHCOT"
			, "DELTA_VIEW_FILTER"."SHROUT" AS "SHROUT"
			, "DELTA_VIEW_FILTER"."SHSTOP" AS "SHSTOP"
			, "DELTA_VIEW_FILTER"."SHZON" AS "SHZON"
			, "DELTA_VIEW_FILTER"."SHCNID" AS "SHCNID"
			, "DELTA_VIEW_FILTER"."SHFRTH" AS "SHFRTH"
			, "DELTA_VIEW_FILTER"."SHAFT" AS "SHAFT"
			, "DELTA_VIEW_FILTER"."SHFUF1" AS "SHFUF1"
			, "DELTA_VIEW_FILTER"."SHFRTC" AS "SHFRTC"
			, "DELTA_VIEW_FILTER"."SHMORD" AS "SHMORD"
			, "DELTA_VIEW_FILTER"."SHRCD" AS "SHRCD"
			, "DELTA_VIEW_FILTER"."SHFUF2" AS "SHFUF2"
			, "DELTA_VIEW_FILTER"."SHOTOT" AS "SHOTOT"
			, "DELTA_VIEW_FILTER"."SHTOTC" AS "SHTOTC"
			, "DELTA_VIEW_FILTER"."SHWUMD" AS "SHWUMD"
			, "DELTA_VIEW_FILTER"."SHVUMD" AS "SHVUMD"
			, "DELTA_VIEW_FILTER"."SHAUTN" AS "SHAUTN"
			, "DELTA_VIEW_FILTER"."SHCACT" AS "SHCACT"
			, "DELTA_VIEW_FILTER"."SHCEXP" AS "SHCEXP"
			, "DELTA_VIEW_FILTER"."SHSBLI" AS "SHSBLI"
			, "DELTA_VIEW_FILTER"."SHCRMD" AS "SHCRMD"
			, "DELTA_VIEW_FILTER"."SHCRRM" AS "SHCRRM"
			, "DELTA_VIEW_FILTER"."SHCRCD" AS "SHCRCD"
			, "DELTA_VIEW_FILTER"."SHCRR" AS "SHCRR"
			, "DELTA_VIEW_FILTER"."SHLNGP" AS "SHLNGP"
			, "DELTA_VIEW_FILTER"."SHFAP" AS "SHFAP"
			, "DELTA_VIEW_FILTER"."SHFCST" AS "SHFCST"
			, "DELTA_VIEW_FILTER"."SHORBY" AS "SHORBY"
			, "DELTA_VIEW_FILTER"."SHTKBY" AS "SHTKBY"
			, "DELTA_VIEW_FILTER"."SHURCD" AS "SHURCD"
			, "DELTA_VIEW_FILTER"."SHURDT" AS "SHURDT"
			, "DELTA_VIEW_FILTER"."SHURAT" AS "SHURAT"
			, "DELTA_VIEW_FILTER"."SHURAB" AS "SHURAB"
			, "DELTA_VIEW_FILTER"."SHURRF" AS "SHURRF"
			, "DELTA_VIEW_FILTER"."SHUSER" AS "SHUSER"
			, "DELTA_VIEW_FILTER"."SHPID" AS "SHPID"
			, "DELTA_VIEW_FILTER"."SHJOBN" AS "SHJOBN"
			, "DELTA_VIEW_FILTER"."SHUPMJ" AS "SHUPMJ"
			, "DELTA_VIEW_FILTER"."SHTDAY" AS "SHTDAY"
			, "DELTA_VIEW_FILTER"."SHIR01" AS "SHIR01"
			, "DELTA_VIEW_FILTER"."SHIR02" AS "SHIR02"
			, "DELTA_VIEW_FILTER"."SHIR03" AS "SHIR03"
			, "DELTA_VIEW_FILTER"."SHIR04" AS "SHIR04"
			, "DELTA_VIEW_FILTER"."SHIR05" AS "SHIR05"
			, "DELTA_VIEW_FILTER"."SHVR03" AS "SHVR03"
			, "DELTA_VIEW_FILTER"."SHSOOR" AS "SHSOOR"
			, "DELTA_VIEW_FILTER"."SHPMDT" AS "SHPMDT"
			, "DELTA_VIEW_FILTER"."SHRSDT" AS "SHRSDT"
			, "DELTA_VIEW_FILTER"."SHRQSJ" AS "SHRQSJ"
			, "DELTA_VIEW_FILTER"."SHPSTM" AS "SHPSTM"
			, "DELTA_VIEW_FILTER"."SHPDTT" AS "SHPDTT"
			, "DELTA_VIEW_FILTER"."SHOPTT" AS "SHOPTT"
			, "DELTA_VIEW_FILTER"."SHDRQT" AS "SHDRQT"
			, "DELTA_VIEW_FILTER"."SHADTM" AS "SHADTM"
			, "DELTA_VIEW_FILTER"."SHADLJ" AS "SHADLJ"
			, "DELTA_VIEW_FILTER"."SHPBAN" AS "SHPBAN"
			, "DELTA_VIEW_FILTER"."SHITAN" AS "SHITAN"
			, "DELTA_VIEW_FILTER"."SHFTAN" AS "SHFTAN"
			, "DELTA_VIEW_FILTER"."SHDVAN" AS "SHDVAN"
			, "DELTA_VIEW_FILTER"."SHDOC1" AS "SHDOC1"
			, "DELTA_VIEW_FILTER"."SHDCT4" AS "SHDCT4"
			, "DELTA_VIEW_FILTER"."SHCORD" AS "SHCORD"
			, "DELTA_VIEW_FILTER"."SHBSC" AS "SHBSC"
			, "DELTA_VIEW_FILTER"."SHBCRC" AS "SHBCRC"
			, "DELTA_VIEW_FILTER"."SHAUFT" AS "SHAUFT"
			, "DELTA_VIEW_FILTER"."SHAUFI" AS "SHAUFI"
			, "DELTA_VIEW_FILTER"."SHOPBO" AS "SHOPBO"
			, "DELTA_VIEW_FILTER"."SHOPTC" AS "SHOPTC"
			, "DELTA_VIEW_FILTER"."SHOPLD" AS "SHOPLD"
			, "DELTA_VIEW_FILTER"."SHOPBK" AS "SHOPBK"
			, "DELTA_VIEW_FILTER"."SHOPSB" AS "SHOPSB"
			, "DELTA_VIEW_FILTER"."SHOPPS" AS "SHOPPS"
			, "DELTA_VIEW_FILTER"."SHOPPL" AS "SHOPPL"
			, "DELTA_VIEW_FILTER"."SHOPMS" AS "SHOPMS"
			, "DELTA_VIEW_FILTER"."SHOPSS" AS "SHOPSS"
			, "DELTA_VIEW_FILTER"."SHOPBA" AS "SHOPBA"
			, "DELTA_VIEW_FILTER"."SHOPLL" AS "SHOPLL"
			, "DELTA_VIEW_FILTER"."SHPRAN8" AS "SHPRAN8"
			, "DELTA_VIEW_FILTER"."SHOPPID" AS "SHOPPID"
			, "DELTA_VIEW_FILTER"."SHSDATTN" AS "SHSDATTN"
			, "DELTA_VIEW_FILTER"."SHSPATTN" AS "SHSPATTN"
			, "DELTA_VIEW_FILTER"."SHOTIND" AS "SHOTIND"
			, "DELTA_VIEW_FILTER"."SHPRCIDLN" AS "SHPRCIDLN"
			, "DELTA_VIEW_FILTER"."SHCCIDLN" AS "SHCCIDLN"
			, "DELTA_VIEW_FILTER"."SHSHCCIDLN" AS "SHSHCCIDLN"
		FROM "DELTA_VIEW_FILTER" "DELTA_VIEW_FILTER"
	)
	, "PREPJOINBK" AS 
	( 
		SELECT 
			  "DELTA_VIEW"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP"
			, "DELTA_VIEW"."JRN_FLAG" AS "JRN_FLAG"
			, "DELTA_VIEW"."RECORD_TYPE" AS "RECORD_TYPE"
			, COALESCE("DELTA_VIEW"."SHKCOO","MEX_BK_SRC"."KEY_ATTRIBUTE_VARCHAR") AS "SHKCOO"
			, COALESCE("DELTA_VIEW"."SHDOCO", CAST("MEX_BK_SRC"."KEY_ATTRIBUTE_FLOAT" AS FLOAT)) AS "SHDOCO"
			, COALESCE("DELTA_VIEW"."SHDCTO","MEX_BK_SRC"."KEY_ATTRIBUTE_VARCHAR") AS "SHDCTO"
			, COALESCE("DELTA_VIEW"."SHAN8", CAST("MEX_BK_SRC"."KEY_ATTRIBUTE_FLOAT" AS FLOAT)) AS "SHAN8"
			, COALESCE("DELTA_VIEW"."SHMCU","MEX_BK_SRC"."KEY_ATTRIBUTE_VARCHAR") AS "SHMCU"
			, "DELTA_VIEW"."SHSFXO" AS "SHSFXO"
			, "DELTA_VIEW"."SHCO" AS "SHCO"
			, "DELTA_VIEW"."SHOKCO" AS "SHOKCO"
			, "DELTA_VIEW"."SHOORN" AS "SHOORN"
			, "DELTA_VIEW"."SHOCTO" AS "SHOCTO"
			, "DELTA_VIEW"."SHRKCO" AS "SHRKCO"
			, "DELTA_VIEW"."SHRORN" AS "SHRORN"
			, "DELTA_VIEW"."SHRCTO" AS "SHRCTO"
			, "DELTA_VIEW"."SHSHAN" AS "SHSHAN"
			, "DELTA_VIEW"."SHPA8" AS "SHPA8"
			, "DELTA_VIEW"."SHDRQJ" AS "SHDRQJ"
			, "DELTA_VIEW"."SHTRDJ" AS "SHTRDJ"
			, "DELTA_VIEW"."SHPDDJ" AS "SHPDDJ"
			, "DELTA_VIEW"."SHOPDJ" AS "SHOPDJ"
			, "DELTA_VIEW"."SHADDJ" AS "SHADDJ"
			, "DELTA_VIEW"."SHCNDJ" AS "SHCNDJ"
			, "DELTA_VIEW"."SHPEFJ" AS "SHPEFJ"
			, "DELTA_VIEW"."SHPPDJ" AS "SHPPDJ"
			, "DELTA_VIEW"."SHVR01" AS "SHVR01"
			, "DELTA_VIEW"."SHVR02" AS "SHVR02"
			, "DELTA_VIEW"."SHDEL1" AS "SHDEL1"
			, "DELTA_VIEW"."SHDEL2" AS "SHDEL2"
			, "DELTA_VIEW"."SHINMG" AS "SHINMG"
			, "DELTA_VIEW"."SHPTC" AS "SHPTC"
			, "DELTA_VIEW"."SHRYIN" AS "SHRYIN"
			, "DELTA_VIEW"."SHASN" AS "SHASN"
			, "DELTA_VIEW"."SHPRGP" AS "SHPRGP"
			, "DELTA_VIEW"."SHTRDC" AS "SHTRDC"
			, "DELTA_VIEW"."SHPCRT" AS "SHPCRT"
			, "DELTA_VIEW"."SHTXA1" AS "SHTXA1"
			, "DELTA_VIEW"."SHEXR1" AS "SHEXR1"
			, "DELTA_VIEW"."SHTXCT" AS "SHTXCT"
			, "DELTA_VIEW"."SHATXT" AS "SHATXT"
			, "DELTA_VIEW"."SHPRIO" AS "SHPRIO"
			, "DELTA_VIEW"."SHBACK" AS "SHBACK"
			, "DELTA_VIEW"."SHSBAL" AS "SHSBAL"
			, "DELTA_VIEW"."SHHOLD" AS "SHHOLD"
			, "DELTA_VIEW"."SHPLST" AS "SHPLST"
			, "DELTA_VIEW"."SHINVC" AS "SHINVC"
			, "DELTA_VIEW"."SHNTR" AS "SHNTR"
			, "DELTA_VIEW"."SHANBY" AS "SHANBY"
			, "DELTA_VIEW"."SHCARS" AS "SHCARS"
			, "DELTA_VIEW"."SHMOT" AS "SHMOT"
			, "DELTA_VIEW"."SHCOT" AS "SHCOT"
			, "DELTA_VIEW"."SHROUT" AS "SHROUT"
			, "DELTA_VIEW"."SHSTOP" AS "SHSTOP"
			, "DELTA_VIEW"."SHZON" AS "SHZON"
			, "DELTA_VIEW"."SHCNID" AS "SHCNID"
			, "DELTA_VIEW"."SHFRTH" AS "SHFRTH"
			, "DELTA_VIEW"."SHAFT" AS "SHAFT"
			, "DELTA_VIEW"."SHFUF1" AS "SHFUF1"
			, "DELTA_VIEW"."SHFRTC" AS "SHFRTC"
			, "DELTA_VIEW"."SHMORD" AS "SHMORD"
			, "DELTA_VIEW"."SHRCD" AS "SHRCD"
			, "DELTA_VIEW"."SHFUF2" AS "SHFUF2"
			, "DELTA_VIEW"."SHOTOT" AS "SHOTOT"
			, "DELTA_VIEW"."SHTOTC" AS "SHTOTC"
			, "DELTA_VIEW"."SHWUMD" AS "SHWUMD"
			, "DELTA_VIEW"."SHVUMD" AS "SHVUMD"
			, "DELTA_VIEW"."SHAUTN" AS "SHAUTN"
			, "DELTA_VIEW"."SHCACT" AS "SHCACT"
			, "DELTA_VIEW"."SHCEXP" AS "SHCEXP"
			, "DELTA_VIEW"."SHSBLI" AS "SHSBLI"
			, "DELTA_VIEW"."SHCRMD" AS "SHCRMD"
			, "DELTA_VIEW"."SHCRRM" AS "SHCRRM"
			, "DELTA_VIEW"."SHCRCD" AS "SHCRCD"
			, "DELTA_VIEW"."SHCRR" AS "SHCRR"
			, "DELTA_VIEW"."SHLNGP" AS "SHLNGP"
			, "DELTA_VIEW"."SHFAP" AS "SHFAP"
			, "DELTA_VIEW"."SHFCST" AS "SHFCST"
			, "DELTA_VIEW"."SHORBY" AS "SHORBY"
			, "DELTA_VIEW"."SHTKBY" AS "SHTKBY"
			, "DELTA_VIEW"."SHURCD" AS "SHURCD"
			, "DELTA_VIEW"."SHURDT" AS "SHURDT"
			, "DELTA_VIEW"."SHURAT" AS "SHURAT"
			, "DELTA_VIEW"."SHURAB" AS "SHURAB"
			, "DELTA_VIEW"."SHURRF" AS "SHURRF"
			, "DELTA_VIEW"."SHUSER" AS "SHUSER"
			, "DELTA_VIEW"."SHPID" AS "SHPID"
			, "DELTA_VIEW"."SHJOBN" AS "SHJOBN"
			, "DELTA_VIEW"."SHUPMJ" AS "SHUPMJ"
			, "DELTA_VIEW"."SHTDAY" AS "SHTDAY"
			, "DELTA_VIEW"."SHIR01" AS "SHIR01"
			, "DELTA_VIEW"."SHIR02" AS "SHIR02"
			, "DELTA_VIEW"."SHIR03" AS "SHIR03"
			, "DELTA_VIEW"."SHIR04" AS "SHIR04"
			, "DELTA_VIEW"."SHIR05" AS "SHIR05"
			, "DELTA_VIEW"."SHVR03" AS "SHVR03"
			, "DELTA_VIEW"."SHSOOR" AS "SHSOOR"
			, "DELTA_VIEW"."SHPMDT" AS "SHPMDT"
			, "DELTA_VIEW"."SHRSDT" AS "SHRSDT"
			, "DELTA_VIEW"."SHRQSJ" AS "SHRQSJ"
			, "DELTA_VIEW"."SHPSTM" AS "SHPSTM"
			, "DELTA_VIEW"."SHPDTT" AS "SHPDTT"
			, "DELTA_VIEW"."SHOPTT" AS "SHOPTT"
			, "DELTA_VIEW"."SHDRQT" AS "SHDRQT"
			, "DELTA_VIEW"."SHADTM" AS "SHADTM"
			, "DELTA_VIEW"."SHADLJ" AS "SHADLJ"
			, "DELTA_VIEW"."SHPBAN" AS "SHPBAN"
			, "DELTA_VIEW"."SHITAN" AS "SHITAN"
			, "DELTA_VIEW"."SHFTAN" AS "SHFTAN"
			, "DELTA_VIEW"."SHDVAN" AS "SHDVAN"
			, "DELTA_VIEW"."SHDOC1" AS "SHDOC1"
			, "DELTA_VIEW"."SHDCT4" AS "SHDCT4"
			, "DELTA_VIEW"."SHCORD" AS "SHCORD"
			, "DELTA_VIEW"."SHBSC" AS "SHBSC"
			, "DELTA_VIEW"."SHBCRC" AS "SHBCRC"
			, "DELTA_VIEW"."SHAUFT" AS "SHAUFT"
			, "DELTA_VIEW"."SHAUFI" AS "SHAUFI"
			, "DELTA_VIEW"."SHOPBO" AS "SHOPBO"
			, "DELTA_VIEW"."SHOPTC" AS "SHOPTC"
			, "DELTA_VIEW"."SHOPLD" AS "SHOPLD"
			, "DELTA_VIEW"."SHOPBK" AS "SHOPBK"
			, "DELTA_VIEW"."SHOPSB" AS "SHOPSB"
			, "DELTA_VIEW"."SHOPPS" AS "SHOPPS"
			, "DELTA_VIEW"."SHOPPL" AS "SHOPPL"
			, "DELTA_VIEW"."SHOPMS" AS "SHOPMS"
			, "DELTA_VIEW"."SHOPSS" AS "SHOPSS"
			, "DELTA_VIEW"."SHOPBA" AS "SHOPBA"
			, "DELTA_VIEW"."SHOPLL" AS "SHOPLL"
			, "DELTA_VIEW"."SHPRAN8" AS "SHPRAN8"
			, "DELTA_VIEW"."SHOPPID" AS "SHOPPID"
			, "DELTA_VIEW"."SHSDATTN" AS "SHSDATTN"
			, "DELTA_VIEW"."SHSPATTN" AS "SHSPATTN"
			, "DELTA_VIEW"."SHOTIND" AS "SHOTIND"
			, "DELTA_VIEW"."SHPRCIDLN" AS "SHPRCIDLN"
			, "DELTA_VIEW"."SHCCIDLN" AS "SHCCIDLN"
			, "DELTA_VIEW"."SHSHCCIDLN" AS "SHSHCCIDLN"
		FROM "DELTA_VIEW" "DELTA_VIEW"
		INNER JOIN {{ source('JDEDWARDS_MTD', 'MTD_EXCEPTION_RECORDS') }} "MEX_BK_SRC" ON  1 = 1
		WHERE  "MEX_BK_SRC"."RECORD_TYPE" = 'N'
	)
	SELECT 
		  "PREPJOINBK"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP"
		, "PREPJOINBK"."JRN_FLAG" AS "JRN_FLAG"
		, "PREPJOINBK"."RECORD_TYPE" AS "RECORD_TYPE"
		, "PREPJOINBK"."SHKCOO" AS "SHKCOO"
		, "PREPJOINBK"."SHDOCO" AS "SHDOCO"
		, "PREPJOINBK"."SHDCTO" AS "SHDCTO"
		, "PREPJOINBK"."SHMCU" AS "SHMCU"
		, "PREPJOINBK"."SHAN8" AS "SHAN8"
		, "PREPJOINBK"."SHSFXO" AS "SHSFXO"
		, "PREPJOINBK"."SHCO" AS "SHCO"
		, "PREPJOINBK"."SHOKCO" AS "SHOKCO"
		, "PREPJOINBK"."SHOORN" AS "SHOORN"
		, "PREPJOINBK"."SHOCTO" AS "SHOCTO"
		, "PREPJOINBK"."SHRKCO" AS "SHRKCO"
		, "PREPJOINBK"."SHRORN" AS "SHRORN"
		, "PREPJOINBK"."SHRCTO" AS "SHRCTO"
		, "PREPJOINBK"."SHSHAN" AS "SHSHAN"
		, "PREPJOINBK"."SHPA8" AS "SHPA8"
		, "PREPJOINBK"."SHDRQJ" AS "SHDRQJ"
		, "PREPJOINBK"."SHTRDJ" AS "SHTRDJ"
		, "PREPJOINBK"."SHPDDJ" AS "SHPDDJ"
		, "PREPJOINBK"."SHOPDJ" AS "SHOPDJ"
		, "PREPJOINBK"."SHADDJ" AS "SHADDJ"
		, "PREPJOINBK"."SHCNDJ" AS "SHCNDJ"
		, "PREPJOINBK"."SHPEFJ" AS "SHPEFJ"
		, "PREPJOINBK"."SHPPDJ" AS "SHPPDJ"
		, "PREPJOINBK"."SHVR01" AS "SHVR01"
		, "PREPJOINBK"."SHVR02" AS "SHVR02"
		, "PREPJOINBK"."SHDEL1" AS "SHDEL1"
		, "PREPJOINBK"."SHDEL2" AS "SHDEL2"
		, "PREPJOINBK"."SHINMG" AS "SHINMG"
		, "PREPJOINBK"."SHPTC" AS "SHPTC"
		, "PREPJOINBK"."SHRYIN" AS "SHRYIN"
		, "PREPJOINBK"."SHASN" AS "SHASN"
		, "PREPJOINBK"."SHPRGP" AS "SHPRGP"
		, "PREPJOINBK"."SHTRDC" AS "SHTRDC"
		, "PREPJOINBK"."SHPCRT" AS "SHPCRT"
		, "PREPJOINBK"."SHTXA1" AS "SHTXA1"
		, "PREPJOINBK"."SHEXR1" AS "SHEXR1"
		, "PREPJOINBK"."SHTXCT" AS "SHTXCT"
		, "PREPJOINBK"."SHATXT" AS "SHATXT"
		, "PREPJOINBK"."SHPRIO" AS "SHPRIO"
		, "PREPJOINBK"."SHBACK" AS "SHBACK"
		, "PREPJOINBK"."SHSBAL" AS "SHSBAL"
		, "PREPJOINBK"."SHHOLD" AS "SHHOLD"
		, "PREPJOINBK"."SHPLST" AS "SHPLST"
		, "PREPJOINBK"."SHINVC" AS "SHINVC"
		, "PREPJOINBK"."SHNTR" AS "SHNTR"
		, "PREPJOINBK"."SHANBY" AS "SHANBY"
		, "PREPJOINBK"."SHCARS" AS "SHCARS"
		, "PREPJOINBK"."SHMOT" AS "SHMOT"
		, "PREPJOINBK"."SHCOT" AS "SHCOT"
		, "PREPJOINBK"."SHROUT" AS "SHROUT"
		, "PREPJOINBK"."SHSTOP" AS "SHSTOP"
		, "PREPJOINBK"."SHZON" AS "SHZON"
		, "PREPJOINBK"."SHCNID" AS "SHCNID"
		, "PREPJOINBK"."SHFRTH" AS "SHFRTH"
		, "PREPJOINBK"."SHAFT" AS "SHAFT"
		, "PREPJOINBK"."SHFUF1" AS "SHFUF1"
		, "PREPJOINBK"."SHFRTC" AS "SHFRTC"
		, "PREPJOINBK"."SHMORD" AS "SHMORD"
		, "PREPJOINBK"."SHRCD" AS "SHRCD"
		, "PREPJOINBK"."SHFUF2" AS "SHFUF2"
		, "PREPJOINBK"."SHOTOT" AS "SHOTOT"
		, "PREPJOINBK"."SHTOTC" AS "SHTOTC"
		, "PREPJOINBK"."SHWUMD" AS "SHWUMD"
		, "PREPJOINBK"."SHVUMD" AS "SHVUMD"
		, "PREPJOINBK"."SHAUTN" AS "SHAUTN"
		, "PREPJOINBK"."SHCACT" AS "SHCACT"
		, "PREPJOINBK"."SHCEXP" AS "SHCEXP"
		, "PREPJOINBK"."SHSBLI" AS "SHSBLI"
		, "PREPJOINBK"."SHCRMD" AS "SHCRMD"
		, "PREPJOINBK"."SHCRRM" AS "SHCRRM"
		, "PREPJOINBK"."SHCRCD" AS "SHCRCD"
		, "PREPJOINBK"."SHCRR" AS "SHCRR"
		, "PREPJOINBK"."SHLNGP" AS "SHLNGP"
		, "PREPJOINBK"."SHFAP" AS "SHFAP"
		, "PREPJOINBK"."SHFCST" AS "SHFCST"
		, "PREPJOINBK"."SHORBY" AS "SHORBY"
		, "PREPJOINBK"."SHTKBY" AS "SHTKBY"
		, "PREPJOINBK"."SHURCD" AS "SHURCD"
		, "PREPJOINBK"."SHURDT" AS "SHURDT"
		, "PREPJOINBK"."SHURAT" AS "SHURAT"
		, "PREPJOINBK"."SHURAB" AS "SHURAB"
		, "PREPJOINBK"."SHURRF" AS "SHURRF"
		, "PREPJOINBK"."SHUSER" AS "SHUSER"
		, "PREPJOINBK"."SHPID" AS "SHPID"
		, "PREPJOINBK"."SHJOBN" AS "SHJOBN"
		, "PREPJOINBK"."SHUPMJ" AS "SHUPMJ"
		, "PREPJOINBK"."SHTDAY" AS "SHTDAY"
		, "PREPJOINBK"."SHIR01" AS "SHIR01"
		, "PREPJOINBK"."SHIR02" AS "SHIR02"
		, "PREPJOINBK"."SHIR03" AS "SHIR03"
		, "PREPJOINBK"."SHIR04" AS "SHIR04"
		, "PREPJOINBK"."SHIR05" AS "SHIR05"
		, "PREPJOINBK"."SHVR03" AS "SHVR03"
		, "PREPJOINBK"."SHSOOR" AS "SHSOOR"
		, "PREPJOINBK"."SHPMDT" AS "SHPMDT"
		, "PREPJOINBK"."SHRSDT" AS "SHRSDT"
		, "PREPJOINBK"."SHRQSJ" AS "SHRQSJ"
		, "PREPJOINBK"."SHPSTM" AS "SHPSTM"
		, "PREPJOINBK"."SHPDTT" AS "SHPDTT"
		, "PREPJOINBK"."SHOPTT" AS "SHOPTT"
		, "PREPJOINBK"."SHDRQT" AS "SHDRQT"
		, "PREPJOINBK"."SHADTM" AS "SHADTM"
		, "PREPJOINBK"."SHADLJ" AS "SHADLJ"
		, "PREPJOINBK"."SHPBAN" AS "SHPBAN"
		, "PREPJOINBK"."SHITAN" AS "SHITAN"
		, "PREPJOINBK"."SHFTAN" AS "SHFTAN"
		, "PREPJOINBK"."SHDVAN" AS "SHDVAN"
		, "PREPJOINBK"."SHDOC1" AS "SHDOC1"
		, "PREPJOINBK"."SHDCT4" AS "SHDCT4"
		, "PREPJOINBK"."SHCORD" AS "SHCORD"
		, "PREPJOINBK"."SHBSC" AS "SHBSC"
		, "PREPJOINBK"."SHBCRC" AS "SHBCRC"
		, "PREPJOINBK"."SHAUFT" AS "SHAUFT"
		, "PREPJOINBK"."SHAUFI" AS "SHAUFI"
		, "PREPJOINBK"."SHOPBO" AS "SHOPBO"
		, "PREPJOINBK"."SHOPTC" AS "SHOPTC"
		, "PREPJOINBK"."SHOPLD" AS "SHOPLD"
		, "PREPJOINBK"."SHOPBK" AS "SHOPBK"
		, "PREPJOINBK"."SHOPSB" AS "SHOPSB"
		, "PREPJOINBK"."SHOPPS" AS "SHOPPS"
		, "PREPJOINBK"."SHOPPL" AS "SHOPPL"
		, "PREPJOINBK"."SHOPMS" AS "SHOPMS"
		, "PREPJOINBK"."SHOPSS" AS "SHOPSS"
		, "PREPJOINBK"."SHOPBA" AS "SHOPBA"
		, "PREPJOINBK"."SHOPLL" AS "SHOPLL"
		, "PREPJOINBK"."SHPRAN8" AS "SHPRAN8"
		, "PREPJOINBK"."SHOPPID" AS "SHOPPID"
		, "PREPJOINBK"."SHSDATTN" AS "SHSDATTN"
		, "PREPJOINBK"."SHSPATTN" AS "SHSPATTN"
		, "PREPJOINBK"."SHOTIND" AS "SHOTIND"
		, "PREPJOINBK"."SHPRCIDLN" AS "SHPRCIDLN"
		, "PREPJOINBK"."SHCCIDLN" AS "SHCCIDLN"
		, "PREPJOINBK"."SHSHCCIDLN" AS "SHSHCCIDLN"
	FROM "PREPJOINBK" "PREPJOINBK"
