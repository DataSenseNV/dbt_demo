{{
	config(
		materialized='view',
		alias='VW_CAMPAIGN',
		schema='SALESFORCE_DFV',
		tags=['view', 'SALESFORCE', 'SRC_SALESFORCE_CAMPAIGN_TDFV_INCR']
	)
}}
	WITH "DELTA_WINDOW" AS 
	( 
		SELECT 
			  "LWT_SRC"."FMC_BEGIN_LW_TIMESTAMP" AS "FMC_BEGIN_LW_TIMESTAMP"
			, "LWT_SRC"."FMC_END_LW_TIMESTAMP" AS "FMC_END_LW_TIMESTAMP"
		FROM {{ source('SALESFORCE_MTD', 'FMC_LOADING_WINDOW_TABLE') }} "LWT_SRC"
	)
	, "DELTA_VIEW_FILTER" AS 
	( 
		SELECT 
			  "CDC_SRC"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP"
			, "CDC_SRC"."JRN_FLAG" AS "JRN_FLAG"
			, TO_CHAR('S' ) AS "RECORD_TYPE"
			, "CDC_SRC"."ID" AS "ID"
			, "CDC_SRC"."PARENTID" AS "PARENTID"
			, "CDC_SRC"."OWNERID" AS "OWNERID"
			, "CDC_SRC"."CREATEDBYID" AS "CREATEDBYID"
			, "CDC_SRC"."LASTMODIFIEDBYID" AS "LASTMODIFIEDBYID"
			, "CDC_SRC"."ISDELETED" AS "ISDELETED"
			, "CDC_SRC"."NAME" AS "NAME"
			, "CDC_SRC"."TYPE" AS "TYPE"
			, "CDC_SRC"."STATUS" AS "STATUS"
			, "CDC_SRC"."STARTDATE" AS "STARTDATE"
			, "CDC_SRC"."ENDDATE" AS "ENDDATE"
			, "CDC_SRC"."EXPECTEDREVENUE" AS "EXPECTEDREVENUE"
			, "CDC_SRC"."BUDGETEDCOST" AS "BUDGETEDCOST"
			, "CDC_SRC"."ACTUALCOST" AS "ACTUALCOST"
			, "CDC_SRC"."EXPECTEDRESPONSE" AS "EXPECTEDRESPONSE"
			, "CDC_SRC"."NUMBERSENT" AS "NUMBERSENT"
			, "CDC_SRC"."ISACTIVE" AS "ISACTIVE"
			, "CDC_SRC"."DESCRIPTION" AS "DESCRIPTION"
			, "CDC_SRC"."NUMBEROFLEADS" AS "NUMBEROFLEADS"
			, "CDC_SRC"."NUMBEROFCONVERTEDLEADS" AS "NUMBEROFCONVERTEDLEADS"
			, "CDC_SRC"."NUMBEROFCONTACTS" AS "NUMBEROFCONTACTS"
			, "CDC_SRC"."NUMBEROFRESPONSES" AS "NUMBEROFRESPONSES"
			, "CDC_SRC"."NUMBEROFOPPORTUNITIES" AS "NUMBEROFOPPORTUNITIES"
			, "CDC_SRC"."NUMBEROFWONOPPORTUNITIES" AS "NUMBEROFWONOPPORTUNITIES"
			, "CDC_SRC"."AMOUNTALLOPPORTUNITIES" AS "AMOUNTALLOPPORTUNITIES"
			, "CDC_SRC"."AMOUNTWONOPPORTUNITIES" AS "AMOUNTWONOPPORTUNITIES"
			, "CDC_SRC"."HIERARCHYNUMBEROFLEADS" AS "HIERARCHYNUMBEROFLEADS"
			, "CDC_SRC"."HIERARCHYNUMBEROFCONVERTEDLEADS" AS "HIERARCHYNUMBEROFCONVERTEDLEADS"
			, "CDC_SRC"."HIERARCHYNUMBEROFCONTACTS" AS "HIERARCHYNUMBEROFCONTACTS"
			, "CDC_SRC"."HIERARCHYNUMBEROFRESPONSES" AS "HIERARCHYNUMBEROFRESPONSES"
			, "CDC_SRC"."HIERARCHYNUMBEROFOPPORTUNITIES" AS "HIERARCHYNUMBEROFOPPORTUNITIES"
			, "CDC_SRC"."HIERARCHYNUMBEROFWONOPPORTUNITIES" AS "HIERARCHYNUMBEROFWONOPPORTUNITIES"
			, "CDC_SRC"."HIERARCHYAMOUNTALLOPPORTUNITIES" AS "HIERARCHYAMOUNTALLOPPORTUNITIES"
			, "CDC_SRC"."HIERARCHYAMOUNTWONOPPORTUNITIES" AS "HIERARCHYAMOUNTWONOPPORTUNITIES"
			, "CDC_SRC"."HIERARCHYNUMBERSENT" AS "HIERARCHYNUMBERSENT"
			, "CDC_SRC"."HIERARCHYEXPECTEDREVENUE" AS "HIERARCHYEXPECTEDREVENUE"
			, "CDC_SRC"."HIERARCHYBUDGETEDCOST" AS "HIERARCHYBUDGETEDCOST"
			, "CDC_SRC"."HIERARCHYACTUALCOST" AS "HIERARCHYACTUALCOST"
			, "CDC_SRC"."CREATEDDATE" AS "CREATEDDATE"
			, "CDC_SRC"."LASTMODIFIEDDATE" AS "LASTMODIFIEDDATE"
			, "CDC_SRC"."SYSTEMMODSTAMP" AS "SYSTEMMODSTAMP"
			, "CDC_SRC"."LASTACTIVITYDATE" AS "LASTACTIVITYDATE"
			, "CDC_SRC"."CAMPAIGNMEMBERRECORDTYPEID" AS "CAMPAIGNMEMBERRECORDTYPEID"
		FROM {{ source('SALESFORCE_CDC', 'CDC_CAMPAIGN') }} "CDC_SRC"
		INNER JOIN "DELTA_WINDOW" "DELTA_WINDOW" ON  1 = 1
		WHERE  "CDC_SRC"."CDC_TIMESTAMP" > "DELTA_WINDOW"."FMC_BEGIN_LW_TIMESTAMP" AND "CDC_SRC"."CDC_TIMESTAMP" <= "DELTA_WINDOW"."FMC_END_LW_TIMESTAMP"
	)
	, "DELTA_VIEW" AS 
	( 
		SELECT 
			  "DELTA_VIEW_FILTER"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP"
			, "DELTA_VIEW_FILTER"."JRN_FLAG" AS "JRN_FLAG"
			, "DELTA_VIEW_FILTER"."RECORD_TYPE" AS "RECORD_TYPE"
			, "DELTA_VIEW_FILTER"."ID" AS "ID"
			, "DELTA_VIEW_FILTER"."PARENTID" AS "PARENTID"
			, "DELTA_VIEW_FILTER"."OWNERID" AS "OWNERID"
			, "DELTA_VIEW_FILTER"."CREATEDBYID" AS "CREATEDBYID"
			, "DELTA_VIEW_FILTER"."LASTMODIFIEDBYID" AS "LASTMODIFIEDBYID"
			, "DELTA_VIEW_FILTER"."ISDELETED" AS "ISDELETED"
			, "DELTA_VIEW_FILTER"."NAME" AS "NAME"
			, "DELTA_VIEW_FILTER"."TYPE" AS "TYPE"
			, "DELTA_VIEW_FILTER"."STATUS" AS "STATUS"
			, "DELTA_VIEW_FILTER"."STARTDATE" AS "STARTDATE"
			, "DELTA_VIEW_FILTER"."ENDDATE" AS "ENDDATE"
			, "DELTA_VIEW_FILTER"."EXPECTEDREVENUE" AS "EXPECTEDREVENUE"
			, "DELTA_VIEW_FILTER"."BUDGETEDCOST" AS "BUDGETEDCOST"
			, "DELTA_VIEW_FILTER"."ACTUALCOST" AS "ACTUALCOST"
			, "DELTA_VIEW_FILTER"."EXPECTEDRESPONSE" AS "EXPECTEDRESPONSE"
			, "DELTA_VIEW_FILTER"."NUMBERSENT" AS "NUMBERSENT"
			, "DELTA_VIEW_FILTER"."ISACTIVE" AS "ISACTIVE"
			, "DELTA_VIEW_FILTER"."DESCRIPTION" AS "DESCRIPTION"
			, "DELTA_VIEW_FILTER"."NUMBEROFLEADS" AS "NUMBEROFLEADS"
			, "DELTA_VIEW_FILTER"."NUMBEROFCONVERTEDLEADS" AS "NUMBEROFCONVERTEDLEADS"
			, "DELTA_VIEW_FILTER"."NUMBEROFCONTACTS" AS "NUMBEROFCONTACTS"
			, "DELTA_VIEW_FILTER"."NUMBEROFRESPONSES" AS "NUMBEROFRESPONSES"
			, "DELTA_VIEW_FILTER"."NUMBEROFOPPORTUNITIES" AS "NUMBEROFOPPORTUNITIES"
			, "DELTA_VIEW_FILTER"."NUMBEROFWONOPPORTUNITIES" AS "NUMBEROFWONOPPORTUNITIES"
			, "DELTA_VIEW_FILTER"."AMOUNTALLOPPORTUNITIES" AS "AMOUNTALLOPPORTUNITIES"
			, "DELTA_VIEW_FILTER"."AMOUNTWONOPPORTUNITIES" AS "AMOUNTWONOPPORTUNITIES"
			, "DELTA_VIEW_FILTER"."HIERARCHYNUMBEROFLEADS" AS "HIERARCHYNUMBEROFLEADS"
			, "DELTA_VIEW_FILTER"."HIERARCHYNUMBEROFCONVERTEDLEADS" AS "HIERARCHYNUMBEROFCONVERTEDLEADS"
			, "DELTA_VIEW_FILTER"."HIERARCHYNUMBEROFCONTACTS" AS "HIERARCHYNUMBEROFCONTACTS"
			, "DELTA_VIEW_FILTER"."HIERARCHYNUMBEROFRESPONSES" AS "HIERARCHYNUMBEROFRESPONSES"
			, "DELTA_VIEW_FILTER"."HIERARCHYNUMBEROFOPPORTUNITIES" AS "HIERARCHYNUMBEROFOPPORTUNITIES"
			, "DELTA_VIEW_FILTER"."HIERARCHYNUMBEROFWONOPPORTUNITIES" AS "HIERARCHYNUMBEROFWONOPPORTUNITIES"
			, "DELTA_VIEW_FILTER"."HIERARCHYAMOUNTALLOPPORTUNITIES" AS "HIERARCHYAMOUNTALLOPPORTUNITIES"
			, "DELTA_VIEW_FILTER"."HIERARCHYAMOUNTWONOPPORTUNITIES" AS "HIERARCHYAMOUNTWONOPPORTUNITIES"
			, "DELTA_VIEW_FILTER"."HIERARCHYNUMBERSENT" AS "HIERARCHYNUMBERSENT"
			, "DELTA_VIEW_FILTER"."HIERARCHYEXPECTEDREVENUE" AS "HIERARCHYEXPECTEDREVENUE"
			, "DELTA_VIEW_FILTER"."HIERARCHYBUDGETEDCOST" AS "HIERARCHYBUDGETEDCOST"
			, "DELTA_VIEW_FILTER"."HIERARCHYACTUALCOST" AS "HIERARCHYACTUALCOST"
			, "DELTA_VIEW_FILTER"."CREATEDDATE" AS "CREATEDDATE"
			, "DELTA_VIEW_FILTER"."LASTMODIFIEDDATE" AS "LASTMODIFIEDDATE"
			, "DELTA_VIEW_FILTER"."SYSTEMMODSTAMP" AS "SYSTEMMODSTAMP"
			, "DELTA_VIEW_FILTER"."LASTACTIVITYDATE" AS "LASTACTIVITYDATE"
			, "DELTA_VIEW_FILTER"."CAMPAIGNMEMBERRECORDTYPEID" AS "CAMPAIGNMEMBERRECORDTYPEID"
		FROM "DELTA_VIEW_FILTER" "DELTA_VIEW_FILTER"
	)
	, "PREPJOINBK" AS 
	( 
		SELECT 
			  "DELTA_VIEW"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP"
			, "DELTA_VIEW"."JRN_FLAG" AS "JRN_FLAG"
			, "DELTA_VIEW"."RECORD_TYPE" AS "RECORD_TYPE"
			, COALESCE("DELTA_VIEW"."ID","MEX_BK_SRC"."KEY_ATTRIBUTE_VARCHAR") AS "ID"
			, COALESCE("DELTA_VIEW"."OWNERID","MEX_BK_SRC"."KEY_ATTRIBUTE_VARCHAR") AS "OWNERID"
			, COALESCE("DELTA_VIEW"."CREATEDBYID","MEX_BK_SRC"."KEY_ATTRIBUTE_VARCHAR") AS "CREATEDBYID"
			, COALESCE("DELTA_VIEW"."PARENTID","MEX_BK_SRC"."KEY_ATTRIBUTE_VARCHAR") AS "PARENTID"
			, COALESCE("DELTA_VIEW"."LASTMODIFIEDBYID","MEX_BK_SRC"."KEY_ATTRIBUTE_VARCHAR") AS "LASTMODIFIEDBYID"
			, "DELTA_VIEW"."ISDELETED" AS "ISDELETED"
			, "DELTA_VIEW"."NAME" AS "NAME"
			, "DELTA_VIEW"."TYPE" AS "TYPE"
			, "DELTA_VIEW"."STATUS" AS "STATUS"
			, "DELTA_VIEW"."STARTDATE" AS "STARTDATE"
			, "DELTA_VIEW"."ENDDATE" AS "ENDDATE"
			, "DELTA_VIEW"."EXPECTEDREVENUE" AS "EXPECTEDREVENUE"
			, "DELTA_VIEW"."BUDGETEDCOST" AS "BUDGETEDCOST"
			, "DELTA_VIEW"."ACTUALCOST" AS "ACTUALCOST"
			, "DELTA_VIEW"."EXPECTEDRESPONSE" AS "EXPECTEDRESPONSE"
			, "DELTA_VIEW"."NUMBERSENT" AS "NUMBERSENT"
			, "DELTA_VIEW"."ISACTIVE" AS "ISACTIVE"
			, "DELTA_VIEW"."DESCRIPTION" AS "DESCRIPTION"
			, "DELTA_VIEW"."NUMBEROFLEADS" AS "NUMBEROFLEADS"
			, "DELTA_VIEW"."NUMBEROFCONVERTEDLEADS" AS "NUMBEROFCONVERTEDLEADS"
			, "DELTA_VIEW"."NUMBEROFCONTACTS" AS "NUMBEROFCONTACTS"
			, "DELTA_VIEW"."NUMBEROFRESPONSES" AS "NUMBEROFRESPONSES"
			, "DELTA_VIEW"."NUMBEROFOPPORTUNITIES" AS "NUMBEROFOPPORTUNITIES"
			, "DELTA_VIEW"."NUMBEROFWONOPPORTUNITIES" AS "NUMBEROFWONOPPORTUNITIES"
			, "DELTA_VIEW"."AMOUNTALLOPPORTUNITIES" AS "AMOUNTALLOPPORTUNITIES"
			, "DELTA_VIEW"."AMOUNTWONOPPORTUNITIES" AS "AMOUNTWONOPPORTUNITIES"
			, "DELTA_VIEW"."HIERARCHYNUMBEROFLEADS" AS "HIERARCHYNUMBEROFLEADS"
			, "DELTA_VIEW"."HIERARCHYNUMBEROFCONVERTEDLEADS" AS "HIERARCHYNUMBEROFCONVERTEDLEADS"
			, "DELTA_VIEW"."HIERARCHYNUMBEROFCONTACTS" AS "HIERARCHYNUMBEROFCONTACTS"
			, "DELTA_VIEW"."HIERARCHYNUMBEROFRESPONSES" AS "HIERARCHYNUMBEROFRESPONSES"
			, "DELTA_VIEW"."HIERARCHYNUMBEROFOPPORTUNITIES" AS "HIERARCHYNUMBEROFOPPORTUNITIES"
			, "DELTA_VIEW"."HIERARCHYNUMBEROFWONOPPORTUNITIES" AS "HIERARCHYNUMBEROFWONOPPORTUNITIES"
			, "DELTA_VIEW"."HIERARCHYAMOUNTALLOPPORTUNITIES" AS "HIERARCHYAMOUNTALLOPPORTUNITIES"
			, "DELTA_VIEW"."HIERARCHYAMOUNTWONOPPORTUNITIES" AS "HIERARCHYAMOUNTWONOPPORTUNITIES"
			, "DELTA_VIEW"."HIERARCHYNUMBERSENT" AS "HIERARCHYNUMBERSENT"
			, "DELTA_VIEW"."HIERARCHYEXPECTEDREVENUE" AS "HIERARCHYEXPECTEDREVENUE"
			, "DELTA_VIEW"."HIERARCHYBUDGETEDCOST" AS "HIERARCHYBUDGETEDCOST"
			, "DELTA_VIEW"."HIERARCHYACTUALCOST" AS "HIERARCHYACTUALCOST"
			, "DELTA_VIEW"."CREATEDDATE" AS "CREATEDDATE"
			, "DELTA_VIEW"."LASTMODIFIEDDATE" AS "LASTMODIFIEDDATE"
			, "DELTA_VIEW"."SYSTEMMODSTAMP" AS "SYSTEMMODSTAMP"
			, "DELTA_VIEW"."LASTACTIVITYDATE" AS "LASTACTIVITYDATE"
			, "DELTA_VIEW"."CAMPAIGNMEMBERRECORDTYPEID" AS "CAMPAIGNMEMBERRECORDTYPEID"
		FROM "DELTA_VIEW" "DELTA_VIEW"
		INNER JOIN {{ source('SALESFORCE_MTD', 'MTD_EXCEPTION_RECORDS') }} "MEX_BK_SRC" ON  1 = 1
		WHERE  "MEX_BK_SRC"."RECORD_TYPE" = 'N'
	)
	SELECT 
		  "PREPJOINBK"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP"
		, "PREPJOINBK"."JRN_FLAG" AS "JRN_FLAG"
		, "PREPJOINBK"."RECORD_TYPE" AS "RECORD_TYPE"
		, "PREPJOINBK"."ID" AS "ID"
		, "PREPJOINBK"."PARENTID" AS "PARENTID"
		, "PREPJOINBK"."OWNERID" AS "OWNERID"
		, "PREPJOINBK"."CREATEDBYID" AS "CREATEDBYID"
		, "PREPJOINBK"."LASTMODIFIEDBYID" AS "LASTMODIFIEDBYID"
		, "PREPJOINBK"."ISDELETED" AS "ISDELETED"
		, "PREPJOINBK"."NAME" AS "NAME"
		, "PREPJOINBK"."TYPE" AS "TYPE"
		, "PREPJOINBK"."STATUS" AS "STATUS"
		, "PREPJOINBK"."STARTDATE" AS "STARTDATE"
		, "PREPJOINBK"."ENDDATE" AS "ENDDATE"
		, "PREPJOINBK"."EXPECTEDREVENUE" AS "EXPECTEDREVENUE"
		, "PREPJOINBK"."BUDGETEDCOST" AS "BUDGETEDCOST"
		, "PREPJOINBK"."ACTUALCOST" AS "ACTUALCOST"
		, "PREPJOINBK"."EXPECTEDRESPONSE" AS "EXPECTEDRESPONSE"
		, "PREPJOINBK"."NUMBERSENT" AS "NUMBERSENT"
		, "PREPJOINBK"."ISACTIVE" AS "ISACTIVE"
		, "PREPJOINBK"."DESCRIPTION" AS "DESCRIPTION"
		, "PREPJOINBK"."NUMBEROFLEADS" AS "NUMBEROFLEADS"
		, "PREPJOINBK"."NUMBEROFCONVERTEDLEADS" AS "NUMBEROFCONVERTEDLEADS"
		, "PREPJOINBK"."NUMBEROFCONTACTS" AS "NUMBEROFCONTACTS"
		, "PREPJOINBK"."NUMBEROFRESPONSES" AS "NUMBEROFRESPONSES"
		, "PREPJOINBK"."NUMBEROFOPPORTUNITIES" AS "NUMBEROFOPPORTUNITIES"
		, "PREPJOINBK"."NUMBEROFWONOPPORTUNITIES" AS "NUMBEROFWONOPPORTUNITIES"
		, "PREPJOINBK"."AMOUNTALLOPPORTUNITIES" AS "AMOUNTALLOPPORTUNITIES"
		, "PREPJOINBK"."AMOUNTWONOPPORTUNITIES" AS "AMOUNTWONOPPORTUNITIES"
		, "PREPJOINBK"."HIERARCHYNUMBEROFLEADS" AS "HIERARCHYNUMBEROFLEADS"
		, "PREPJOINBK"."HIERARCHYNUMBEROFCONVERTEDLEADS" AS "HIERARCHYNUMBEROFCONVERTEDLEADS"
		, "PREPJOINBK"."HIERARCHYNUMBEROFCONTACTS" AS "HIERARCHYNUMBEROFCONTACTS"
		, "PREPJOINBK"."HIERARCHYNUMBEROFRESPONSES" AS "HIERARCHYNUMBEROFRESPONSES"
		, "PREPJOINBK"."HIERARCHYNUMBEROFOPPORTUNITIES" AS "HIERARCHYNUMBEROFOPPORTUNITIES"
		, "PREPJOINBK"."HIERARCHYNUMBEROFWONOPPORTUNITIES" AS "HIERARCHYNUMBEROFWONOPPORTUNITIES"
		, "PREPJOINBK"."HIERARCHYAMOUNTALLOPPORTUNITIES" AS "HIERARCHYAMOUNTALLOPPORTUNITIES"
		, "PREPJOINBK"."HIERARCHYAMOUNTWONOPPORTUNITIES" AS "HIERARCHYAMOUNTWONOPPORTUNITIES"
		, "PREPJOINBK"."HIERARCHYNUMBERSENT" AS "HIERARCHYNUMBERSENT"
		, "PREPJOINBK"."HIERARCHYEXPECTEDREVENUE" AS "HIERARCHYEXPECTEDREVENUE"
		, "PREPJOINBK"."HIERARCHYBUDGETEDCOST" AS "HIERARCHYBUDGETEDCOST"
		, "PREPJOINBK"."HIERARCHYACTUALCOST" AS "HIERARCHYACTUALCOST"
		, "PREPJOINBK"."CREATEDDATE" AS "CREATEDDATE"
		, "PREPJOINBK"."LASTMODIFIEDDATE" AS "LASTMODIFIEDDATE"
		, "PREPJOINBK"."SYSTEMMODSTAMP" AS "SYSTEMMODSTAMP"
		, "PREPJOINBK"."LASTACTIVITYDATE" AS "LASTACTIVITYDATE"
		, "PREPJOINBK"."CAMPAIGNMEMBERRECORDTYPEID" AS "CAMPAIGNMEMBERRECORDTYPEID"
	FROM "PREPJOINBK" "PREPJOINBK"
