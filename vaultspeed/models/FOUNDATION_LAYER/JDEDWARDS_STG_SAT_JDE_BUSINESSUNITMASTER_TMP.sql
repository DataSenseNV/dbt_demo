{{
	config(
		materialized='incremental',
		pre_hook= [
			'{% if var("load_type") == "INCR" and var("source") == "JDEDWARDS" %} TRUNCATE TABLE {{ this }}; {% endif %}'
		],
		alias='SAT_JDE_BUSINESSUNITMASTER_TMP',
		schema='JDEDWARDS_STG',
		tags=['JDEDWARDS', 'SAT_JDE_BUSINESSUNITMASTER_INCR']
	)
}}
select * from (
	WITH "DIST_STG" AS 
	( 
		SELECT DISTINCT 
 			  "STG_DIS_SRC"."BUSINESSUNITMASTER_HKEY" AS "BUSINESSUNITMASTER_HKEY"
			, "STG_DIS_SRC"."LOAD_CYCLE_ID" AS "LOAD_CYCLE_ID"
		FROM {{ ref('JDEDWARDS_STG_F0006') }} "STG_DIS_SRC"
		WHERE  "STG_DIS_SRC"."RECORD_TYPE" = 'S'
	)
	, "TEMP_TABLE_SET" AS 
	( 
		SELECT 
			  "STG_TEMP_SRC"."BUSINESSUNITMASTER_HKEY" AS "BUSINESSUNITMASTER_HKEY"
			, "STG_TEMP_SRC"."LOAD_DATE" AS "LOAD_DATE"
			, "STG_TEMP_SRC"."LOAD_CYCLE_ID" AS "LOAD_CYCLE_ID"
			, TO_TIMESTAMP('31/12/2999 23:59:59', 'DD/MM/YYYY HH24:MI:SS') AS "LOAD_END_DATE"
			, "STG_TEMP_SRC"."RECORD_TYPE" AS "RECORD_TYPE"
			, 'STG' AS "SOURCE"
			, 1 AS "ORIGIN_ID"
			, UPPER(MD5_HEX(COALESCE(RTRIM( UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCSTYL"),'~'),'\#','\\' || '\#'))
				|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCDC"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCLDM"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCCO"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."MCAN8O")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCCNTY"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCADDS"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCFMOD"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCDL01"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCDL02"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCDL03"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCDL04"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP01"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP02"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP03"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP04"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP05"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP06"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP07"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP08"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP09"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP10"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP11"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP12"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP13"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP14"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP15"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP16"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP17"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP18"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP19"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP20"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP21"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP22"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP23"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP24"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP25"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP26"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP27"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP28"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP29"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP30"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCTA"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."MCTXJS")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCTXA1"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCEXR1"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCTC01"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCTC02"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCTC03"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCTC04"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCTC05"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCTC06"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCTC07"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCTC08"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCTC09"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCTC10"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCND01"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCND02"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCND03"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCND04"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCND05"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCND06"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCND07"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCND08"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCND09"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCND10"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCCC01"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCCC02"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCCC03"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCCC04"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCCC05"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCCC06"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCCC07"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCCC08"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCCC09"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCCC10"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCPECC"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCALS"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCISS"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCGLBA"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCALCL"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCLMTH"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."MCLF")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCOBJ1"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCOBJ2"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCOBJ3"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCSUB1"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."MCTOU")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCSBLI"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."MCANPA")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCCT"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCCERT"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCMCUS"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCBTYP"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."MCPC")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."MCPCA")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."MCPCC")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCINTA"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCINTL"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."MCD1J")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."MCD2J")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."MCD3J")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."MCD4J")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."MCD5J")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."MCD6J")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."MCFPDJ")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."MCCAC")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."MCPAC")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCEEO"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCERC"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCUSER"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCPID"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."MCUPMJ")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCJOBN"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."MCUPMT")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCBPTP"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCAPSB"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCTSBU"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP31"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP32"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP33"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP34"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP35"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP36"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP37"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP38"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP39"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP40"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP41"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP42"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP43"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP44"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP45"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP46"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP47"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP48"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP49"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRP50"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."MCAN8GCA1")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."MCAN8GCA2")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."MCAN8GCA3")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."MCAN8GCA4")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."MCAN8GCA5")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCRMCU1"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."MCDOCO")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."MCPCTN")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."MCCLNU")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCBUCA"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCADJENT"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."MCUAFL"),'~'),'\#','\\' || '\#'))|| '\#','\#' || '~'),'~') )) AS "HASH_DIFF"
			, CASE WHEN "STG_TEMP_SRC"."JRN_FLAG" = 'D' THEN CAST('Y' AS VARCHAR) ELSE CAST('N' AS VARCHAR) END AS "DELETE_FLAG"
			, "STG_TEMP_SRC"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP"
			, "STG_TEMP_SRC"."MCMCU" AS "MCMCU"
			, "STG_TEMP_SRC"."MCAN8" AS "MCAN8"
			, "STG_TEMP_SRC"."MCSTYL" AS "MCSTYL"
			, "STG_TEMP_SRC"."MCDC" AS "MCDC"
			, "STG_TEMP_SRC"."MCLDM" AS "MCLDM"
			, "STG_TEMP_SRC"."MCCO" AS "MCCO"
			, "STG_TEMP_SRC"."MCAN8O" AS "MCAN8O"
			, "STG_TEMP_SRC"."MCCNTY" AS "MCCNTY"
			, "STG_TEMP_SRC"."MCADDS" AS "MCADDS"
			, "STG_TEMP_SRC"."MCFMOD" AS "MCFMOD"
			, "STG_TEMP_SRC"."MCDL01" AS "MCDL01"
			, "STG_TEMP_SRC"."MCDL02" AS "MCDL02"
			, "STG_TEMP_SRC"."MCDL03" AS "MCDL03"
			, "STG_TEMP_SRC"."MCDL04" AS "MCDL04"
			, "STG_TEMP_SRC"."MCRP01" AS "MCRP01"
			, "STG_TEMP_SRC"."MCRP02" AS "MCRP02"
			, "STG_TEMP_SRC"."MCRP03" AS "MCRP03"
			, "STG_TEMP_SRC"."MCRP04" AS "MCRP04"
			, "STG_TEMP_SRC"."MCRP05" AS "MCRP05"
			, "STG_TEMP_SRC"."MCRP06" AS "MCRP06"
			, "STG_TEMP_SRC"."MCRP07" AS "MCRP07"
			, "STG_TEMP_SRC"."MCRP08" AS "MCRP08"
			, "STG_TEMP_SRC"."MCRP09" AS "MCRP09"
			, "STG_TEMP_SRC"."MCRP10" AS "MCRP10"
			, "STG_TEMP_SRC"."MCRP11" AS "MCRP11"
			, "STG_TEMP_SRC"."MCRP12" AS "MCRP12"
			, "STG_TEMP_SRC"."MCRP13" AS "MCRP13"
			, "STG_TEMP_SRC"."MCRP14" AS "MCRP14"
			, "STG_TEMP_SRC"."MCRP15" AS "MCRP15"
			, "STG_TEMP_SRC"."MCRP16" AS "MCRP16"
			, "STG_TEMP_SRC"."MCRP17" AS "MCRP17"
			, "STG_TEMP_SRC"."MCRP18" AS "MCRP18"
			, "STG_TEMP_SRC"."MCRP19" AS "MCRP19"
			, "STG_TEMP_SRC"."MCRP20" AS "MCRP20"
			, "STG_TEMP_SRC"."MCRP21" AS "MCRP21"
			, "STG_TEMP_SRC"."MCRP22" AS "MCRP22"
			, "STG_TEMP_SRC"."MCRP23" AS "MCRP23"
			, "STG_TEMP_SRC"."MCRP24" AS "MCRP24"
			, "STG_TEMP_SRC"."MCRP25" AS "MCRP25"
			, "STG_TEMP_SRC"."MCRP26" AS "MCRP26"
			, "STG_TEMP_SRC"."MCRP27" AS "MCRP27"
			, "STG_TEMP_SRC"."MCRP28" AS "MCRP28"
			, "STG_TEMP_SRC"."MCRP29" AS "MCRP29"
			, "STG_TEMP_SRC"."MCRP30" AS "MCRP30"
			, "STG_TEMP_SRC"."MCTA" AS "MCTA"
			, "STG_TEMP_SRC"."MCTXJS" AS "MCTXJS"
			, "STG_TEMP_SRC"."MCTXA1" AS "MCTXA1"
			, "STG_TEMP_SRC"."MCEXR1" AS "MCEXR1"
			, "STG_TEMP_SRC"."MCTC01" AS "MCTC01"
			, "STG_TEMP_SRC"."MCTC02" AS "MCTC02"
			, "STG_TEMP_SRC"."MCTC03" AS "MCTC03"
			, "STG_TEMP_SRC"."MCTC04" AS "MCTC04"
			, "STG_TEMP_SRC"."MCTC05" AS "MCTC05"
			, "STG_TEMP_SRC"."MCTC06" AS "MCTC06"
			, "STG_TEMP_SRC"."MCTC07" AS "MCTC07"
			, "STG_TEMP_SRC"."MCTC08" AS "MCTC08"
			, "STG_TEMP_SRC"."MCTC09" AS "MCTC09"
			, "STG_TEMP_SRC"."MCTC10" AS "MCTC10"
			, "STG_TEMP_SRC"."MCND01" AS "MCND01"
			, "STG_TEMP_SRC"."MCND02" AS "MCND02"
			, "STG_TEMP_SRC"."MCND03" AS "MCND03"
			, "STG_TEMP_SRC"."MCND04" AS "MCND04"
			, "STG_TEMP_SRC"."MCND05" AS "MCND05"
			, "STG_TEMP_SRC"."MCND06" AS "MCND06"
			, "STG_TEMP_SRC"."MCND07" AS "MCND07"
			, "STG_TEMP_SRC"."MCND08" AS "MCND08"
			, "STG_TEMP_SRC"."MCND09" AS "MCND09"
			, "STG_TEMP_SRC"."MCND10" AS "MCND10"
			, "STG_TEMP_SRC"."MCCC01" AS "MCCC01"
			, "STG_TEMP_SRC"."MCCC02" AS "MCCC02"
			, "STG_TEMP_SRC"."MCCC03" AS "MCCC03"
			, "STG_TEMP_SRC"."MCCC04" AS "MCCC04"
			, "STG_TEMP_SRC"."MCCC05" AS "MCCC05"
			, "STG_TEMP_SRC"."MCCC06" AS "MCCC06"
			, "STG_TEMP_SRC"."MCCC07" AS "MCCC07"
			, "STG_TEMP_SRC"."MCCC08" AS "MCCC08"
			, "STG_TEMP_SRC"."MCCC09" AS "MCCC09"
			, "STG_TEMP_SRC"."MCCC10" AS "MCCC10"
			, "STG_TEMP_SRC"."MCPECC" AS "MCPECC"
			, "STG_TEMP_SRC"."MCALS" AS "MCALS"
			, "STG_TEMP_SRC"."MCISS" AS "MCISS"
			, "STG_TEMP_SRC"."MCGLBA" AS "MCGLBA"
			, "STG_TEMP_SRC"."MCALCL" AS "MCALCL"
			, "STG_TEMP_SRC"."MCLMTH" AS "MCLMTH"
			, "STG_TEMP_SRC"."MCLF" AS "MCLF"
			, "STG_TEMP_SRC"."MCOBJ1" AS "MCOBJ1"
			, "STG_TEMP_SRC"."MCOBJ2" AS "MCOBJ2"
			, "STG_TEMP_SRC"."MCOBJ3" AS "MCOBJ3"
			, "STG_TEMP_SRC"."MCSUB1" AS "MCSUB1"
			, "STG_TEMP_SRC"."MCTOU" AS "MCTOU"
			, "STG_TEMP_SRC"."MCSBLI" AS "MCSBLI"
			, "STG_TEMP_SRC"."MCANPA" AS "MCANPA"
			, "STG_TEMP_SRC"."MCCT" AS "MCCT"
			, "STG_TEMP_SRC"."MCCERT" AS "MCCERT"
			, "STG_TEMP_SRC"."MCMCUS" AS "MCMCUS"
			, "STG_TEMP_SRC"."MCBTYP" AS "MCBTYP"
			, "STG_TEMP_SRC"."MCPC" AS "MCPC"
			, "STG_TEMP_SRC"."MCPCA" AS "MCPCA"
			, "STG_TEMP_SRC"."MCPCC" AS "MCPCC"
			, "STG_TEMP_SRC"."MCINTA" AS "MCINTA"
			, "STG_TEMP_SRC"."MCINTL" AS "MCINTL"
			, "STG_TEMP_SRC"."MCD1J" AS "MCD1J"
			, "STG_TEMP_SRC"."MCD2J" AS "MCD2J"
			, "STG_TEMP_SRC"."MCD3J" AS "MCD3J"
			, "STG_TEMP_SRC"."MCD4J" AS "MCD4J"
			, "STG_TEMP_SRC"."MCD5J" AS "MCD5J"
			, "STG_TEMP_SRC"."MCD6J" AS "MCD6J"
			, "STG_TEMP_SRC"."MCFPDJ" AS "MCFPDJ"
			, "STG_TEMP_SRC"."MCCAC" AS "MCCAC"
			, "STG_TEMP_SRC"."MCPAC" AS "MCPAC"
			, "STG_TEMP_SRC"."MCEEO" AS "MCEEO"
			, "STG_TEMP_SRC"."MCERC" AS "MCERC"
			, "STG_TEMP_SRC"."MCUSER" AS "MCUSER"
			, "STG_TEMP_SRC"."MCPID" AS "MCPID"
			, "STG_TEMP_SRC"."MCUPMJ" AS "MCUPMJ"
			, "STG_TEMP_SRC"."MCJOBN" AS "MCJOBN"
			, "STG_TEMP_SRC"."MCUPMT" AS "MCUPMT"
			, "STG_TEMP_SRC"."MCBPTP" AS "MCBPTP"
			, "STG_TEMP_SRC"."MCAPSB" AS "MCAPSB"
			, "STG_TEMP_SRC"."MCTSBU" AS "MCTSBU"
			, "STG_TEMP_SRC"."MCRP31" AS "MCRP31"
			, "STG_TEMP_SRC"."MCRP32" AS "MCRP32"
			, "STG_TEMP_SRC"."MCRP33" AS "MCRP33"
			, "STG_TEMP_SRC"."MCRP34" AS "MCRP34"
			, "STG_TEMP_SRC"."MCRP35" AS "MCRP35"
			, "STG_TEMP_SRC"."MCRP36" AS "MCRP36"
			, "STG_TEMP_SRC"."MCRP37" AS "MCRP37"
			, "STG_TEMP_SRC"."MCRP38" AS "MCRP38"
			, "STG_TEMP_SRC"."MCRP39" AS "MCRP39"
			, "STG_TEMP_SRC"."MCRP40" AS "MCRP40"
			, "STG_TEMP_SRC"."MCRP41" AS "MCRP41"
			, "STG_TEMP_SRC"."MCRP42" AS "MCRP42"
			, "STG_TEMP_SRC"."MCRP43" AS "MCRP43"
			, "STG_TEMP_SRC"."MCRP44" AS "MCRP44"
			, "STG_TEMP_SRC"."MCRP45" AS "MCRP45"
			, "STG_TEMP_SRC"."MCRP46" AS "MCRP46"
			, "STG_TEMP_SRC"."MCRP47" AS "MCRP47"
			, "STG_TEMP_SRC"."MCRP48" AS "MCRP48"
			, "STG_TEMP_SRC"."MCRP49" AS "MCRP49"
			, "STG_TEMP_SRC"."MCRP50" AS "MCRP50"
			, "STG_TEMP_SRC"."MCAN8GCA1" AS "MCAN8GCA1"
			, "STG_TEMP_SRC"."MCAN8GCA2" AS "MCAN8GCA2"
			, "STG_TEMP_SRC"."MCAN8GCA3" AS "MCAN8GCA3"
			, "STG_TEMP_SRC"."MCAN8GCA4" AS "MCAN8GCA4"
			, "STG_TEMP_SRC"."MCAN8GCA5" AS "MCAN8GCA5"
			, "STG_TEMP_SRC"."MCRMCU1" AS "MCRMCU1"
			, "STG_TEMP_SRC"."MCDOCO" AS "MCDOCO"
			, "STG_TEMP_SRC"."MCPCTN" AS "MCPCTN"
			, "STG_TEMP_SRC"."MCCLNU" AS "MCCLNU"
			, "STG_TEMP_SRC"."MCBUCA" AS "MCBUCA"
			, "STG_TEMP_SRC"."MCADJENT" AS "MCADJENT"
			, "STG_TEMP_SRC"."MCUAFL" AS "MCUAFL"
		FROM {{ ref('JDEDWARDS_STG_F0006') }} "STG_TEMP_SRC"
		WHERE  "STG_TEMP_SRC"."RECORD_TYPE" = 'S'
		UNION ALL 
		SELECT 
			  "SAT_SRC"."BUSINESSUNITMASTER_HKEY" AS "BUSINESSUNITMASTER_HKEY"
			, "SAT_SRC"."LOAD_DATE" AS "LOAD_DATE"
			, "SAT_SRC"."LOAD_CYCLE_ID" AS "LOAD_CYCLE_ID"
			, "SAT_SRC"."LOAD_END_DATE" AS "LOAD_END_DATE"
			, 'SAT' AS "RECORD_TYPE"
			, 'SAT' AS "SOURCE"
			, 0 AS "ORIGIN_ID"
			, "SAT_SRC"."HASH_DIFF" AS "HASH_DIFF"
			, "SAT_SRC"."DELETE_FLAG" AS "DELETE_FLAG"
			, "SAT_SRC"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP"
			, "SAT_SRC"."MCMCU" AS "MCMCU"
			, "SAT_SRC"."MCAN8" AS "MCAN8"
			, "SAT_SRC"."MCSTYL" AS "MCSTYL"
			, "SAT_SRC"."MCDC" AS "MCDC"
			, "SAT_SRC"."MCLDM" AS "MCLDM"
			, "SAT_SRC"."MCCO" AS "MCCO"
			, "SAT_SRC"."MCAN8O" AS "MCAN8O"
			, "SAT_SRC"."MCCNTY" AS "MCCNTY"
			, "SAT_SRC"."MCADDS" AS "MCADDS"
			, "SAT_SRC"."MCFMOD" AS "MCFMOD"
			, "SAT_SRC"."MCDL01" AS "MCDL01"
			, "SAT_SRC"."MCDL02" AS "MCDL02"
			, "SAT_SRC"."MCDL03" AS "MCDL03"
			, "SAT_SRC"."MCDL04" AS "MCDL04"
			, "SAT_SRC"."MCRP01" AS "MCRP01"
			, "SAT_SRC"."MCRP02" AS "MCRP02"
			, "SAT_SRC"."MCRP03" AS "MCRP03"
			, "SAT_SRC"."MCRP04" AS "MCRP04"
			, "SAT_SRC"."MCRP05" AS "MCRP05"
			, "SAT_SRC"."MCRP06" AS "MCRP06"
			, "SAT_SRC"."MCRP07" AS "MCRP07"
			, "SAT_SRC"."MCRP08" AS "MCRP08"
			, "SAT_SRC"."MCRP09" AS "MCRP09"
			, "SAT_SRC"."MCRP10" AS "MCRP10"
			, "SAT_SRC"."MCRP11" AS "MCRP11"
			, "SAT_SRC"."MCRP12" AS "MCRP12"
			, "SAT_SRC"."MCRP13" AS "MCRP13"
			, "SAT_SRC"."MCRP14" AS "MCRP14"
			, "SAT_SRC"."MCRP15" AS "MCRP15"
			, "SAT_SRC"."MCRP16" AS "MCRP16"
			, "SAT_SRC"."MCRP17" AS "MCRP17"
			, "SAT_SRC"."MCRP18" AS "MCRP18"
			, "SAT_SRC"."MCRP19" AS "MCRP19"
			, "SAT_SRC"."MCRP20" AS "MCRP20"
			, "SAT_SRC"."MCRP21" AS "MCRP21"
			, "SAT_SRC"."MCRP22" AS "MCRP22"
			, "SAT_SRC"."MCRP23" AS "MCRP23"
			, "SAT_SRC"."MCRP24" AS "MCRP24"
			, "SAT_SRC"."MCRP25" AS "MCRP25"
			, "SAT_SRC"."MCRP26" AS "MCRP26"
			, "SAT_SRC"."MCRP27" AS "MCRP27"
			, "SAT_SRC"."MCRP28" AS "MCRP28"
			, "SAT_SRC"."MCRP29" AS "MCRP29"
			, "SAT_SRC"."MCRP30" AS "MCRP30"
			, "SAT_SRC"."MCTA" AS "MCTA"
			, "SAT_SRC"."MCTXJS" AS "MCTXJS"
			, "SAT_SRC"."MCTXA1" AS "MCTXA1"
			, "SAT_SRC"."MCEXR1" AS "MCEXR1"
			, "SAT_SRC"."MCTC01" AS "MCTC01"
			, "SAT_SRC"."MCTC02" AS "MCTC02"
			, "SAT_SRC"."MCTC03" AS "MCTC03"
			, "SAT_SRC"."MCTC04" AS "MCTC04"
			, "SAT_SRC"."MCTC05" AS "MCTC05"
			, "SAT_SRC"."MCTC06" AS "MCTC06"
			, "SAT_SRC"."MCTC07" AS "MCTC07"
			, "SAT_SRC"."MCTC08" AS "MCTC08"
			, "SAT_SRC"."MCTC09" AS "MCTC09"
			, "SAT_SRC"."MCTC10" AS "MCTC10"
			, "SAT_SRC"."MCND01" AS "MCND01"
			, "SAT_SRC"."MCND02" AS "MCND02"
			, "SAT_SRC"."MCND03" AS "MCND03"
			, "SAT_SRC"."MCND04" AS "MCND04"
			, "SAT_SRC"."MCND05" AS "MCND05"
			, "SAT_SRC"."MCND06" AS "MCND06"
			, "SAT_SRC"."MCND07" AS "MCND07"
			, "SAT_SRC"."MCND08" AS "MCND08"
			, "SAT_SRC"."MCND09" AS "MCND09"
			, "SAT_SRC"."MCND10" AS "MCND10"
			, "SAT_SRC"."MCCC01" AS "MCCC01"
			, "SAT_SRC"."MCCC02" AS "MCCC02"
			, "SAT_SRC"."MCCC03" AS "MCCC03"
			, "SAT_SRC"."MCCC04" AS "MCCC04"
			, "SAT_SRC"."MCCC05" AS "MCCC05"
			, "SAT_SRC"."MCCC06" AS "MCCC06"
			, "SAT_SRC"."MCCC07" AS "MCCC07"
			, "SAT_SRC"."MCCC08" AS "MCCC08"
			, "SAT_SRC"."MCCC09" AS "MCCC09"
			, "SAT_SRC"."MCCC10" AS "MCCC10"
			, "SAT_SRC"."MCPECC" AS "MCPECC"
			, "SAT_SRC"."MCALS" AS "MCALS"
			, "SAT_SRC"."MCISS" AS "MCISS"
			, "SAT_SRC"."MCGLBA" AS "MCGLBA"
			, "SAT_SRC"."MCALCL" AS "MCALCL"
			, "SAT_SRC"."MCLMTH" AS "MCLMTH"
			, "SAT_SRC"."MCLF" AS "MCLF"
			, "SAT_SRC"."MCOBJ1" AS "MCOBJ1"
			, "SAT_SRC"."MCOBJ2" AS "MCOBJ2"
			, "SAT_SRC"."MCOBJ3" AS "MCOBJ3"
			, "SAT_SRC"."MCSUB1" AS "MCSUB1"
			, "SAT_SRC"."MCTOU" AS "MCTOU"
			, "SAT_SRC"."MCSBLI" AS "MCSBLI"
			, "SAT_SRC"."MCANPA" AS "MCANPA"
			, "SAT_SRC"."MCCT" AS "MCCT"
			, "SAT_SRC"."MCCERT" AS "MCCERT"
			, "SAT_SRC"."MCMCUS" AS "MCMCUS"
			, "SAT_SRC"."MCBTYP" AS "MCBTYP"
			, "SAT_SRC"."MCPC" AS "MCPC"
			, "SAT_SRC"."MCPCA" AS "MCPCA"
			, "SAT_SRC"."MCPCC" AS "MCPCC"
			, "SAT_SRC"."MCINTA" AS "MCINTA"
			, "SAT_SRC"."MCINTL" AS "MCINTL"
			, "SAT_SRC"."MCD1J" AS "MCD1J"
			, "SAT_SRC"."MCD2J" AS "MCD2J"
			, "SAT_SRC"."MCD3J" AS "MCD3J"
			, "SAT_SRC"."MCD4J" AS "MCD4J"
			, "SAT_SRC"."MCD5J" AS "MCD5J"
			, "SAT_SRC"."MCD6J" AS "MCD6J"
			, "SAT_SRC"."MCFPDJ" AS "MCFPDJ"
			, "SAT_SRC"."MCCAC" AS "MCCAC"
			, "SAT_SRC"."MCPAC" AS "MCPAC"
			, "SAT_SRC"."MCEEO" AS "MCEEO"
			, "SAT_SRC"."MCERC" AS "MCERC"
			, "SAT_SRC"."MCUSER" AS "MCUSER"
			, "SAT_SRC"."MCPID" AS "MCPID"
			, "SAT_SRC"."MCUPMJ" AS "MCUPMJ"
			, "SAT_SRC"."MCJOBN" AS "MCJOBN"
			, "SAT_SRC"."MCUPMT" AS "MCUPMT"
			, "SAT_SRC"."MCBPTP" AS "MCBPTP"
			, "SAT_SRC"."MCAPSB" AS "MCAPSB"
			, "SAT_SRC"."MCTSBU" AS "MCTSBU"
			, "SAT_SRC"."MCRP31" AS "MCRP31"
			, "SAT_SRC"."MCRP32" AS "MCRP32"
			, "SAT_SRC"."MCRP33" AS "MCRP33"
			, "SAT_SRC"."MCRP34" AS "MCRP34"
			, "SAT_SRC"."MCRP35" AS "MCRP35"
			, "SAT_SRC"."MCRP36" AS "MCRP36"
			, "SAT_SRC"."MCRP37" AS "MCRP37"
			, "SAT_SRC"."MCRP38" AS "MCRP38"
			, "SAT_SRC"."MCRP39" AS "MCRP39"
			, "SAT_SRC"."MCRP40" AS "MCRP40"
			, "SAT_SRC"."MCRP41" AS "MCRP41"
			, "SAT_SRC"."MCRP42" AS "MCRP42"
			, "SAT_SRC"."MCRP43" AS "MCRP43"
			, "SAT_SRC"."MCRP44" AS "MCRP44"
			, "SAT_SRC"."MCRP45" AS "MCRP45"
			, "SAT_SRC"."MCRP46" AS "MCRP46"
			, "SAT_SRC"."MCRP47" AS "MCRP47"
			, "SAT_SRC"."MCRP48" AS "MCRP48"
			, "SAT_SRC"."MCRP49" AS "MCRP49"
			, "SAT_SRC"."MCRP50" AS "MCRP50"
			, "SAT_SRC"."MCAN8GCA1" AS "MCAN8GCA1"
			, "SAT_SRC"."MCAN8GCA2" AS "MCAN8GCA2"
			, "SAT_SRC"."MCAN8GCA3" AS "MCAN8GCA3"
			, "SAT_SRC"."MCAN8GCA4" AS "MCAN8GCA4"
			, "SAT_SRC"."MCAN8GCA5" AS "MCAN8GCA5"
			, "SAT_SRC"."MCRMCU1" AS "MCRMCU1"
			, "SAT_SRC"."MCDOCO" AS "MCDOCO"
			, "SAT_SRC"."MCPCTN" AS "MCPCTN"
			, "SAT_SRC"."MCCLNU" AS "MCCLNU"
			, "SAT_SRC"."MCBUCA" AS "MCBUCA"
			, "SAT_SRC"."MCADJENT" AS "MCADJENT"
			, "SAT_SRC"."MCUAFL" AS "MCUAFL"
		FROM {{ source('DEMO_FL', 'SAT_JDE_BUSINESSUNITMASTER') }} "SAT_SRC"
		INNER JOIN "DIST_STG" "DIST_STG" ON  "SAT_SRC"."BUSINESSUNITMASTER_HKEY" = "DIST_STG"."BUSINESSUNITMASTER_HKEY"
		WHERE  "SAT_SRC"."LOAD_END_DATE" = TO_TIMESTAMP('31/12/2999 23:59:59' , 'DD/MM/YYYY HH24:MI:SS')
	)
	SELECT 
		  "TEMP_TABLE_SET"."BUSINESSUNITMASTER_HKEY" AS "BUSINESSUNITMASTER_HKEY"
		, "TEMP_TABLE_SET"."LOAD_DATE" AS "LOAD_DATE"
		, "TEMP_TABLE_SET"."LOAD_END_DATE" AS "LOAD_END_DATE"
		, "TEMP_TABLE_SET"."LOAD_CYCLE_ID" AS "LOAD_CYCLE_ID"
		, "TEMP_TABLE_SET"."RECORD_TYPE" AS "RECORD_TYPE"
		, "TEMP_TABLE_SET"."SOURCE" AS "SOURCE"
		, CASE WHEN "TEMP_TABLE_SET"."SOURCE" = 'STG' AND TO_CHAR("TEMP_TABLE_SET"."DELETE_FLAG") || TO_CHAR("TEMP_TABLE_SET"."HASH_DIFF")
			= LAG( TO_CHAR("TEMP_TABLE_SET"."DELETE_FLAG") || TO_CHAR("TEMP_TABLE_SET"."HASH_DIFF"),1)OVER(PARTITION BY "TEMP_TABLE_SET"."BUSINESSUNITMASTER_HKEY" ORDER BY "TEMP_TABLE_SET"."LOAD_DATE","TEMP_TABLE_SET"."ORIGIN_ID")THEN 1 ELSE 0 END AS "EQUAL"
		, "TEMP_TABLE_SET"."HASH_DIFF" AS "HASH_DIFF"
		, "TEMP_TABLE_SET"."DELETE_FLAG" AS "DELETE_FLAG"
		, "TEMP_TABLE_SET"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP"
		, "TEMP_TABLE_SET"."MCMCU" AS "MCMCU"
		, "TEMP_TABLE_SET"."MCAN8" AS "MCAN8"
		, "TEMP_TABLE_SET"."MCSTYL" AS "MCSTYL"
		, "TEMP_TABLE_SET"."MCDC" AS "MCDC"
		, "TEMP_TABLE_SET"."MCLDM" AS "MCLDM"
		, "TEMP_TABLE_SET"."MCCO" AS "MCCO"
		, "TEMP_TABLE_SET"."MCAN8O" AS "MCAN8O"
		, "TEMP_TABLE_SET"."MCCNTY" AS "MCCNTY"
		, "TEMP_TABLE_SET"."MCADDS" AS "MCADDS"
		, "TEMP_TABLE_SET"."MCFMOD" AS "MCFMOD"
		, "TEMP_TABLE_SET"."MCDL01" AS "MCDL01"
		, "TEMP_TABLE_SET"."MCDL02" AS "MCDL02"
		, "TEMP_TABLE_SET"."MCDL03" AS "MCDL03"
		, "TEMP_TABLE_SET"."MCDL04" AS "MCDL04"
		, "TEMP_TABLE_SET"."MCRP01" AS "MCRP01"
		, "TEMP_TABLE_SET"."MCRP02" AS "MCRP02"
		, "TEMP_TABLE_SET"."MCRP03" AS "MCRP03"
		, "TEMP_TABLE_SET"."MCRP04" AS "MCRP04"
		, "TEMP_TABLE_SET"."MCRP05" AS "MCRP05"
		, "TEMP_TABLE_SET"."MCRP06" AS "MCRP06"
		, "TEMP_TABLE_SET"."MCRP07" AS "MCRP07"
		, "TEMP_TABLE_SET"."MCRP08" AS "MCRP08"
		, "TEMP_TABLE_SET"."MCRP09" AS "MCRP09"
		, "TEMP_TABLE_SET"."MCRP10" AS "MCRP10"
		, "TEMP_TABLE_SET"."MCRP11" AS "MCRP11"
		, "TEMP_TABLE_SET"."MCRP12" AS "MCRP12"
		, "TEMP_TABLE_SET"."MCRP13" AS "MCRP13"
		, "TEMP_TABLE_SET"."MCRP14" AS "MCRP14"
		, "TEMP_TABLE_SET"."MCRP15" AS "MCRP15"
		, "TEMP_TABLE_SET"."MCRP16" AS "MCRP16"
		, "TEMP_TABLE_SET"."MCRP17" AS "MCRP17"
		, "TEMP_TABLE_SET"."MCRP18" AS "MCRP18"
		, "TEMP_TABLE_SET"."MCRP19" AS "MCRP19"
		, "TEMP_TABLE_SET"."MCRP20" AS "MCRP20"
		, "TEMP_TABLE_SET"."MCRP21" AS "MCRP21"
		, "TEMP_TABLE_SET"."MCRP22" AS "MCRP22"
		, "TEMP_TABLE_SET"."MCRP23" AS "MCRP23"
		, "TEMP_TABLE_SET"."MCRP24" AS "MCRP24"
		, "TEMP_TABLE_SET"."MCRP25" AS "MCRP25"
		, "TEMP_TABLE_SET"."MCRP26" AS "MCRP26"
		, "TEMP_TABLE_SET"."MCRP27" AS "MCRP27"
		, "TEMP_TABLE_SET"."MCRP28" AS "MCRP28"
		, "TEMP_TABLE_SET"."MCRP29" AS "MCRP29"
		, "TEMP_TABLE_SET"."MCRP30" AS "MCRP30"
		, "TEMP_TABLE_SET"."MCTA" AS "MCTA"
		, "TEMP_TABLE_SET"."MCTXJS" AS "MCTXJS"
		, "TEMP_TABLE_SET"."MCTXA1" AS "MCTXA1"
		, "TEMP_TABLE_SET"."MCEXR1" AS "MCEXR1"
		, "TEMP_TABLE_SET"."MCTC01" AS "MCTC01"
		, "TEMP_TABLE_SET"."MCTC02" AS "MCTC02"
		, "TEMP_TABLE_SET"."MCTC03" AS "MCTC03"
		, "TEMP_TABLE_SET"."MCTC04" AS "MCTC04"
		, "TEMP_TABLE_SET"."MCTC05" AS "MCTC05"
		, "TEMP_TABLE_SET"."MCTC06" AS "MCTC06"
		, "TEMP_TABLE_SET"."MCTC07" AS "MCTC07"
		, "TEMP_TABLE_SET"."MCTC08" AS "MCTC08"
		, "TEMP_TABLE_SET"."MCTC09" AS "MCTC09"
		, "TEMP_TABLE_SET"."MCTC10" AS "MCTC10"
		, "TEMP_TABLE_SET"."MCND01" AS "MCND01"
		, "TEMP_TABLE_SET"."MCND02" AS "MCND02"
		, "TEMP_TABLE_SET"."MCND03" AS "MCND03"
		, "TEMP_TABLE_SET"."MCND04" AS "MCND04"
		, "TEMP_TABLE_SET"."MCND05" AS "MCND05"
		, "TEMP_TABLE_SET"."MCND06" AS "MCND06"
		, "TEMP_TABLE_SET"."MCND07" AS "MCND07"
		, "TEMP_TABLE_SET"."MCND08" AS "MCND08"
		, "TEMP_TABLE_SET"."MCND09" AS "MCND09"
		, "TEMP_TABLE_SET"."MCND10" AS "MCND10"
		, "TEMP_TABLE_SET"."MCCC01" AS "MCCC01"
		, "TEMP_TABLE_SET"."MCCC02" AS "MCCC02"
		, "TEMP_TABLE_SET"."MCCC03" AS "MCCC03"
		, "TEMP_TABLE_SET"."MCCC04" AS "MCCC04"
		, "TEMP_TABLE_SET"."MCCC05" AS "MCCC05"
		, "TEMP_TABLE_SET"."MCCC06" AS "MCCC06"
		, "TEMP_TABLE_SET"."MCCC07" AS "MCCC07"
		, "TEMP_TABLE_SET"."MCCC08" AS "MCCC08"
		, "TEMP_TABLE_SET"."MCCC09" AS "MCCC09"
		, "TEMP_TABLE_SET"."MCCC10" AS "MCCC10"
		, "TEMP_TABLE_SET"."MCPECC" AS "MCPECC"
		, "TEMP_TABLE_SET"."MCALS" AS "MCALS"
		, "TEMP_TABLE_SET"."MCISS" AS "MCISS"
		, "TEMP_TABLE_SET"."MCGLBA" AS "MCGLBA"
		, "TEMP_TABLE_SET"."MCALCL" AS "MCALCL"
		, "TEMP_TABLE_SET"."MCLMTH" AS "MCLMTH"
		, "TEMP_TABLE_SET"."MCLF" AS "MCLF"
		, "TEMP_TABLE_SET"."MCOBJ1" AS "MCOBJ1"
		, "TEMP_TABLE_SET"."MCOBJ2" AS "MCOBJ2"
		, "TEMP_TABLE_SET"."MCOBJ3" AS "MCOBJ3"
		, "TEMP_TABLE_SET"."MCSUB1" AS "MCSUB1"
		, "TEMP_TABLE_SET"."MCTOU" AS "MCTOU"
		, "TEMP_TABLE_SET"."MCSBLI" AS "MCSBLI"
		, "TEMP_TABLE_SET"."MCANPA" AS "MCANPA"
		, "TEMP_TABLE_SET"."MCCT" AS "MCCT"
		, "TEMP_TABLE_SET"."MCCERT" AS "MCCERT"
		, "TEMP_TABLE_SET"."MCMCUS" AS "MCMCUS"
		, "TEMP_TABLE_SET"."MCBTYP" AS "MCBTYP"
		, "TEMP_TABLE_SET"."MCPC" AS "MCPC"
		, "TEMP_TABLE_SET"."MCPCA" AS "MCPCA"
		, "TEMP_TABLE_SET"."MCPCC" AS "MCPCC"
		, "TEMP_TABLE_SET"."MCINTA" AS "MCINTA"
		, "TEMP_TABLE_SET"."MCINTL" AS "MCINTL"
		, "TEMP_TABLE_SET"."MCD1J" AS "MCD1J"
		, "TEMP_TABLE_SET"."MCD2J" AS "MCD2J"
		, "TEMP_TABLE_SET"."MCD3J" AS "MCD3J"
		, "TEMP_TABLE_SET"."MCD4J" AS "MCD4J"
		, "TEMP_TABLE_SET"."MCD5J" AS "MCD5J"
		, "TEMP_TABLE_SET"."MCD6J" AS "MCD6J"
		, "TEMP_TABLE_SET"."MCFPDJ" AS "MCFPDJ"
		, "TEMP_TABLE_SET"."MCCAC" AS "MCCAC"
		, "TEMP_TABLE_SET"."MCPAC" AS "MCPAC"
		, "TEMP_TABLE_SET"."MCEEO" AS "MCEEO"
		, "TEMP_TABLE_SET"."MCERC" AS "MCERC"
		, "TEMP_TABLE_SET"."MCUSER" AS "MCUSER"
		, "TEMP_TABLE_SET"."MCPID" AS "MCPID"
		, "TEMP_TABLE_SET"."MCUPMJ" AS "MCUPMJ"
		, "TEMP_TABLE_SET"."MCJOBN" AS "MCJOBN"
		, "TEMP_TABLE_SET"."MCUPMT" AS "MCUPMT"
		, "TEMP_TABLE_SET"."MCBPTP" AS "MCBPTP"
		, "TEMP_TABLE_SET"."MCAPSB" AS "MCAPSB"
		, "TEMP_TABLE_SET"."MCTSBU" AS "MCTSBU"
		, "TEMP_TABLE_SET"."MCRP31" AS "MCRP31"
		, "TEMP_TABLE_SET"."MCRP32" AS "MCRP32"
		, "TEMP_TABLE_SET"."MCRP33" AS "MCRP33"
		, "TEMP_TABLE_SET"."MCRP34" AS "MCRP34"
		, "TEMP_TABLE_SET"."MCRP35" AS "MCRP35"
		, "TEMP_TABLE_SET"."MCRP36" AS "MCRP36"
		, "TEMP_TABLE_SET"."MCRP37" AS "MCRP37"
		, "TEMP_TABLE_SET"."MCRP38" AS "MCRP38"
		, "TEMP_TABLE_SET"."MCRP39" AS "MCRP39"
		, "TEMP_TABLE_SET"."MCRP40" AS "MCRP40"
		, "TEMP_TABLE_SET"."MCRP41" AS "MCRP41"
		, "TEMP_TABLE_SET"."MCRP42" AS "MCRP42"
		, "TEMP_TABLE_SET"."MCRP43" AS "MCRP43"
		, "TEMP_TABLE_SET"."MCRP44" AS "MCRP44"
		, "TEMP_TABLE_SET"."MCRP45" AS "MCRP45"
		, "TEMP_TABLE_SET"."MCRP46" AS "MCRP46"
		, "TEMP_TABLE_SET"."MCRP47" AS "MCRP47"
		, "TEMP_TABLE_SET"."MCRP48" AS "MCRP48"
		, "TEMP_TABLE_SET"."MCRP49" AS "MCRP49"
		, "TEMP_TABLE_SET"."MCRP50" AS "MCRP50"
		, "TEMP_TABLE_SET"."MCAN8GCA1" AS "MCAN8GCA1"
		, "TEMP_TABLE_SET"."MCAN8GCA2" AS "MCAN8GCA2"
		, "TEMP_TABLE_SET"."MCAN8GCA3" AS "MCAN8GCA3"
		, "TEMP_TABLE_SET"."MCAN8GCA4" AS "MCAN8GCA4"
		, "TEMP_TABLE_SET"."MCAN8GCA5" AS "MCAN8GCA5"
		, "TEMP_TABLE_SET"."MCRMCU1" AS "MCRMCU1"
		, "TEMP_TABLE_SET"."MCDOCO" AS "MCDOCO"
		, "TEMP_TABLE_SET"."MCPCTN" AS "MCPCTN"
		, "TEMP_TABLE_SET"."MCCLNU" AS "MCCLNU"
		, "TEMP_TABLE_SET"."MCBUCA" AS "MCBUCA"
		, "TEMP_TABLE_SET"."MCADJENT" AS "MCADJENT"
		, "TEMP_TABLE_SET"."MCUAFL" AS "MCUAFL"
	FROM "TEMP_TABLE_SET" "TEMP_TABLE_SET"

) final 
where '{{ var("load_type") }}' = 'INCR' and '{{ var("source") }}' = 'JDEDWARDS'