{{
	config(
		materialized='incremental',
		pre_hook= [
			'{% if var("load_type") == "INCR" and var("source") == "JDEDWARDS" %} TRUNCATE TABLE {{ this }}; {% endif %}'
		],
		alias='SAT_JDE_WHOISWHO_TMP',
		schema='JDEDWARDS_STG',
		tags=['JDEDWARDS', 'SAT_JDE_WHOISWHO_INCR']
	)
}}
select * from (
	WITH "DIST_STG" AS 
	( 
		SELECT DISTINCT 
 			  "STG_DIS_SRC"."WHOISWHO_HKEY" AS "WHOISWHO_HKEY"
			, "STG_DIS_SRC"."LOAD_CYCLE_ID" AS "LOAD_CYCLE_ID"
		FROM {{ ref('JDEDWARDS_STG_F0111') }} "STG_DIS_SRC"
		WHERE  "STG_DIS_SRC"."RECORD_TYPE" = 'S'
	)
	, "TEMP_TABLE_SET" AS 
	( 
		SELECT 
			  "STG_TEMP_SRC"."WHOISWHO_HKEY" AS "WHOISWHO_HKEY"
			, "STG_TEMP_SRC"."LOAD_DATE" AS "LOAD_DATE"
			, "STG_TEMP_SRC"."LOAD_CYCLE_ID" AS "LOAD_CYCLE_ID"
			, TO_TIMESTAMP('31/12/2999 23:59:59', 'DD/MM/YYYY HH24:MI:SS') AS "LOAD_END_DATE"
			, "STG_TEMP_SRC"."RECORD_TYPE" AS "RECORD_TYPE"
			, 'STG' AS "SOURCE"
			, 1 AS "ORIGIN_ID"
			, UPPER(MD5_HEX(COALESCE(RTRIM( UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."WWDSS5")),'~'),'\#','\\' || 
				'\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."WWMLNM"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."WWATTL"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."WWREM1"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."WWSLNM"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."WWALPH"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."WWDC"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."WWGNNM"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."WWMDNM"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."WWSRNM"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."WWTYC"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."WWW001"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."WWW002"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."WWW003"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."WWW004"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."WWW005"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."WWW006"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."WWW007"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."WWW008"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."WWW009"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."WWW010"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."WWMLN1"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."WWALP1"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."WWUSER"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."WWPID"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."WWUPMJ")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."WWJOBN"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."WWUPMT")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."WWNTYP"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."WWNICK"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."WWGEND"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."WWDDATE")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."WWDMON")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."WWDYR")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."WWWN001"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."WWWN002"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."WWWN003"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."WWWN004"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."WWWN005"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."WWWN006"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."WWWN007"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."WWWN008"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."WWWN009"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."WWWN010"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."WWFUCO"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."WWPCM"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."WWPCF"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."WWACTIN"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."WWCFRGUID"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."WWSYNCS")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."WWCAAD")),'~'),'\#','\\' || '\#'))|| '\#','\#' || '~'),'~') )) AS "HASH_DIFF"
			, CASE WHEN "STG_TEMP_SRC"."JRN_FLAG" = 'D' THEN CAST('Y' AS VARCHAR) ELSE CAST('N' AS VARCHAR) END AS "DELETE_FLAG"
			, "STG_TEMP_SRC"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP"
			, "STG_TEMP_SRC"."WWAN8" AS "WWAN8"
			, "STG_TEMP_SRC"."WWIDLN" AS "WWIDLN"
			, "STG_TEMP_SRC"."WWDSS5" AS "WWDSS5"
			, "STG_TEMP_SRC"."WWMLNM" AS "WWMLNM"
			, "STG_TEMP_SRC"."WWATTL" AS "WWATTL"
			, "STG_TEMP_SRC"."WWREM1" AS "WWREM1"
			, "STG_TEMP_SRC"."WWSLNM" AS "WWSLNM"
			, "STG_TEMP_SRC"."WWALPH" AS "WWALPH"
			, "STG_TEMP_SRC"."WWDC" AS "WWDC"
			, "STG_TEMP_SRC"."WWGNNM" AS "WWGNNM"
			, "STG_TEMP_SRC"."WWMDNM" AS "WWMDNM"
			, "STG_TEMP_SRC"."WWSRNM" AS "WWSRNM"
			, "STG_TEMP_SRC"."WWTYC" AS "WWTYC"
			, "STG_TEMP_SRC"."WWW001" AS "WWW001"
			, "STG_TEMP_SRC"."WWW002" AS "WWW002"
			, "STG_TEMP_SRC"."WWW003" AS "WWW003"
			, "STG_TEMP_SRC"."WWW004" AS "WWW004"
			, "STG_TEMP_SRC"."WWW005" AS "WWW005"
			, "STG_TEMP_SRC"."WWW006" AS "WWW006"
			, "STG_TEMP_SRC"."WWW007" AS "WWW007"
			, "STG_TEMP_SRC"."WWW008" AS "WWW008"
			, "STG_TEMP_SRC"."WWW009" AS "WWW009"
			, "STG_TEMP_SRC"."WWW010" AS "WWW010"
			, "STG_TEMP_SRC"."WWMLN1" AS "WWMLN1"
			, "STG_TEMP_SRC"."WWALP1" AS "WWALP1"
			, "STG_TEMP_SRC"."WWUSER" AS "WWUSER"
			, "STG_TEMP_SRC"."WWPID" AS "WWPID"
			, "STG_TEMP_SRC"."WWUPMJ" AS "WWUPMJ"
			, "STG_TEMP_SRC"."WWJOBN" AS "WWJOBN"
			, "STG_TEMP_SRC"."WWUPMT" AS "WWUPMT"
			, "STG_TEMP_SRC"."WWNTYP" AS "WWNTYP"
			, "STG_TEMP_SRC"."WWNICK" AS "WWNICK"
			, "STG_TEMP_SRC"."WWGEND" AS "WWGEND"
			, "STG_TEMP_SRC"."WWDDATE" AS "WWDDATE"
			, "STG_TEMP_SRC"."WWDMON" AS "WWDMON"
			, "STG_TEMP_SRC"."WWDYR" AS "WWDYR"
			, "STG_TEMP_SRC"."WWWN001" AS "WWWN001"
			, "STG_TEMP_SRC"."WWWN002" AS "WWWN002"
			, "STG_TEMP_SRC"."WWWN003" AS "WWWN003"
			, "STG_TEMP_SRC"."WWWN004" AS "WWWN004"
			, "STG_TEMP_SRC"."WWWN005" AS "WWWN005"
			, "STG_TEMP_SRC"."WWWN006" AS "WWWN006"
			, "STG_TEMP_SRC"."WWWN007" AS "WWWN007"
			, "STG_TEMP_SRC"."WWWN008" AS "WWWN008"
			, "STG_TEMP_SRC"."WWWN009" AS "WWWN009"
			, "STG_TEMP_SRC"."WWWN010" AS "WWWN010"
			, "STG_TEMP_SRC"."WWFUCO" AS "WWFUCO"
			, "STG_TEMP_SRC"."WWPCM" AS "WWPCM"
			, "STG_TEMP_SRC"."WWPCF" AS "WWPCF"
			, "STG_TEMP_SRC"."WWACTIN" AS "WWACTIN"
			, "STG_TEMP_SRC"."WWCFRGUID" AS "WWCFRGUID"
			, "STG_TEMP_SRC"."WWSYNCS" AS "WWSYNCS"
			, "STG_TEMP_SRC"."WWCAAD" AS "WWCAAD"
		FROM {{ ref('JDEDWARDS_STG_F0111') }} "STG_TEMP_SRC"
		WHERE  "STG_TEMP_SRC"."RECORD_TYPE" = 'S'
		UNION ALL 
		SELECT 
			  "SAT_SRC"."WHOISWHO_HKEY" AS "WHOISWHO_HKEY"
			, "SAT_SRC"."LOAD_DATE" AS "LOAD_DATE"
			, "SAT_SRC"."LOAD_CYCLE_ID" AS "LOAD_CYCLE_ID"
			, "SAT_SRC"."LOAD_END_DATE" AS "LOAD_END_DATE"
			, 'SAT' AS "RECORD_TYPE"
			, 'SAT' AS "SOURCE"
			, 0 AS "ORIGIN_ID"
			, "SAT_SRC"."HASH_DIFF" AS "HASH_DIFF"
			, "SAT_SRC"."DELETE_FLAG" AS "DELETE_FLAG"
			, "SAT_SRC"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP"
			, "SAT_SRC"."WWAN8" AS "WWAN8"
			, "SAT_SRC"."WWIDLN" AS "WWIDLN"
			, "SAT_SRC"."WWDSS5" AS "WWDSS5"
			, "SAT_SRC"."WWMLNM" AS "WWMLNM"
			, "SAT_SRC"."WWATTL" AS "WWATTL"
			, "SAT_SRC"."WWREM1" AS "WWREM1"
			, "SAT_SRC"."WWSLNM" AS "WWSLNM"
			, "SAT_SRC"."WWALPH" AS "WWALPH"
			, "SAT_SRC"."WWDC" AS "WWDC"
			, "SAT_SRC"."WWGNNM" AS "WWGNNM"
			, "SAT_SRC"."WWMDNM" AS "WWMDNM"
			, "SAT_SRC"."WWSRNM" AS "WWSRNM"
			, "SAT_SRC"."WWTYC" AS "WWTYC"
			, "SAT_SRC"."WWW001" AS "WWW001"
			, "SAT_SRC"."WWW002" AS "WWW002"
			, "SAT_SRC"."WWW003" AS "WWW003"
			, "SAT_SRC"."WWW004" AS "WWW004"
			, "SAT_SRC"."WWW005" AS "WWW005"
			, "SAT_SRC"."WWW006" AS "WWW006"
			, "SAT_SRC"."WWW007" AS "WWW007"
			, "SAT_SRC"."WWW008" AS "WWW008"
			, "SAT_SRC"."WWW009" AS "WWW009"
			, "SAT_SRC"."WWW010" AS "WWW010"
			, "SAT_SRC"."WWMLN1" AS "WWMLN1"
			, "SAT_SRC"."WWALP1" AS "WWALP1"
			, "SAT_SRC"."WWUSER" AS "WWUSER"
			, "SAT_SRC"."WWPID" AS "WWPID"
			, "SAT_SRC"."WWUPMJ" AS "WWUPMJ"
			, "SAT_SRC"."WWJOBN" AS "WWJOBN"
			, "SAT_SRC"."WWUPMT" AS "WWUPMT"
			, "SAT_SRC"."WWNTYP" AS "WWNTYP"
			, "SAT_SRC"."WWNICK" AS "WWNICK"
			, "SAT_SRC"."WWGEND" AS "WWGEND"
			, "SAT_SRC"."WWDDATE" AS "WWDDATE"
			, "SAT_SRC"."WWDMON" AS "WWDMON"
			, "SAT_SRC"."WWDYR" AS "WWDYR"
			, "SAT_SRC"."WWWN001" AS "WWWN001"
			, "SAT_SRC"."WWWN002" AS "WWWN002"
			, "SAT_SRC"."WWWN003" AS "WWWN003"
			, "SAT_SRC"."WWWN004" AS "WWWN004"
			, "SAT_SRC"."WWWN005" AS "WWWN005"
			, "SAT_SRC"."WWWN006" AS "WWWN006"
			, "SAT_SRC"."WWWN007" AS "WWWN007"
			, "SAT_SRC"."WWWN008" AS "WWWN008"
			, "SAT_SRC"."WWWN009" AS "WWWN009"
			, "SAT_SRC"."WWWN010" AS "WWWN010"
			, "SAT_SRC"."WWFUCO" AS "WWFUCO"
			, "SAT_SRC"."WWPCM" AS "WWPCM"
			, "SAT_SRC"."WWPCF" AS "WWPCF"
			, "SAT_SRC"."WWACTIN" AS "WWACTIN"
			, "SAT_SRC"."WWCFRGUID" AS "WWCFRGUID"
			, "SAT_SRC"."WWSYNCS" AS "WWSYNCS"
			, "SAT_SRC"."WWCAAD" AS "WWCAAD"
		FROM {{ source('DEMO_FL', 'SAT_JDE_WHOISWHO') }} "SAT_SRC"
		INNER JOIN "DIST_STG" "DIST_STG" ON  "SAT_SRC"."WHOISWHO_HKEY" = "DIST_STG"."WHOISWHO_HKEY"
		WHERE  "SAT_SRC"."LOAD_END_DATE" = TO_TIMESTAMP('31/12/2999 23:59:59' , 'DD/MM/YYYY HH24:MI:SS')
	)
	SELECT 
		  "TEMP_TABLE_SET"."WHOISWHO_HKEY" AS "WHOISWHO_HKEY"
		, "TEMP_TABLE_SET"."LOAD_DATE" AS "LOAD_DATE"
		, "TEMP_TABLE_SET"."LOAD_END_DATE" AS "LOAD_END_DATE"
		, "TEMP_TABLE_SET"."LOAD_CYCLE_ID" AS "LOAD_CYCLE_ID"
		, "TEMP_TABLE_SET"."RECORD_TYPE" AS "RECORD_TYPE"
		, "TEMP_TABLE_SET"."SOURCE" AS "SOURCE"
		, CASE WHEN "TEMP_TABLE_SET"."SOURCE" = 'STG' AND TO_CHAR("TEMP_TABLE_SET"."DELETE_FLAG") || TO_CHAR("TEMP_TABLE_SET"."HASH_DIFF")
			= LAG( TO_CHAR("TEMP_TABLE_SET"."DELETE_FLAG") || TO_CHAR("TEMP_TABLE_SET"."HASH_DIFF"),1)OVER(PARTITION BY "TEMP_TABLE_SET"."WHOISWHO_HKEY" ORDER BY "TEMP_TABLE_SET"."LOAD_DATE","TEMP_TABLE_SET"."ORIGIN_ID")THEN 1 ELSE 0 END AS "EQUAL"
		, "TEMP_TABLE_SET"."HASH_DIFF" AS "HASH_DIFF"
		, "TEMP_TABLE_SET"."DELETE_FLAG" AS "DELETE_FLAG"
		, "TEMP_TABLE_SET"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP"
		, "TEMP_TABLE_SET"."WWAN8" AS "WWAN8"
		, "TEMP_TABLE_SET"."WWIDLN" AS "WWIDLN"
		, "TEMP_TABLE_SET"."WWDSS5" AS "WWDSS5"
		, "TEMP_TABLE_SET"."WWMLNM" AS "WWMLNM"
		, "TEMP_TABLE_SET"."WWATTL" AS "WWATTL"
		, "TEMP_TABLE_SET"."WWREM1" AS "WWREM1"
		, "TEMP_TABLE_SET"."WWSLNM" AS "WWSLNM"
		, "TEMP_TABLE_SET"."WWALPH" AS "WWALPH"
		, "TEMP_TABLE_SET"."WWDC" AS "WWDC"
		, "TEMP_TABLE_SET"."WWGNNM" AS "WWGNNM"
		, "TEMP_TABLE_SET"."WWMDNM" AS "WWMDNM"
		, "TEMP_TABLE_SET"."WWSRNM" AS "WWSRNM"
		, "TEMP_TABLE_SET"."WWTYC" AS "WWTYC"
		, "TEMP_TABLE_SET"."WWW001" AS "WWW001"
		, "TEMP_TABLE_SET"."WWW002" AS "WWW002"
		, "TEMP_TABLE_SET"."WWW003" AS "WWW003"
		, "TEMP_TABLE_SET"."WWW004" AS "WWW004"
		, "TEMP_TABLE_SET"."WWW005" AS "WWW005"
		, "TEMP_TABLE_SET"."WWW006" AS "WWW006"
		, "TEMP_TABLE_SET"."WWW007" AS "WWW007"
		, "TEMP_TABLE_SET"."WWW008" AS "WWW008"
		, "TEMP_TABLE_SET"."WWW009" AS "WWW009"
		, "TEMP_TABLE_SET"."WWW010" AS "WWW010"
		, "TEMP_TABLE_SET"."WWMLN1" AS "WWMLN1"
		, "TEMP_TABLE_SET"."WWALP1" AS "WWALP1"
		, "TEMP_TABLE_SET"."WWUSER" AS "WWUSER"
		, "TEMP_TABLE_SET"."WWPID" AS "WWPID"
		, "TEMP_TABLE_SET"."WWUPMJ" AS "WWUPMJ"
		, "TEMP_TABLE_SET"."WWJOBN" AS "WWJOBN"
		, "TEMP_TABLE_SET"."WWUPMT" AS "WWUPMT"
		, "TEMP_TABLE_SET"."WWNTYP" AS "WWNTYP"
		, "TEMP_TABLE_SET"."WWNICK" AS "WWNICK"
		, "TEMP_TABLE_SET"."WWGEND" AS "WWGEND"
		, "TEMP_TABLE_SET"."WWDDATE" AS "WWDDATE"
		, "TEMP_TABLE_SET"."WWDMON" AS "WWDMON"
		, "TEMP_TABLE_SET"."WWDYR" AS "WWDYR"
		, "TEMP_TABLE_SET"."WWWN001" AS "WWWN001"
		, "TEMP_TABLE_SET"."WWWN002" AS "WWWN002"
		, "TEMP_TABLE_SET"."WWWN003" AS "WWWN003"
		, "TEMP_TABLE_SET"."WWWN004" AS "WWWN004"
		, "TEMP_TABLE_SET"."WWWN005" AS "WWWN005"
		, "TEMP_TABLE_SET"."WWWN006" AS "WWWN006"
		, "TEMP_TABLE_SET"."WWWN007" AS "WWWN007"
		, "TEMP_TABLE_SET"."WWWN008" AS "WWWN008"
		, "TEMP_TABLE_SET"."WWWN009" AS "WWWN009"
		, "TEMP_TABLE_SET"."WWWN010" AS "WWWN010"
		, "TEMP_TABLE_SET"."WWFUCO" AS "WWFUCO"
		, "TEMP_TABLE_SET"."WWPCM" AS "WWPCM"
		, "TEMP_TABLE_SET"."WWPCF" AS "WWPCF"
		, "TEMP_TABLE_SET"."WWACTIN" AS "WWACTIN"
		, "TEMP_TABLE_SET"."WWCFRGUID" AS "WWCFRGUID"
		, "TEMP_TABLE_SET"."WWSYNCS" AS "WWSYNCS"
		, "TEMP_TABLE_SET"."WWCAAD" AS "WWCAAD"
	FROM "TEMP_TABLE_SET" "TEMP_TABLE_SET"

) final 
where '{{ var("load_type") }}' = 'INCR' and '{{ var("source") }}' = 'JDEDWARDS'