{{
	config(
		materialized='incremental',
		pre_hook= [
			'{% if var("load_type") == "INIT" and var("source") == "JDEDWARDS" %} TRUNCATE TABLE {{ this }}; {% endif %}'
		],
		alias='SAT_JDE_SALESORDERHEADERHISTORY',
		schema='DEMO_FL',
		unique_key = ['"SALESORDERHEADERHISTORY_HKEY"', '"LOAD_DATE"'],
		merge_update_columns = ['"LOAD_END_DATE"', '"DELETE_FLAG"', '"CDC_TIMESTAMP"'],
		tags=['JDEDWARDS', 'SAT_JDE_SOHEADERHIST_INCR', 'SAT_JDE_SOHEADERHIST_INIT']
	)
}}
select * from (
	WITH "END_DATING" AS 
	( 
		SELECT 
			  "SAT_TEMP_SRC_DK"."SALESORDERHEADERHISTORY_HKEY" AS "SALESORDERHEADERHISTORY_HKEY"
			, "SAT_TEMP_SRC_DK"."LOAD_DATE" AS "LOAD_DATE"
			, CASE WHEN LEAD( "SAT_TEMP_SRC_DK"."DELETE_FLAG" || "SAT_TEMP_SRC_DK"."SOURCE",1)OVER(PARTITION BY "SAT_TEMP_SRC_DK"."SALESORDERHEADERHISTORY_HKEY" ORDER BY "SAT_TEMP_SRC_DK"."LOAD_DATE",
				"SAT_TEMP_SRC_DK"."LOAD_CYCLE_ID")= 'Y' || 'STG' THEN CAST('Y' AS VARCHAR) ELSE "SAT_TEMP_SRC_DK"."DELETE_FLAG" END AS "DELETE_FLAG"
			, LEAD("SAT_TEMP_SRC_DK"."CDC_TIMESTAMP",1)OVER(PARTITION BY "SAT_TEMP_SRC_DK"."SALESORDERHEADERHISTORY_HKEY" ORDER BY "SAT_TEMP_SRC_DK"."LOAD_DATE") AS "CDC_TIMESTAMP"
		FROM {{ ref('JDEDWARDS_STG_SAT_JDE_SALESORDERHEADERHISTORY_TMP') }} "SAT_TEMP_SRC_DK"
		WHERE  "SAT_TEMP_SRC_DK"."EQUAL" = 0
	)
	, "CALC_LOAD_END_DATE" AS 
	( 
		SELECT 
			  "SAT_TEMP_SRC_US"."SALESORDERHEADERHISTORY_HKEY" AS "SALESORDERHEADERHISTORY_HKEY"
			, "SAT_TEMP_SRC_US"."LOAD_DATE" AS "LOAD_DATE"
			, "SAT_TEMP_SRC_US"."LOAD_CYCLE_ID" AS "LOAD_CYCLE_ID"
			, COALESCE(LEAD("SAT_TEMP_SRC_US"."LOAD_DATE",1)OVER(PARTITION BY "SAT_TEMP_SRC_US"."SALESORDERHEADERHISTORY_HKEY" ORDER BY "SAT_TEMP_SRC_US"."LOAD_DATE")
				, TO_TIMESTAMP('31/12/2999 23:59:59', 'DD/MM/YYYY HH24:MI:SS')) AS "LOAD_END_DATE"
			, "END_DATING"."DELETE_FLAG" AS "DELETE_FLAG"
			, "SAT_TEMP_SRC_US"."SOURCE" AS "SOURCE"
			, "SAT_TEMP_SRC_US"."HASH_DIFF" AS "HASH_DIFF"
			, CASE WHEN "END_DATING"."DELETE_FLAG" = CAST('Y' AS VARCHAR) THEN "END_DATING"."CDC_TIMESTAMP" ELSE "SAT_TEMP_SRC_US"."CDC_TIMESTAMP" END AS "CDC_TIMESTAMP"
			, "SAT_TEMP_SRC_US"."SHKCOO" AS "SHKCOO"
			, "SAT_TEMP_SRC_US"."SHDOCO" AS "SHDOCO"
			, "SAT_TEMP_SRC_US"."SHDCTO" AS "SHDCTO"
			, "SAT_TEMP_SRC_US"."SHMCU" AS "SHMCU"
			, "SAT_TEMP_SRC_US"."SHAN8" AS "SHAN8"
			, "SAT_TEMP_SRC_US"."SHSFXO" AS "SHSFXO"
			, "SAT_TEMP_SRC_US"."SHCO" AS "SHCO"
			, "SAT_TEMP_SRC_US"."SHOKCO" AS "SHOKCO"
			, "SAT_TEMP_SRC_US"."SHOORN" AS "SHOORN"
			, "SAT_TEMP_SRC_US"."SHOCTO" AS "SHOCTO"
			, "SAT_TEMP_SRC_US"."SHRKCO" AS "SHRKCO"
			, "SAT_TEMP_SRC_US"."SHRORN" AS "SHRORN"
			, "SAT_TEMP_SRC_US"."SHRCTO" AS "SHRCTO"
			, "SAT_TEMP_SRC_US"."SHSHAN" AS "SHSHAN"
			, "SAT_TEMP_SRC_US"."SHPA8" AS "SHPA8"
			, "SAT_TEMP_SRC_US"."SHDRQJ" AS "SHDRQJ"
			, "SAT_TEMP_SRC_US"."SHTRDJ" AS "SHTRDJ"
			, "SAT_TEMP_SRC_US"."SHPDDJ" AS "SHPDDJ"
			, "SAT_TEMP_SRC_US"."SHOPDJ" AS "SHOPDJ"
			, "SAT_TEMP_SRC_US"."SHADDJ" AS "SHADDJ"
			, "SAT_TEMP_SRC_US"."SHCNDJ" AS "SHCNDJ"
			, "SAT_TEMP_SRC_US"."SHPEFJ" AS "SHPEFJ"
			, "SAT_TEMP_SRC_US"."SHPPDJ" AS "SHPPDJ"
			, "SAT_TEMP_SRC_US"."SHVR01" AS "SHVR01"
			, "SAT_TEMP_SRC_US"."SHVR02" AS "SHVR02"
			, "SAT_TEMP_SRC_US"."SHDEL1" AS "SHDEL1"
			, "SAT_TEMP_SRC_US"."SHDEL2" AS "SHDEL2"
			, "SAT_TEMP_SRC_US"."SHINMG" AS "SHINMG"
			, "SAT_TEMP_SRC_US"."SHPTC" AS "SHPTC"
			, "SAT_TEMP_SRC_US"."SHRYIN" AS "SHRYIN"
			, "SAT_TEMP_SRC_US"."SHASN" AS "SHASN"
			, "SAT_TEMP_SRC_US"."SHPRGP" AS "SHPRGP"
			, "SAT_TEMP_SRC_US"."SHTRDC" AS "SHTRDC"
			, "SAT_TEMP_SRC_US"."SHPCRT" AS "SHPCRT"
			, "SAT_TEMP_SRC_US"."SHTXA1" AS "SHTXA1"
			, "SAT_TEMP_SRC_US"."SHEXR1" AS "SHEXR1"
			, "SAT_TEMP_SRC_US"."SHTXCT" AS "SHTXCT"
			, "SAT_TEMP_SRC_US"."SHATXT" AS "SHATXT"
			, "SAT_TEMP_SRC_US"."SHPRIO" AS "SHPRIO"
			, "SAT_TEMP_SRC_US"."SHBACK" AS "SHBACK"
			, "SAT_TEMP_SRC_US"."SHSBAL" AS "SHSBAL"
			, "SAT_TEMP_SRC_US"."SHHOLD" AS "SHHOLD"
			, "SAT_TEMP_SRC_US"."SHPLST" AS "SHPLST"
			, "SAT_TEMP_SRC_US"."SHINVC" AS "SHINVC"
			, "SAT_TEMP_SRC_US"."SHNTR" AS "SHNTR"
			, "SAT_TEMP_SRC_US"."SHANBY" AS "SHANBY"
			, "SAT_TEMP_SRC_US"."SHCARS" AS "SHCARS"
			, "SAT_TEMP_SRC_US"."SHMOT" AS "SHMOT"
			, "SAT_TEMP_SRC_US"."SHCOT" AS "SHCOT"
			, "SAT_TEMP_SRC_US"."SHROUT" AS "SHROUT"
			, "SAT_TEMP_SRC_US"."SHSTOP" AS "SHSTOP"
			, "SAT_TEMP_SRC_US"."SHZON" AS "SHZON"
			, "SAT_TEMP_SRC_US"."SHCNID" AS "SHCNID"
			, "SAT_TEMP_SRC_US"."SHFRTH" AS "SHFRTH"
			, "SAT_TEMP_SRC_US"."SHAFT" AS "SHAFT"
			, "SAT_TEMP_SRC_US"."SHFUF1" AS "SHFUF1"
			, "SAT_TEMP_SRC_US"."SHFRTC" AS "SHFRTC"
			, "SAT_TEMP_SRC_US"."SHMORD" AS "SHMORD"
			, "SAT_TEMP_SRC_US"."SHRCD" AS "SHRCD"
			, "SAT_TEMP_SRC_US"."SHFUF2" AS "SHFUF2"
			, "SAT_TEMP_SRC_US"."SHOTOT" AS "SHOTOT"
			, "SAT_TEMP_SRC_US"."SHTOTC" AS "SHTOTC"
			, "SAT_TEMP_SRC_US"."SHWUMD" AS "SHWUMD"
			, "SAT_TEMP_SRC_US"."SHVUMD" AS "SHVUMD"
			, "SAT_TEMP_SRC_US"."SHAUTN" AS "SHAUTN"
			, "SAT_TEMP_SRC_US"."SHCACT" AS "SHCACT"
			, "SAT_TEMP_SRC_US"."SHCEXP" AS "SHCEXP"
			, "SAT_TEMP_SRC_US"."SHSBLI" AS "SHSBLI"
			, "SAT_TEMP_SRC_US"."SHCRMD" AS "SHCRMD"
			, "SAT_TEMP_SRC_US"."SHCRRM" AS "SHCRRM"
			, "SAT_TEMP_SRC_US"."SHCRCD" AS "SHCRCD"
			, "SAT_TEMP_SRC_US"."SHCRR" AS "SHCRR"
			, "SAT_TEMP_SRC_US"."SHLNGP" AS "SHLNGP"
			, "SAT_TEMP_SRC_US"."SHFAP" AS "SHFAP"
			, "SAT_TEMP_SRC_US"."SHFCST" AS "SHFCST"
			, "SAT_TEMP_SRC_US"."SHORBY" AS "SHORBY"
			, "SAT_TEMP_SRC_US"."SHTKBY" AS "SHTKBY"
			, "SAT_TEMP_SRC_US"."SHURCD" AS "SHURCD"
			, "SAT_TEMP_SRC_US"."SHURDT" AS "SHURDT"
			, "SAT_TEMP_SRC_US"."SHURAT" AS "SHURAT"
			, "SAT_TEMP_SRC_US"."SHURAB" AS "SHURAB"
			, "SAT_TEMP_SRC_US"."SHURRF" AS "SHURRF"
			, "SAT_TEMP_SRC_US"."SHUSER" AS "SHUSER"
			, "SAT_TEMP_SRC_US"."SHPID" AS "SHPID"
			, "SAT_TEMP_SRC_US"."SHJOBN" AS "SHJOBN"
			, "SAT_TEMP_SRC_US"."SHUPMJ" AS "SHUPMJ"
			, "SAT_TEMP_SRC_US"."SHTDAY" AS "SHTDAY"
			, "SAT_TEMP_SRC_US"."SHIR01" AS "SHIR01"
			, "SAT_TEMP_SRC_US"."SHIR02" AS "SHIR02"
			, "SAT_TEMP_SRC_US"."SHIR03" AS "SHIR03"
			, "SAT_TEMP_SRC_US"."SHIR04" AS "SHIR04"
			, "SAT_TEMP_SRC_US"."SHIR05" AS "SHIR05"
			, "SAT_TEMP_SRC_US"."SHVR03" AS "SHVR03"
			, "SAT_TEMP_SRC_US"."SHSOOR" AS "SHSOOR"
			, "SAT_TEMP_SRC_US"."SHPMDT" AS "SHPMDT"
			, "SAT_TEMP_SRC_US"."SHRSDT" AS "SHRSDT"
			, "SAT_TEMP_SRC_US"."SHRQSJ" AS "SHRQSJ"
			, "SAT_TEMP_SRC_US"."SHPSTM" AS "SHPSTM"
			, "SAT_TEMP_SRC_US"."SHPDTT" AS "SHPDTT"
			, "SAT_TEMP_SRC_US"."SHOPTT" AS "SHOPTT"
			, "SAT_TEMP_SRC_US"."SHDRQT" AS "SHDRQT"
			, "SAT_TEMP_SRC_US"."SHADTM" AS "SHADTM"
			, "SAT_TEMP_SRC_US"."SHADLJ" AS "SHADLJ"
			, "SAT_TEMP_SRC_US"."SHPBAN" AS "SHPBAN"
			, "SAT_TEMP_SRC_US"."SHITAN" AS "SHITAN"
			, "SAT_TEMP_SRC_US"."SHFTAN" AS "SHFTAN"
			, "SAT_TEMP_SRC_US"."SHDVAN" AS "SHDVAN"
			, "SAT_TEMP_SRC_US"."SHDOC1" AS "SHDOC1"
			, "SAT_TEMP_SRC_US"."SHDCT4" AS "SHDCT4"
			, "SAT_TEMP_SRC_US"."SHCORD" AS "SHCORD"
			, "SAT_TEMP_SRC_US"."SHBSC" AS "SHBSC"
			, "SAT_TEMP_SRC_US"."SHBCRC" AS "SHBCRC"
			, "SAT_TEMP_SRC_US"."SHAUFT" AS "SHAUFT"
			, "SAT_TEMP_SRC_US"."SHAUFI" AS "SHAUFI"
			, "SAT_TEMP_SRC_US"."SHOPBO" AS "SHOPBO"
			, "SAT_TEMP_SRC_US"."SHOPTC" AS "SHOPTC"
			, "SAT_TEMP_SRC_US"."SHOPLD" AS "SHOPLD"
			, "SAT_TEMP_SRC_US"."SHOPBK" AS "SHOPBK"
			, "SAT_TEMP_SRC_US"."SHOPSB" AS "SHOPSB"
			, "SAT_TEMP_SRC_US"."SHOPPS" AS "SHOPPS"
			, "SAT_TEMP_SRC_US"."SHOPPL" AS "SHOPPL"
			, "SAT_TEMP_SRC_US"."SHOPMS" AS "SHOPMS"
			, "SAT_TEMP_SRC_US"."SHOPSS" AS "SHOPSS"
			, "SAT_TEMP_SRC_US"."SHOPBA" AS "SHOPBA"
			, "SAT_TEMP_SRC_US"."SHOPLL" AS "SHOPLL"
			, "SAT_TEMP_SRC_US"."SHPRAN8" AS "SHPRAN8"
			, "SAT_TEMP_SRC_US"."SHOPPID" AS "SHOPPID"
			, "SAT_TEMP_SRC_US"."SHSDATTN" AS "SHSDATTN"
			, "SAT_TEMP_SRC_US"."SHSPATTN" AS "SHSPATTN"
			, "SAT_TEMP_SRC_US"."SHOTIND" AS "SHOTIND"
			, "SAT_TEMP_SRC_US"."SHPRCIDLN" AS "SHPRCIDLN"
			, "SAT_TEMP_SRC_US"."SHCCIDLN" AS "SHCCIDLN"
			, "SAT_TEMP_SRC_US"."SHSHCCIDLN" AS "SHSHCCIDLN"
		FROM {{ ref('JDEDWARDS_STG_SAT_JDE_SALESORDERHEADERHISTORY_TMP') }} "SAT_TEMP_SRC_US"
		INNER JOIN "END_DATING" "END_DATING" ON  "SAT_TEMP_SRC_US"."SALESORDERHEADERHISTORY_HKEY" = "END_DATING"."SALESORDERHEADERHISTORY_HKEY" AND 
			"SAT_TEMP_SRC_US"."LOAD_DATE" = "END_DATING"."LOAD_DATE"
		WHERE  "SAT_TEMP_SRC_US"."EQUAL" = 0 AND NOT("SAT_TEMP_SRC_US"."DELETE_FLAG" = CAST('Y' AS VARCHAR) AND "SAT_TEMP_SRC_US"."SOURCE" = 'STG')
	)
	, "FILTER_LOAD_END_DATE" AS 
	( 
		SELECT 
			  "CALC_LOAD_END_DATE"."SALESORDERHEADERHISTORY_HKEY" AS "SALESORDERHEADERHISTORY_HKEY"
			, "CALC_LOAD_END_DATE"."LOAD_DATE" AS "LOAD_DATE"
			, "CALC_LOAD_END_DATE"."LOAD_CYCLE_ID" AS "LOAD_CYCLE_ID"
			, "CALC_LOAD_END_DATE"."LOAD_END_DATE" AS "LOAD_END_DATE"
			, "CALC_LOAD_END_DATE"."DELETE_FLAG" AS "DELETE_FLAG"
			, "CALC_LOAD_END_DATE"."HASH_DIFF" AS "HASH_DIFF"
			, "CALC_LOAD_END_DATE"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP"
			, "CALC_LOAD_END_DATE"."SHKCOO" AS "SHKCOO"
			, "CALC_LOAD_END_DATE"."SHDOCO" AS "SHDOCO"
			, "CALC_LOAD_END_DATE"."SHDCTO" AS "SHDCTO"
			, "CALC_LOAD_END_DATE"."SHMCU" AS "SHMCU"
			, "CALC_LOAD_END_DATE"."SHAN8" AS "SHAN8"
			, "CALC_LOAD_END_DATE"."SHSFXO" AS "SHSFXO"
			, "CALC_LOAD_END_DATE"."SHCO" AS "SHCO"
			, "CALC_LOAD_END_DATE"."SHOKCO" AS "SHOKCO"
			, "CALC_LOAD_END_DATE"."SHOORN" AS "SHOORN"
			, "CALC_LOAD_END_DATE"."SHOCTO" AS "SHOCTO"
			, "CALC_LOAD_END_DATE"."SHRKCO" AS "SHRKCO"
			, "CALC_LOAD_END_DATE"."SHRORN" AS "SHRORN"
			, "CALC_LOAD_END_DATE"."SHRCTO" AS "SHRCTO"
			, "CALC_LOAD_END_DATE"."SHSHAN" AS "SHSHAN"
			, "CALC_LOAD_END_DATE"."SHPA8" AS "SHPA8"
			, "CALC_LOAD_END_DATE"."SHDRQJ" AS "SHDRQJ"
			, "CALC_LOAD_END_DATE"."SHTRDJ" AS "SHTRDJ"
			, "CALC_LOAD_END_DATE"."SHPDDJ" AS "SHPDDJ"
			, "CALC_LOAD_END_DATE"."SHOPDJ" AS "SHOPDJ"
			, "CALC_LOAD_END_DATE"."SHADDJ" AS "SHADDJ"
			, "CALC_LOAD_END_DATE"."SHCNDJ" AS "SHCNDJ"
			, "CALC_LOAD_END_DATE"."SHPEFJ" AS "SHPEFJ"
			, "CALC_LOAD_END_DATE"."SHPPDJ" AS "SHPPDJ"
			, "CALC_LOAD_END_DATE"."SHVR01" AS "SHVR01"
			, "CALC_LOAD_END_DATE"."SHVR02" AS "SHVR02"
			, "CALC_LOAD_END_DATE"."SHDEL1" AS "SHDEL1"
			, "CALC_LOAD_END_DATE"."SHDEL2" AS "SHDEL2"
			, "CALC_LOAD_END_DATE"."SHINMG" AS "SHINMG"
			, "CALC_LOAD_END_DATE"."SHPTC" AS "SHPTC"
			, "CALC_LOAD_END_DATE"."SHRYIN" AS "SHRYIN"
			, "CALC_LOAD_END_DATE"."SHASN" AS "SHASN"
			, "CALC_LOAD_END_DATE"."SHPRGP" AS "SHPRGP"
			, "CALC_LOAD_END_DATE"."SHTRDC" AS "SHTRDC"
			, "CALC_LOAD_END_DATE"."SHPCRT" AS "SHPCRT"
			, "CALC_LOAD_END_DATE"."SHTXA1" AS "SHTXA1"
			, "CALC_LOAD_END_DATE"."SHEXR1" AS "SHEXR1"
			, "CALC_LOAD_END_DATE"."SHTXCT" AS "SHTXCT"
			, "CALC_LOAD_END_DATE"."SHATXT" AS "SHATXT"
			, "CALC_LOAD_END_DATE"."SHPRIO" AS "SHPRIO"
			, "CALC_LOAD_END_DATE"."SHBACK" AS "SHBACK"
			, "CALC_LOAD_END_DATE"."SHSBAL" AS "SHSBAL"
			, "CALC_LOAD_END_DATE"."SHHOLD" AS "SHHOLD"
			, "CALC_LOAD_END_DATE"."SHPLST" AS "SHPLST"
			, "CALC_LOAD_END_DATE"."SHINVC" AS "SHINVC"
			, "CALC_LOAD_END_DATE"."SHNTR" AS "SHNTR"
			, "CALC_LOAD_END_DATE"."SHANBY" AS "SHANBY"
			, "CALC_LOAD_END_DATE"."SHCARS" AS "SHCARS"
			, "CALC_LOAD_END_DATE"."SHMOT" AS "SHMOT"
			, "CALC_LOAD_END_DATE"."SHCOT" AS "SHCOT"
			, "CALC_LOAD_END_DATE"."SHROUT" AS "SHROUT"
			, "CALC_LOAD_END_DATE"."SHSTOP" AS "SHSTOP"
			, "CALC_LOAD_END_DATE"."SHZON" AS "SHZON"
			, "CALC_LOAD_END_DATE"."SHCNID" AS "SHCNID"
			, "CALC_LOAD_END_DATE"."SHFRTH" AS "SHFRTH"
			, "CALC_LOAD_END_DATE"."SHAFT" AS "SHAFT"
			, "CALC_LOAD_END_DATE"."SHFUF1" AS "SHFUF1"
			, "CALC_LOAD_END_DATE"."SHFRTC" AS "SHFRTC"
			, "CALC_LOAD_END_DATE"."SHMORD" AS "SHMORD"
			, "CALC_LOAD_END_DATE"."SHRCD" AS "SHRCD"
			, "CALC_LOAD_END_DATE"."SHFUF2" AS "SHFUF2"
			, "CALC_LOAD_END_DATE"."SHOTOT" AS "SHOTOT"
			, "CALC_LOAD_END_DATE"."SHTOTC" AS "SHTOTC"
			, "CALC_LOAD_END_DATE"."SHWUMD" AS "SHWUMD"
			, "CALC_LOAD_END_DATE"."SHVUMD" AS "SHVUMD"
			, "CALC_LOAD_END_DATE"."SHAUTN" AS "SHAUTN"
			, "CALC_LOAD_END_DATE"."SHCACT" AS "SHCACT"
			, "CALC_LOAD_END_DATE"."SHCEXP" AS "SHCEXP"
			, "CALC_LOAD_END_DATE"."SHSBLI" AS "SHSBLI"
			, "CALC_LOAD_END_DATE"."SHCRMD" AS "SHCRMD"
			, "CALC_LOAD_END_DATE"."SHCRRM" AS "SHCRRM"
			, "CALC_LOAD_END_DATE"."SHCRCD" AS "SHCRCD"
			, "CALC_LOAD_END_DATE"."SHCRR" AS "SHCRR"
			, "CALC_LOAD_END_DATE"."SHLNGP" AS "SHLNGP"
			, "CALC_LOAD_END_DATE"."SHFAP" AS "SHFAP"
			, "CALC_LOAD_END_DATE"."SHFCST" AS "SHFCST"
			, "CALC_LOAD_END_DATE"."SHORBY" AS "SHORBY"
			, "CALC_LOAD_END_DATE"."SHTKBY" AS "SHTKBY"
			, "CALC_LOAD_END_DATE"."SHURCD" AS "SHURCD"
			, "CALC_LOAD_END_DATE"."SHURDT" AS "SHURDT"
			, "CALC_LOAD_END_DATE"."SHURAT" AS "SHURAT"
			, "CALC_LOAD_END_DATE"."SHURAB" AS "SHURAB"
			, "CALC_LOAD_END_DATE"."SHURRF" AS "SHURRF"
			, "CALC_LOAD_END_DATE"."SHUSER" AS "SHUSER"
			, "CALC_LOAD_END_DATE"."SHPID" AS "SHPID"
			, "CALC_LOAD_END_DATE"."SHJOBN" AS "SHJOBN"
			, "CALC_LOAD_END_DATE"."SHUPMJ" AS "SHUPMJ"
			, "CALC_LOAD_END_DATE"."SHTDAY" AS "SHTDAY"
			, "CALC_LOAD_END_DATE"."SHIR01" AS "SHIR01"
			, "CALC_LOAD_END_DATE"."SHIR02" AS "SHIR02"
			, "CALC_LOAD_END_DATE"."SHIR03" AS "SHIR03"
			, "CALC_LOAD_END_DATE"."SHIR04" AS "SHIR04"
			, "CALC_LOAD_END_DATE"."SHIR05" AS "SHIR05"
			, "CALC_LOAD_END_DATE"."SHVR03" AS "SHVR03"
			, "CALC_LOAD_END_DATE"."SHSOOR" AS "SHSOOR"
			, "CALC_LOAD_END_DATE"."SHPMDT" AS "SHPMDT"
			, "CALC_LOAD_END_DATE"."SHRSDT" AS "SHRSDT"
			, "CALC_LOAD_END_DATE"."SHRQSJ" AS "SHRQSJ"
			, "CALC_LOAD_END_DATE"."SHPSTM" AS "SHPSTM"
			, "CALC_LOAD_END_DATE"."SHPDTT" AS "SHPDTT"
			, "CALC_LOAD_END_DATE"."SHOPTT" AS "SHOPTT"
			, "CALC_LOAD_END_DATE"."SHDRQT" AS "SHDRQT"
			, "CALC_LOAD_END_DATE"."SHADTM" AS "SHADTM"
			, "CALC_LOAD_END_DATE"."SHADLJ" AS "SHADLJ"
			, "CALC_LOAD_END_DATE"."SHPBAN" AS "SHPBAN"
			, "CALC_LOAD_END_DATE"."SHITAN" AS "SHITAN"
			, "CALC_LOAD_END_DATE"."SHFTAN" AS "SHFTAN"
			, "CALC_LOAD_END_DATE"."SHDVAN" AS "SHDVAN"
			, "CALC_LOAD_END_DATE"."SHDOC1" AS "SHDOC1"
			, "CALC_LOAD_END_DATE"."SHDCT4" AS "SHDCT4"
			, "CALC_LOAD_END_DATE"."SHCORD" AS "SHCORD"
			, "CALC_LOAD_END_DATE"."SHBSC" AS "SHBSC"
			, "CALC_LOAD_END_DATE"."SHBCRC" AS "SHBCRC"
			, "CALC_LOAD_END_DATE"."SHAUFT" AS "SHAUFT"
			, "CALC_LOAD_END_DATE"."SHAUFI" AS "SHAUFI"
			, "CALC_LOAD_END_DATE"."SHOPBO" AS "SHOPBO"
			, "CALC_LOAD_END_DATE"."SHOPTC" AS "SHOPTC"
			, "CALC_LOAD_END_DATE"."SHOPLD" AS "SHOPLD"
			, "CALC_LOAD_END_DATE"."SHOPBK" AS "SHOPBK"
			, "CALC_LOAD_END_DATE"."SHOPSB" AS "SHOPSB"
			, "CALC_LOAD_END_DATE"."SHOPPS" AS "SHOPPS"
			, "CALC_LOAD_END_DATE"."SHOPPL" AS "SHOPPL"
			, "CALC_LOAD_END_DATE"."SHOPMS" AS "SHOPMS"
			, "CALC_LOAD_END_DATE"."SHOPSS" AS "SHOPSS"
			, "CALC_LOAD_END_DATE"."SHOPBA" AS "SHOPBA"
			, "CALC_LOAD_END_DATE"."SHOPLL" AS "SHOPLL"
			, "CALC_LOAD_END_DATE"."SHPRAN8" AS "SHPRAN8"
			, "CALC_LOAD_END_DATE"."SHOPPID" AS "SHOPPID"
			, "CALC_LOAD_END_DATE"."SHSDATTN" AS "SHSDATTN"
			, "CALC_LOAD_END_DATE"."SHSPATTN" AS "SHSPATTN"
			, "CALC_LOAD_END_DATE"."SHOTIND" AS "SHOTIND"
			, "CALC_LOAD_END_DATE"."SHPRCIDLN" AS "SHPRCIDLN"
			, "CALC_LOAD_END_DATE"."SHCCIDLN" AS "SHCCIDLN"
			, "CALC_LOAD_END_DATE"."SHSHCCIDLN" AS "SHSHCCIDLN"
		FROM "CALC_LOAD_END_DATE" "CALC_LOAD_END_DATE"
		WHERE  "CALC_LOAD_END_DATE"."DELETE_FLAG" = CAST('Y' AS VARCHAR) OR "CALC_LOAD_END_DATE"."SOURCE" = 'STG' OR("CALC_LOAD_END_DATE"."SOURCE" = 'SAT' AND "CALC_LOAD_END_DATE"."LOAD_END_DATE" != TO_TIMESTAMP('31/12/2999 23:59:59', 'DD/MM/YYYY HH24:MI:SS'))
	)
	SELECT 
		  "FILTER_LOAD_END_DATE"."SALESORDERHEADERHISTORY_HKEY"
		, "FILTER_LOAD_END_DATE"."LOAD_DATE"
		, "FILTER_LOAD_END_DATE"."LOAD_END_DATE"
		, "FILTER_LOAD_END_DATE"."LOAD_CYCLE_ID"
		, "FILTER_LOAD_END_DATE"."HASH_DIFF"
		, "FILTER_LOAD_END_DATE"."DELETE_FLAG"
		, "FILTER_LOAD_END_DATE"."CDC_TIMESTAMP"
		, "FILTER_LOAD_END_DATE"."SHKCOO"
		, "FILTER_LOAD_END_DATE"."SHDOCO"
		, "FILTER_LOAD_END_DATE"."SHDCTO"
		, "FILTER_LOAD_END_DATE"."SHMCU"
		, "FILTER_LOAD_END_DATE"."SHAN8"
		, "FILTER_LOAD_END_DATE"."SHSFXO"
		, "FILTER_LOAD_END_DATE"."SHCO"
		, "FILTER_LOAD_END_DATE"."SHOKCO"
		, "FILTER_LOAD_END_DATE"."SHOORN"
		, "FILTER_LOAD_END_DATE"."SHOCTO"
		, "FILTER_LOAD_END_DATE"."SHRKCO"
		, "FILTER_LOAD_END_DATE"."SHRORN"
		, "FILTER_LOAD_END_DATE"."SHRCTO"
		, "FILTER_LOAD_END_DATE"."SHSHAN"
		, "FILTER_LOAD_END_DATE"."SHPA8"
		, "FILTER_LOAD_END_DATE"."SHDRQJ"
		, "FILTER_LOAD_END_DATE"."SHTRDJ"
		, "FILTER_LOAD_END_DATE"."SHPDDJ"
		, "FILTER_LOAD_END_DATE"."SHOPDJ"
		, "FILTER_LOAD_END_DATE"."SHADDJ"
		, "FILTER_LOAD_END_DATE"."SHCNDJ"
		, "FILTER_LOAD_END_DATE"."SHPEFJ"
		, "FILTER_LOAD_END_DATE"."SHPPDJ"
		, "FILTER_LOAD_END_DATE"."SHVR01"
		, "FILTER_LOAD_END_DATE"."SHVR02"
		, "FILTER_LOAD_END_DATE"."SHDEL1"
		, "FILTER_LOAD_END_DATE"."SHDEL2"
		, "FILTER_LOAD_END_DATE"."SHINMG"
		, "FILTER_LOAD_END_DATE"."SHPTC"
		, "FILTER_LOAD_END_DATE"."SHRYIN"
		, "FILTER_LOAD_END_DATE"."SHASN"
		, "FILTER_LOAD_END_DATE"."SHPRGP"
		, "FILTER_LOAD_END_DATE"."SHTRDC"
		, "FILTER_LOAD_END_DATE"."SHPCRT"
		, "FILTER_LOAD_END_DATE"."SHTXA1"
		, "FILTER_LOAD_END_DATE"."SHEXR1"
		, "FILTER_LOAD_END_DATE"."SHTXCT"
		, "FILTER_LOAD_END_DATE"."SHATXT"
		, "FILTER_LOAD_END_DATE"."SHPRIO"
		, "FILTER_LOAD_END_DATE"."SHBACK"
		, "FILTER_LOAD_END_DATE"."SHSBAL"
		, "FILTER_LOAD_END_DATE"."SHHOLD"
		, "FILTER_LOAD_END_DATE"."SHPLST"
		, "FILTER_LOAD_END_DATE"."SHINVC"
		, "FILTER_LOAD_END_DATE"."SHNTR"
		, "FILTER_LOAD_END_DATE"."SHANBY"
		, "FILTER_LOAD_END_DATE"."SHCARS"
		, "FILTER_LOAD_END_DATE"."SHMOT"
		, "FILTER_LOAD_END_DATE"."SHCOT"
		, "FILTER_LOAD_END_DATE"."SHROUT"
		, "FILTER_LOAD_END_DATE"."SHSTOP"
		, "FILTER_LOAD_END_DATE"."SHZON"
		, "FILTER_LOAD_END_DATE"."SHCNID"
		, "FILTER_LOAD_END_DATE"."SHFRTH"
		, "FILTER_LOAD_END_DATE"."SHAFT"
		, "FILTER_LOAD_END_DATE"."SHFUF1"
		, "FILTER_LOAD_END_DATE"."SHFRTC"
		, "FILTER_LOAD_END_DATE"."SHMORD"
		, "FILTER_LOAD_END_DATE"."SHRCD"
		, "FILTER_LOAD_END_DATE"."SHFUF2"
		, "FILTER_LOAD_END_DATE"."SHOTOT"
		, "FILTER_LOAD_END_DATE"."SHTOTC"
		, "FILTER_LOAD_END_DATE"."SHWUMD"
		, "FILTER_LOAD_END_DATE"."SHVUMD"
		, "FILTER_LOAD_END_DATE"."SHAUTN"
		, "FILTER_LOAD_END_DATE"."SHCACT"
		, "FILTER_LOAD_END_DATE"."SHCEXP"
		, "FILTER_LOAD_END_DATE"."SHSBLI"
		, "FILTER_LOAD_END_DATE"."SHCRMD"
		, "FILTER_LOAD_END_DATE"."SHCRRM"
		, "FILTER_LOAD_END_DATE"."SHCRCD"
		, "FILTER_LOAD_END_DATE"."SHCRR"
		, "FILTER_LOAD_END_DATE"."SHLNGP"
		, "FILTER_LOAD_END_DATE"."SHFAP"
		, "FILTER_LOAD_END_DATE"."SHFCST"
		, "FILTER_LOAD_END_DATE"."SHORBY"
		, "FILTER_LOAD_END_DATE"."SHTKBY"
		, "FILTER_LOAD_END_DATE"."SHURCD"
		, "FILTER_LOAD_END_DATE"."SHURDT"
		, "FILTER_LOAD_END_DATE"."SHURAT"
		, "FILTER_LOAD_END_DATE"."SHURAB"
		, "FILTER_LOAD_END_DATE"."SHURRF"
		, "FILTER_LOAD_END_DATE"."SHUSER"
		, "FILTER_LOAD_END_DATE"."SHPID"
		, "FILTER_LOAD_END_DATE"."SHJOBN"
		, "FILTER_LOAD_END_DATE"."SHUPMJ"
		, "FILTER_LOAD_END_DATE"."SHTDAY"
		, "FILTER_LOAD_END_DATE"."SHIR01"
		, "FILTER_LOAD_END_DATE"."SHIR02"
		, "FILTER_LOAD_END_DATE"."SHIR03"
		, "FILTER_LOAD_END_DATE"."SHIR04"
		, "FILTER_LOAD_END_DATE"."SHIR05"
		, "FILTER_LOAD_END_DATE"."SHVR03"
		, "FILTER_LOAD_END_DATE"."SHSOOR"
		, "FILTER_LOAD_END_DATE"."SHPMDT"
		, "FILTER_LOAD_END_DATE"."SHRSDT"
		, "FILTER_LOAD_END_DATE"."SHRQSJ"
		, "FILTER_LOAD_END_DATE"."SHPSTM"
		, "FILTER_LOAD_END_DATE"."SHPDTT"
		, "FILTER_LOAD_END_DATE"."SHOPTT"
		, "FILTER_LOAD_END_DATE"."SHDRQT"
		, "FILTER_LOAD_END_DATE"."SHADTM"
		, "FILTER_LOAD_END_DATE"."SHADLJ"
		, "FILTER_LOAD_END_DATE"."SHPBAN"
		, "FILTER_LOAD_END_DATE"."SHITAN"
		, "FILTER_LOAD_END_DATE"."SHFTAN"
		, "FILTER_LOAD_END_DATE"."SHDVAN"
		, "FILTER_LOAD_END_DATE"."SHDOC1"
		, "FILTER_LOAD_END_DATE"."SHDCT4"
		, "FILTER_LOAD_END_DATE"."SHCORD"
		, "FILTER_LOAD_END_DATE"."SHBSC"
		, "FILTER_LOAD_END_DATE"."SHBCRC"
		, "FILTER_LOAD_END_DATE"."SHAUFT"
		, "FILTER_LOAD_END_DATE"."SHAUFI"
		, "FILTER_LOAD_END_DATE"."SHOPBO"
		, "FILTER_LOAD_END_DATE"."SHOPTC"
		, "FILTER_LOAD_END_DATE"."SHOPLD"
		, "FILTER_LOAD_END_DATE"."SHOPBK"
		, "FILTER_LOAD_END_DATE"."SHOPSB"
		, "FILTER_LOAD_END_DATE"."SHOPPS"
		, "FILTER_LOAD_END_DATE"."SHOPPL"
		, "FILTER_LOAD_END_DATE"."SHOPMS"
		, "FILTER_LOAD_END_DATE"."SHOPSS"
		, "FILTER_LOAD_END_DATE"."SHOPBA"
		, "FILTER_LOAD_END_DATE"."SHOPLL"
		, "FILTER_LOAD_END_DATE"."SHPRAN8"
		, "FILTER_LOAD_END_DATE"."SHOPPID"
		, "FILTER_LOAD_END_DATE"."SHSDATTN"
		, "FILTER_LOAD_END_DATE"."SHSPATTN"
		, "FILTER_LOAD_END_DATE"."SHOTIND"
		, "FILTER_LOAD_END_DATE"."SHPRCIDLN"
		, "FILTER_LOAD_END_DATE"."SHCCIDLN"
		, "FILTER_LOAD_END_DATE"."SHSHCCIDLN"
	FROM "FILTER_LOAD_END_DATE"

) final 
where '{{ var("load_type") }}' = 'INCR' and '{{ var("source") }}' = 'JDEDWARDS'

UNION ALL

select * from (
	WITH "STG_SRC" AS 
	( 
		SELECT 
			  "STG_INR_SRC"."SALESORDERHEADERHISTORY_HKEY" AS "SALESORDERHEADERHISTORY_HKEY"
			, "STG_INR_SRC"."LOAD_DATE" AS "LOAD_DATE"
			, TO_TIMESTAMP('31/12/2999 23:59:59' , 'DD/MM/YYYY HH24:MI:SS') AS "LOAD_END_DATE"
			, "STG_INR_SRC"."LOAD_CYCLE_ID" AS "LOAD_CYCLE_ID"
			, UPPER(MD5_HEX(COALESCE(RTRIM( UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHSFXO"),'~'),'\#','\\' || '\#'))
				|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHCO"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHOKCO"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHOORN"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHOCTO"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHRKCO"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHRORN"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHRCTO"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHSHAN")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHPA8")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHDRQJ")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHTRDJ")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHPDDJ")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHOPDJ")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHADDJ")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHCNDJ")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHPEFJ")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHPPDJ")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHVR01"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHVR02"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHDEL1"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHDEL2"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHINMG"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHPTC"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHRYIN"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHASN"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHPRGP"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHTRDC")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHPCRT")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHTXA1"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHEXR1"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHTXCT"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHATXT"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHPRIO"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHBACK"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHSBAL"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHHOLD"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHPLST"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHINVC")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHNTR"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHANBY")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHCARS")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHMOT"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHCOT"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHROUT"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHSTOP"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHZON"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHCNID"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHFRTH"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHAFT"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHFUF1"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHFRTC"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHMORD"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHRCD"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHFUF2"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHOTOT")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHTOTC")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHWUMD"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHVUMD"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHAUTN"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHCACT"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHCEXP")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHSBLI"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHCRMD"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHCRRM"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHCRCD"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHCRR")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHLNGP"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHFAP")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHFCST")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHORBY"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHTKBY"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHURCD"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHURDT")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHURAT")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHURAB")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHURRF"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHUSER"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHPID"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHJOBN"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHUPMJ")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHTDAY")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHIR01"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHIR02"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHIR03"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHIR04"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHIR05"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHVR03"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHSOOR")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHPMDT")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHRSDT")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHRQSJ")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHPSTM")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHPDTT")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHOPTT")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHDRQT")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHADTM")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHADLJ")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHPBAN")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHITAN")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHFTAN")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHDVAN")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHDOC1")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHDCT4"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHCORD")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHBSC"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHBCRC"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHAUFT"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHAUFI"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHOPBO"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHOPTC")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHOPLD")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHOPBK")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHOPSB")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHOPPS"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHOPPL"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHOPMS"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHOPSS"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHOPBA"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHOPLL"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHPRAN8")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHOPPID")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHSDATTN"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHSPATTN"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_INR_SRC"."SHOTIND"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHPRCIDLN")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHCCIDLN")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_INR_SRC"."SHSHCCIDLN")),'~'),'\#','\\' || '\#'))|| '\#','\#' || '~'),'~') )) AS "HASH_DIFF"
			, CAST('N' AS VARCHAR) AS "DELETE_FLAG"
			, "STG_INR_SRC"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP"
			, "STG_INR_SRC"."SHKCOO" AS "SHKCOO"
			, "STG_INR_SRC"."SHDOCO" AS "SHDOCO"
			, "STG_INR_SRC"."SHDCTO" AS "SHDCTO"
			, "STG_INR_SRC"."SHMCU" AS "SHMCU"
			, "STG_INR_SRC"."SHAN8" AS "SHAN8"
			, "STG_INR_SRC"."SHSFXO" AS "SHSFXO"
			, "STG_INR_SRC"."SHCO" AS "SHCO"
			, "STG_INR_SRC"."SHOKCO" AS "SHOKCO"
			, "STG_INR_SRC"."SHOORN" AS "SHOORN"
			, "STG_INR_SRC"."SHOCTO" AS "SHOCTO"
			, "STG_INR_SRC"."SHRKCO" AS "SHRKCO"
			, "STG_INR_SRC"."SHRORN" AS "SHRORN"
			, "STG_INR_SRC"."SHRCTO" AS "SHRCTO"
			, "STG_INR_SRC"."SHSHAN" AS "SHSHAN"
			, "STG_INR_SRC"."SHPA8" AS "SHPA8"
			, "STG_INR_SRC"."SHDRQJ" AS "SHDRQJ"
			, "STG_INR_SRC"."SHTRDJ" AS "SHTRDJ"
			, "STG_INR_SRC"."SHPDDJ" AS "SHPDDJ"
			, "STG_INR_SRC"."SHOPDJ" AS "SHOPDJ"
			, "STG_INR_SRC"."SHADDJ" AS "SHADDJ"
			, "STG_INR_SRC"."SHCNDJ" AS "SHCNDJ"
			, "STG_INR_SRC"."SHPEFJ" AS "SHPEFJ"
			, "STG_INR_SRC"."SHPPDJ" AS "SHPPDJ"
			, "STG_INR_SRC"."SHVR01" AS "SHVR01"
			, "STG_INR_SRC"."SHVR02" AS "SHVR02"
			, "STG_INR_SRC"."SHDEL1" AS "SHDEL1"
			, "STG_INR_SRC"."SHDEL2" AS "SHDEL2"
			, "STG_INR_SRC"."SHINMG" AS "SHINMG"
			, "STG_INR_SRC"."SHPTC" AS "SHPTC"
			, "STG_INR_SRC"."SHRYIN" AS "SHRYIN"
			, "STG_INR_SRC"."SHASN" AS "SHASN"
			, "STG_INR_SRC"."SHPRGP" AS "SHPRGP"
			, "STG_INR_SRC"."SHTRDC" AS "SHTRDC"
			, "STG_INR_SRC"."SHPCRT" AS "SHPCRT"
			, "STG_INR_SRC"."SHTXA1" AS "SHTXA1"
			, "STG_INR_SRC"."SHEXR1" AS "SHEXR1"
			, "STG_INR_SRC"."SHTXCT" AS "SHTXCT"
			, "STG_INR_SRC"."SHATXT" AS "SHATXT"
			, "STG_INR_SRC"."SHPRIO" AS "SHPRIO"
			, "STG_INR_SRC"."SHBACK" AS "SHBACK"
			, "STG_INR_SRC"."SHSBAL" AS "SHSBAL"
			, "STG_INR_SRC"."SHHOLD" AS "SHHOLD"
			, "STG_INR_SRC"."SHPLST" AS "SHPLST"
			, "STG_INR_SRC"."SHINVC" AS "SHINVC"
			, "STG_INR_SRC"."SHNTR" AS "SHNTR"
			, "STG_INR_SRC"."SHANBY" AS "SHANBY"
			, "STG_INR_SRC"."SHCARS" AS "SHCARS"
			, "STG_INR_SRC"."SHMOT" AS "SHMOT"
			, "STG_INR_SRC"."SHCOT" AS "SHCOT"
			, "STG_INR_SRC"."SHROUT" AS "SHROUT"
			, "STG_INR_SRC"."SHSTOP" AS "SHSTOP"
			, "STG_INR_SRC"."SHZON" AS "SHZON"
			, "STG_INR_SRC"."SHCNID" AS "SHCNID"
			, "STG_INR_SRC"."SHFRTH" AS "SHFRTH"
			, "STG_INR_SRC"."SHAFT" AS "SHAFT"
			, "STG_INR_SRC"."SHFUF1" AS "SHFUF1"
			, "STG_INR_SRC"."SHFRTC" AS "SHFRTC"
			, "STG_INR_SRC"."SHMORD" AS "SHMORD"
			, "STG_INR_SRC"."SHRCD" AS "SHRCD"
			, "STG_INR_SRC"."SHFUF2" AS "SHFUF2"
			, "STG_INR_SRC"."SHOTOT" AS "SHOTOT"
			, "STG_INR_SRC"."SHTOTC" AS "SHTOTC"
			, "STG_INR_SRC"."SHWUMD" AS "SHWUMD"
			, "STG_INR_SRC"."SHVUMD" AS "SHVUMD"
			, "STG_INR_SRC"."SHAUTN" AS "SHAUTN"
			, "STG_INR_SRC"."SHCACT" AS "SHCACT"
			, "STG_INR_SRC"."SHCEXP" AS "SHCEXP"
			, "STG_INR_SRC"."SHSBLI" AS "SHSBLI"
			, "STG_INR_SRC"."SHCRMD" AS "SHCRMD"
			, "STG_INR_SRC"."SHCRRM" AS "SHCRRM"
			, "STG_INR_SRC"."SHCRCD" AS "SHCRCD"
			, "STG_INR_SRC"."SHCRR" AS "SHCRR"
			, "STG_INR_SRC"."SHLNGP" AS "SHLNGP"
			, "STG_INR_SRC"."SHFAP" AS "SHFAP"
			, "STG_INR_SRC"."SHFCST" AS "SHFCST"
			, "STG_INR_SRC"."SHORBY" AS "SHORBY"
			, "STG_INR_SRC"."SHTKBY" AS "SHTKBY"
			, "STG_INR_SRC"."SHURCD" AS "SHURCD"
			, "STG_INR_SRC"."SHURDT" AS "SHURDT"
			, "STG_INR_SRC"."SHURAT" AS "SHURAT"
			, "STG_INR_SRC"."SHURAB" AS "SHURAB"
			, "STG_INR_SRC"."SHURRF" AS "SHURRF"
			, "STG_INR_SRC"."SHUSER" AS "SHUSER"
			, "STG_INR_SRC"."SHPID" AS "SHPID"
			, "STG_INR_SRC"."SHJOBN" AS "SHJOBN"
			, "STG_INR_SRC"."SHUPMJ" AS "SHUPMJ"
			, "STG_INR_SRC"."SHTDAY" AS "SHTDAY"
			, "STG_INR_SRC"."SHIR01" AS "SHIR01"
			, "STG_INR_SRC"."SHIR02" AS "SHIR02"
			, "STG_INR_SRC"."SHIR03" AS "SHIR03"
			, "STG_INR_SRC"."SHIR04" AS "SHIR04"
			, "STG_INR_SRC"."SHIR05" AS "SHIR05"
			, "STG_INR_SRC"."SHVR03" AS "SHVR03"
			, "STG_INR_SRC"."SHSOOR" AS "SHSOOR"
			, "STG_INR_SRC"."SHPMDT" AS "SHPMDT"
			, "STG_INR_SRC"."SHRSDT" AS "SHRSDT"
			, "STG_INR_SRC"."SHRQSJ" AS "SHRQSJ"
			, "STG_INR_SRC"."SHPSTM" AS "SHPSTM"
			, "STG_INR_SRC"."SHPDTT" AS "SHPDTT"
			, "STG_INR_SRC"."SHOPTT" AS "SHOPTT"
			, "STG_INR_SRC"."SHDRQT" AS "SHDRQT"
			, "STG_INR_SRC"."SHADTM" AS "SHADTM"
			, "STG_INR_SRC"."SHADLJ" AS "SHADLJ"
			, "STG_INR_SRC"."SHPBAN" AS "SHPBAN"
			, "STG_INR_SRC"."SHITAN" AS "SHITAN"
			, "STG_INR_SRC"."SHFTAN" AS "SHFTAN"
			, "STG_INR_SRC"."SHDVAN" AS "SHDVAN"
			, "STG_INR_SRC"."SHDOC1" AS "SHDOC1"
			, "STG_INR_SRC"."SHDCT4" AS "SHDCT4"
			, "STG_INR_SRC"."SHCORD" AS "SHCORD"
			, "STG_INR_SRC"."SHBSC" AS "SHBSC"
			, "STG_INR_SRC"."SHBCRC" AS "SHBCRC"
			, "STG_INR_SRC"."SHAUFT" AS "SHAUFT"
			, "STG_INR_SRC"."SHAUFI" AS "SHAUFI"
			, "STG_INR_SRC"."SHOPBO" AS "SHOPBO"
			, "STG_INR_SRC"."SHOPTC" AS "SHOPTC"
			, "STG_INR_SRC"."SHOPLD" AS "SHOPLD"
			, "STG_INR_SRC"."SHOPBK" AS "SHOPBK"
			, "STG_INR_SRC"."SHOPSB" AS "SHOPSB"
			, "STG_INR_SRC"."SHOPPS" AS "SHOPPS"
			, "STG_INR_SRC"."SHOPPL" AS "SHOPPL"
			, "STG_INR_SRC"."SHOPMS" AS "SHOPMS"
			, "STG_INR_SRC"."SHOPSS" AS "SHOPSS"
			, "STG_INR_SRC"."SHOPBA" AS "SHOPBA"
			, "STG_INR_SRC"."SHOPLL" AS "SHOPLL"
			, "STG_INR_SRC"."SHPRAN8" AS "SHPRAN8"
			, "STG_INR_SRC"."SHOPPID" AS "SHOPPID"
			, "STG_INR_SRC"."SHSDATTN" AS "SHSDATTN"
			, "STG_INR_SRC"."SHSPATTN" AS "SHSPATTN"
			, "STG_INR_SRC"."SHOTIND" AS "SHOTIND"
			, "STG_INR_SRC"."SHPRCIDLN" AS "SHPRCIDLN"
			, "STG_INR_SRC"."SHCCIDLN" AS "SHCCIDLN"
			, "STG_INR_SRC"."SHSHCCIDLN" AS "SHSHCCIDLN"
			, ROW_NUMBER()OVER(PARTITION BY "STG_INR_SRC"."SALESORDERHEADERHISTORY_HKEY" ORDER BY "STG_INR_SRC"."LOAD_DATE") AS "DUMMY"
		FROM {{ ref('JDEDWARDS_STG_F42019') }} "STG_INR_SRC"
	)
	SELECT 
		  "STG_SRC"."SALESORDERHEADERHISTORY_HKEY" AS "SALESORDERHEADERHISTORY_HKEY"
		, "STG_SRC"."LOAD_DATE" AS "LOAD_DATE"
		, "STG_SRC"."LOAD_END_DATE" AS "LOAD_END_DATE"
		, "STG_SRC"."LOAD_CYCLE_ID" AS "LOAD_CYCLE_ID"
		, "STG_SRC"."HASH_DIFF" AS "HASH_DIFF"
		, "STG_SRC"."DELETE_FLAG" AS "DELETE_FLAG"
		, "STG_SRC"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP"
		, "STG_SRC"."SHKCOO" AS "SHKCOO"
		, "STG_SRC"."SHDOCO" AS "SHDOCO"
		, "STG_SRC"."SHDCTO" AS "SHDCTO"
		, "STG_SRC"."SHMCU" AS "SHMCU"
		, "STG_SRC"."SHAN8" AS "SHAN8"
		, "STG_SRC"."SHSFXO" AS "SHSFXO"
		, "STG_SRC"."SHCO" AS "SHCO"
		, "STG_SRC"."SHOKCO" AS "SHOKCO"
		, "STG_SRC"."SHOORN" AS "SHOORN"
		, "STG_SRC"."SHOCTO" AS "SHOCTO"
		, "STG_SRC"."SHRKCO" AS "SHRKCO"
		, "STG_SRC"."SHRORN" AS "SHRORN"
		, "STG_SRC"."SHRCTO" AS "SHRCTO"
		, "STG_SRC"."SHSHAN" AS "SHSHAN"
		, "STG_SRC"."SHPA8" AS "SHPA8"
		, "STG_SRC"."SHDRQJ" AS "SHDRQJ"
		, "STG_SRC"."SHTRDJ" AS "SHTRDJ"
		, "STG_SRC"."SHPDDJ" AS "SHPDDJ"
		, "STG_SRC"."SHOPDJ" AS "SHOPDJ"
		, "STG_SRC"."SHADDJ" AS "SHADDJ"
		, "STG_SRC"."SHCNDJ" AS "SHCNDJ"
		, "STG_SRC"."SHPEFJ" AS "SHPEFJ"
		, "STG_SRC"."SHPPDJ" AS "SHPPDJ"
		, "STG_SRC"."SHVR01" AS "SHVR01"
		, "STG_SRC"."SHVR02" AS "SHVR02"
		, "STG_SRC"."SHDEL1" AS "SHDEL1"
		, "STG_SRC"."SHDEL2" AS "SHDEL2"
		, "STG_SRC"."SHINMG" AS "SHINMG"
		, "STG_SRC"."SHPTC" AS "SHPTC"
		, "STG_SRC"."SHRYIN" AS "SHRYIN"
		, "STG_SRC"."SHASN" AS "SHASN"
		, "STG_SRC"."SHPRGP" AS "SHPRGP"
		, "STG_SRC"."SHTRDC" AS "SHTRDC"
		, "STG_SRC"."SHPCRT" AS "SHPCRT"
		, "STG_SRC"."SHTXA1" AS "SHTXA1"
		, "STG_SRC"."SHEXR1" AS "SHEXR1"
		, "STG_SRC"."SHTXCT" AS "SHTXCT"
		, "STG_SRC"."SHATXT" AS "SHATXT"
		, "STG_SRC"."SHPRIO" AS "SHPRIO"
		, "STG_SRC"."SHBACK" AS "SHBACK"
		, "STG_SRC"."SHSBAL" AS "SHSBAL"
		, "STG_SRC"."SHHOLD" AS "SHHOLD"
		, "STG_SRC"."SHPLST" AS "SHPLST"
		, "STG_SRC"."SHINVC" AS "SHINVC"
		, "STG_SRC"."SHNTR" AS "SHNTR"
		, "STG_SRC"."SHANBY" AS "SHANBY"
		, "STG_SRC"."SHCARS" AS "SHCARS"
		, "STG_SRC"."SHMOT" AS "SHMOT"
		, "STG_SRC"."SHCOT" AS "SHCOT"
		, "STG_SRC"."SHROUT" AS "SHROUT"
		, "STG_SRC"."SHSTOP" AS "SHSTOP"
		, "STG_SRC"."SHZON" AS "SHZON"
		, "STG_SRC"."SHCNID" AS "SHCNID"
		, "STG_SRC"."SHFRTH" AS "SHFRTH"
		, "STG_SRC"."SHAFT" AS "SHAFT"
		, "STG_SRC"."SHFUF1" AS "SHFUF1"
		, "STG_SRC"."SHFRTC" AS "SHFRTC"
		, "STG_SRC"."SHMORD" AS "SHMORD"
		, "STG_SRC"."SHRCD" AS "SHRCD"
		, "STG_SRC"."SHFUF2" AS "SHFUF2"
		, "STG_SRC"."SHOTOT" AS "SHOTOT"
		, "STG_SRC"."SHTOTC" AS "SHTOTC"
		, "STG_SRC"."SHWUMD" AS "SHWUMD"
		, "STG_SRC"."SHVUMD" AS "SHVUMD"
		, "STG_SRC"."SHAUTN" AS "SHAUTN"
		, "STG_SRC"."SHCACT" AS "SHCACT"
		, "STG_SRC"."SHCEXP" AS "SHCEXP"
		, "STG_SRC"."SHSBLI" AS "SHSBLI"
		, "STG_SRC"."SHCRMD" AS "SHCRMD"
		, "STG_SRC"."SHCRRM" AS "SHCRRM"
		, "STG_SRC"."SHCRCD" AS "SHCRCD"
		, "STG_SRC"."SHCRR" AS "SHCRR"
		, "STG_SRC"."SHLNGP" AS "SHLNGP"
		, "STG_SRC"."SHFAP" AS "SHFAP"
		, "STG_SRC"."SHFCST" AS "SHFCST"
		, "STG_SRC"."SHORBY" AS "SHORBY"
		, "STG_SRC"."SHTKBY" AS "SHTKBY"
		, "STG_SRC"."SHURCD" AS "SHURCD"
		, "STG_SRC"."SHURDT" AS "SHURDT"
		, "STG_SRC"."SHURAT" AS "SHURAT"
		, "STG_SRC"."SHURAB" AS "SHURAB"
		, "STG_SRC"."SHURRF" AS "SHURRF"
		, "STG_SRC"."SHUSER" AS "SHUSER"
		, "STG_SRC"."SHPID" AS "SHPID"
		, "STG_SRC"."SHJOBN" AS "SHJOBN"
		, "STG_SRC"."SHUPMJ" AS "SHUPMJ"
		, "STG_SRC"."SHTDAY" AS "SHTDAY"
		, "STG_SRC"."SHIR01" AS "SHIR01"
		, "STG_SRC"."SHIR02" AS "SHIR02"
		, "STG_SRC"."SHIR03" AS "SHIR03"
		, "STG_SRC"."SHIR04" AS "SHIR04"
		, "STG_SRC"."SHIR05" AS "SHIR05"
		, "STG_SRC"."SHVR03" AS "SHVR03"
		, "STG_SRC"."SHSOOR" AS "SHSOOR"
		, "STG_SRC"."SHPMDT" AS "SHPMDT"
		, "STG_SRC"."SHRSDT" AS "SHRSDT"
		, "STG_SRC"."SHRQSJ" AS "SHRQSJ"
		, "STG_SRC"."SHPSTM" AS "SHPSTM"
		, "STG_SRC"."SHPDTT" AS "SHPDTT"
		, "STG_SRC"."SHOPTT" AS "SHOPTT"
		, "STG_SRC"."SHDRQT" AS "SHDRQT"
		, "STG_SRC"."SHADTM" AS "SHADTM"
		, "STG_SRC"."SHADLJ" AS "SHADLJ"
		, "STG_SRC"."SHPBAN" AS "SHPBAN"
		, "STG_SRC"."SHITAN" AS "SHITAN"
		, "STG_SRC"."SHFTAN" AS "SHFTAN"
		, "STG_SRC"."SHDVAN" AS "SHDVAN"
		, "STG_SRC"."SHDOC1" AS "SHDOC1"
		, "STG_SRC"."SHDCT4" AS "SHDCT4"
		, "STG_SRC"."SHCORD" AS "SHCORD"
		, "STG_SRC"."SHBSC" AS "SHBSC"
		, "STG_SRC"."SHBCRC" AS "SHBCRC"
		, "STG_SRC"."SHAUFT" AS "SHAUFT"
		, "STG_SRC"."SHAUFI" AS "SHAUFI"
		, "STG_SRC"."SHOPBO" AS "SHOPBO"
		, "STG_SRC"."SHOPTC" AS "SHOPTC"
		, "STG_SRC"."SHOPLD" AS "SHOPLD"
		, "STG_SRC"."SHOPBK" AS "SHOPBK"
		, "STG_SRC"."SHOPSB" AS "SHOPSB"
		, "STG_SRC"."SHOPPS" AS "SHOPPS"
		, "STG_SRC"."SHOPPL" AS "SHOPPL"
		, "STG_SRC"."SHOPMS" AS "SHOPMS"
		, "STG_SRC"."SHOPSS" AS "SHOPSS"
		, "STG_SRC"."SHOPBA" AS "SHOPBA"
		, "STG_SRC"."SHOPLL" AS "SHOPLL"
		, "STG_SRC"."SHPRAN8" AS "SHPRAN8"
		, "STG_SRC"."SHOPPID" AS "SHOPPID"
		, "STG_SRC"."SHSDATTN" AS "SHSDATTN"
		, "STG_SRC"."SHSPATTN" AS "SHSPATTN"
		, "STG_SRC"."SHOTIND" AS "SHOTIND"
		, "STG_SRC"."SHPRCIDLN" AS "SHPRCIDLN"
		, "STG_SRC"."SHCCIDLN" AS "SHCCIDLN"
		, "STG_SRC"."SHSHCCIDLN" AS "SHSHCCIDLN"
	FROM "STG_SRC" "STG_SRC"
	WHERE  "STG_SRC"."DUMMY" = 1

) final 
where '{{ var("load_type") }}' = 'INIT' and '{{ var("source") }}' = 'JDEDWARDS'