{{
	config(
		materialized='incremental',
		pre_hook= [
			'{% if var("load_type") == "INCR" and var("source") == "JDEDWARDS" %} TRUNCATE TABLE {{ this }}; {% endif %}'
		],
		alias='SAT_JDE_SALESORDERHEADERHISTORY_TMP',
		schema='JDEDWARDS_STG',
		tags=['JDEDWARDS', 'SAT_JDE_SOHEADERHIST_INCR']
	)
}}
select * from (
	WITH "DIST_STG" AS 
	( 
		SELECT DISTINCT 
 			  "STG_DIS_SRC"."SALESORDERHEADERHISTORY_HKEY" AS "SALESORDERHEADERHISTORY_HKEY"
			, "STG_DIS_SRC"."LOAD_CYCLE_ID" AS "LOAD_CYCLE_ID"
		FROM {{ ref('JDEDWARDS_STG_F42019') }} "STG_DIS_SRC"
		WHERE  "STG_DIS_SRC"."RECORD_TYPE" = 'S'
	)
	, "TEMP_TABLE_SET" AS 
	( 
		SELECT 
			  "STG_TEMP_SRC"."SALESORDERHEADERHISTORY_HKEY" AS "SALESORDERHEADERHISTORY_HKEY"
			, "STG_TEMP_SRC"."LOAD_DATE" AS "LOAD_DATE"
			, "STG_TEMP_SRC"."LOAD_CYCLE_ID" AS "LOAD_CYCLE_ID"
			, TO_TIMESTAMP('31/12/2999 23:59:59', 'DD/MM/YYYY HH24:MI:SS') AS "LOAD_END_DATE"
			, "STG_TEMP_SRC"."RECORD_TYPE" AS "RECORD_TYPE"
			, 'STG' AS "SOURCE"
			, 1 AS "ORIGIN_ID"
			, UPPER(MD5_HEX(COALESCE(RTRIM( UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHSFXO"),'~'),'\#','\\' || '\#'))
				|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHCO"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHOKCO"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHOORN"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHOCTO"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHRKCO"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHRORN"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHRCTO"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHSHAN")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHPA8")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHDRQJ")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHTRDJ")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHPDDJ")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHOPDJ")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHADDJ")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHCNDJ")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHPEFJ")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHPPDJ")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHVR01"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHVR02"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHDEL1"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHDEL2"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHINMG"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHPTC"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHRYIN"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHASN"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHPRGP"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHTRDC")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHPCRT")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHTXA1"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHEXR1"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHTXCT"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHATXT"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHPRIO"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHBACK"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHSBAL"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHHOLD"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHPLST"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHINVC")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHNTR"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHANBY")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHCARS")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHMOT"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHCOT"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHROUT"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHSTOP"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHZON"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHCNID"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHFRTH"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHAFT"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHFUF1"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHFRTC"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHMORD"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHRCD"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHFUF2"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHOTOT")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHTOTC")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHWUMD"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHVUMD"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHAUTN"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHCACT"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHCEXP")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHSBLI"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHCRMD"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHCRRM"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHCRCD"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHCRR")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHLNGP"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHFAP")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHFCST")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHORBY"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHTKBY"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHURCD"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHURDT")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHURAT")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHURAB")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHURRF"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHUSER"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHPID"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHJOBN"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHUPMJ")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHTDAY")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHIR01"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHIR02"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHIR03"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHIR04"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHIR05"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHVR03"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHSOOR")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHPMDT")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHRSDT")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHRQSJ")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHPSTM")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHPDTT")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHOPTT")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHDRQT")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHADTM")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHADLJ")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHPBAN")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHITAN")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHFTAN")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHDVAN")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHDOC1")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHDCT4"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHCORD")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHBSC"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHBCRC"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHAUFT"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHAUFI"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHOPBO"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHOPTC")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHOPLD")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHOPBK")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHOPSB")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHOPPS"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHOPPL"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHOPMS"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHOPSS"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHOPBA"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHOPLL"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHPRAN8")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHOPPID")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHSDATTN"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHSPATTN"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( "STG_TEMP_SRC"."SHOTIND"),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHPRCIDLN")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHCCIDLN")),'~'),'\#','\\' || '\#'))|| '\#' ||  UPPER(REPLACE(COALESCE(TRIM( TO_CHAR("STG_TEMP_SRC"."SHSHCCIDLN")),'~'),'\#','\\' || '\#'))|| '\#','\#' || '~'),'~') )) AS "HASH_DIFF"
			, CASE WHEN "STG_TEMP_SRC"."JRN_FLAG" = 'D' THEN CAST('Y' AS VARCHAR) ELSE CAST('N' AS VARCHAR) END AS "DELETE_FLAG"
			, "STG_TEMP_SRC"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP"
			, "STG_TEMP_SRC"."SHKCOO" AS "SHKCOO"
			, "STG_TEMP_SRC"."SHDOCO" AS "SHDOCO"
			, "STG_TEMP_SRC"."SHDCTO" AS "SHDCTO"
			, "STG_TEMP_SRC"."SHMCU" AS "SHMCU"
			, "STG_TEMP_SRC"."SHAN8" AS "SHAN8"
			, "STG_TEMP_SRC"."SHSFXO" AS "SHSFXO"
			, "STG_TEMP_SRC"."SHCO" AS "SHCO"
			, "STG_TEMP_SRC"."SHOKCO" AS "SHOKCO"
			, "STG_TEMP_SRC"."SHOORN" AS "SHOORN"
			, "STG_TEMP_SRC"."SHOCTO" AS "SHOCTO"
			, "STG_TEMP_SRC"."SHRKCO" AS "SHRKCO"
			, "STG_TEMP_SRC"."SHRORN" AS "SHRORN"
			, "STG_TEMP_SRC"."SHRCTO" AS "SHRCTO"
			, "STG_TEMP_SRC"."SHSHAN" AS "SHSHAN"
			, "STG_TEMP_SRC"."SHPA8" AS "SHPA8"
			, "STG_TEMP_SRC"."SHDRQJ" AS "SHDRQJ"
			, "STG_TEMP_SRC"."SHTRDJ" AS "SHTRDJ"
			, "STG_TEMP_SRC"."SHPDDJ" AS "SHPDDJ"
			, "STG_TEMP_SRC"."SHOPDJ" AS "SHOPDJ"
			, "STG_TEMP_SRC"."SHADDJ" AS "SHADDJ"
			, "STG_TEMP_SRC"."SHCNDJ" AS "SHCNDJ"
			, "STG_TEMP_SRC"."SHPEFJ" AS "SHPEFJ"
			, "STG_TEMP_SRC"."SHPPDJ" AS "SHPPDJ"
			, "STG_TEMP_SRC"."SHVR01" AS "SHVR01"
			, "STG_TEMP_SRC"."SHVR02" AS "SHVR02"
			, "STG_TEMP_SRC"."SHDEL1" AS "SHDEL1"
			, "STG_TEMP_SRC"."SHDEL2" AS "SHDEL2"
			, "STG_TEMP_SRC"."SHINMG" AS "SHINMG"
			, "STG_TEMP_SRC"."SHPTC" AS "SHPTC"
			, "STG_TEMP_SRC"."SHRYIN" AS "SHRYIN"
			, "STG_TEMP_SRC"."SHASN" AS "SHASN"
			, "STG_TEMP_SRC"."SHPRGP" AS "SHPRGP"
			, "STG_TEMP_SRC"."SHTRDC" AS "SHTRDC"
			, "STG_TEMP_SRC"."SHPCRT" AS "SHPCRT"
			, "STG_TEMP_SRC"."SHTXA1" AS "SHTXA1"
			, "STG_TEMP_SRC"."SHEXR1" AS "SHEXR1"
			, "STG_TEMP_SRC"."SHTXCT" AS "SHTXCT"
			, "STG_TEMP_SRC"."SHATXT" AS "SHATXT"
			, "STG_TEMP_SRC"."SHPRIO" AS "SHPRIO"
			, "STG_TEMP_SRC"."SHBACK" AS "SHBACK"
			, "STG_TEMP_SRC"."SHSBAL" AS "SHSBAL"
			, "STG_TEMP_SRC"."SHHOLD" AS "SHHOLD"
			, "STG_TEMP_SRC"."SHPLST" AS "SHPLST"
			, "STG_TEMP_SRC"."SHINVC" AS "SHINVC"
			, "STG_TEMP_SRC"."SHNTR" AS "SHNTR"
			, "STG_TEMP_SRC"."SHANBY" AS "SHANBY"
			, "STG_TEMP_SRC"."SHCARS" AS "SHCARS"
			, "STG_TEMP_SRC"."SHMOT" AS "SHMOT"
			, "STG_TEMP_SRC"."SHCOT" AS "SHCOT"
			, "STG_TEMP_SRC"."SHROUT" AS "SHROUT"
			, "STG_TEMP_SRC"."SHSTOP" AS "SHSTOP"
			, "STG_TEMP_SRC"."SHZON" AS "SHZON"
			, "STG_TEMP_SRC"."SHCNID" AS "SHCNID"
			, "STG_TEMP_SRC"."SHFRTH" AS "SHFRTH"
			, "STG_TEMP_SRC"."SHAFT" AS "SHAFT"
			, "STG_TEMP_SRC"."SHFUF1" AS "SHFUF1"
			, "STG_TEMP_SRC"."SHFRTC" AS "SHFRTC"
			, "STG_TEMP_SRC"."SHMORD" AS "SHMORD"
			, "STG_TEMP_SRC"."SHRCD" AS "SHRCD"
			, "STG_TEMP_SRC"."SHFUF2" AS "SHFUF2"
			, "STG_TEMP_SRC"."SHOTOT" AS "SHOTOT"
			, "STG_TEMP_SRC"."SHTOTC" AS "SHTOTC"
			, "STG_TEMP_SRC"."SHWUMD" AS "SHWUMD"
			, "STG_TEMP_SRC"."SHVUMD" AS "SHVUMD"
			, "STG_TEMP_SRC"."SHAUTN" AS "SHAUTN"
			, "STG_TEMP_SRC"."SHCACT" AS "SHCACT"
			, "STG_TEMP_SRC"."SHCEXP" AS "SHCEXP"
			, "STG_TEMP_SRC"."SHSBLI" AS "SHSBLI"
			, "STG_TEMP_SRC"."SHCRMD" AS "SHCRMD"
			, "STG_TEMP_SRC"."SHCRRM" AS "SHCRRM"
			, "STG_TEMP_SRC"."SHCRCD" AS "SHCRCD"
			, "STG_TEMP_SRC"."SHCRR" AS "SHCRR"
			, "STG_TEMP_SRC"."SHLNGP" AS "SHLNGP"
			, "STG_TEMP_SRC"."SHFAP" AS "SHFAP"
			, "STG_TEMP_SRC"."SHFCST" AS "SHFCST"
			, "STG_TEMP_SRC"."SHORBY" AS "SHORBY"
			, "STG_TEMP_SRC"."SHTKBY" AS "SHTKBY"
			, "STG_TEMP_SRC"."SHURCD" AS "SHURCD"
			, "STG_TEMP_SRC"."SHURDT" AS "SHURDT"
			, "STG_TEMP_SRC"."SHURAT" AS "SHURAT"
			, "STG_TEMP_SRC"."SHURAB" AS "SHURAB"
			, "STG_TEMP_SRC"."SHURRF" AS "SHURRF"
			, "STG_TEMP_SRC"."SHUSER" AS "SHUSER"
			, "STG_TEMP_SRC"."SHPID" AS "SHPID"
			, "STG_TEMP_SRC"."SHJOBN" AS "SHJOBN"
			, "STG_TEMP_SRC"."SHUPMJ" AS "SHUPMJ"
			, "STG_TEMP_SRC"."SHTDAY" AS "SHTDAY"
			, "STG_TEMP_SRC"."SHIR01" AS "SHIR01"
			, "STG_TEMP_SRC"."SHIR02" AS "SHIR02"
			, "STG_TEMP_SRC"."SHIR03" AS "SHIR03"
			, "STG_TEMP_SRC"."SHIR04" AS "SHIR04"
			, "STG_TEMP_SRC"."SHIR05" AS "SHIR05"
			, "STG_TEMP_SRC"."SHVR03" AS "SHVR03"
			, "STG_TEMP_SRC"."SHSOOR" AS "SHSOOR"
			, "STG_TEMP_SRC"."SHPMDT" AS "SHPMDT"
			, "STG_TEMP_SRC"."SHRSDT" AS "SHRSDT"
			, "STG_TEMP_SRC"."SHRQSJ" AS "SHRQSJ"
			, "STG_TEMP_SRC"."SHPSTM" AS "SHPSTM"
			, "STG_TEMP_SRC"."SHPDTT" AS "SHPDTT"
			, "STG_TEMP_SRC"."SHOPTT" AS "SHOPTT"
			, "STG_TEMP_SRC"."SHDRQT" AS "SHDRQT"
			, "STG_TEMP_SRC"."SHADTM" AS "SHADTM"
			, "STG_TEMP_SRC"."SHADLJ" AS "SHADLJ"
			, "STG_TEMP_SRC"."SHPBAN" AS "SHPBAN"
			, "STG_TEMP_SRC"."SHITAN" AS "SHITAN"
			, "STG_TEMP_SRC"."SHFTAN" AS "SHFTAN"
			, "STG_TEMP_SRC"."SHDVAN" AS "SHDVAN"
			, "STG_TEMP_SRC"."SHDOC1" AS "SHDOC1"
			, "STG_TEMP_SRC"."SHDCT4" AS "SHDCT4"
			, "STG_TEMP_SRC"."SHCORD" AS "SHCORD"
			, "STG_TEMP_SRC"."SHBSC" AS "SHBSC"
			, "STG_TEMP_SRC"."SHBCRC" AS "SHBCRC"
			, "STG_TEMP_SRC"."SHAUFT" AS "SHAUFT"
			, "STG_TEMP_SRC"."SHAUFI" AS "SHAUFI"
			, "STG_TEMP_SRC"."SHOPBO" AS "SHOPBO"
			, "STG_TEMP_SRC"."SHOPTC" AS "SHOPTC"
			, "STG_TEMP_SRC"."SHOPLD" AS "SHOPLD"
			, "STG_TEMP_SRC"."SHOPBK" AS "SHOPBK"
			, "STG_TEMP_SRC"."SHOPSB" AS "SHOPSB"
			, "STG_TEMP_SRC"."SHOPPS" AS "SHOPPS"
			, "STG_TEMP_SRC"."SHOPPL" AS "SHOPPL"
			, "STG_TEMP_SRC"."SHOPMS" AS "SHOPMS"
			, "STG_TEMP_SRC"."SHOPSS" AS "SHOPSS"
			, "STG_TEMP_SRC"."SHOPBA" AS "SHOPBA"
			, "STG_TEMP_SRC"."SHOPLL" AS "SHOPLL"
			, "STG_TEMP_SRC"."SHPRAN8" AS "SHPRAN8"
			, "STG_TEMP_SRC"."SHOPPID" AS "SHOPPID"
			, "STG_TEMP_SRC"."SHSDATTN" AS "SHSDATTN"
			, "STG_TEMP_SRC"."SHSPATTN" AS "SHSPATTN"
			, "STG_TEMP_SRC"."SHOTIND" AS "SHOTIND"
			, "STG_TEMP_SRC"."SHPRCIDLN" AS "SHPRCIDLN"
			, "STG_TEMP_SRC"."SHCCIDLN" AS "SHCCIDLN"
			, "STG_TEMP_SRC"."SHSHCCIDLN" AS "SHSHCCIDLN"
		FROM {{ ref('JDEDWARDS_STG_F42019') }} "STG_TEMP_SRC"
		WHERE  "STG_TEMP_SRC"."RECORD_TYPE" = 'S'
		UNION ALL 
		SELECT 
			  "SAT_SRC"."SALESORDERHEADERHISTORY_HKEY" AS "SALESORDERHEADERHISTORY_HKEY"
			, "SAT_SRC"."LOAD_DATE" AS "LOAD_DATE"
			, "SAT_SRC"."LOAD_CYCLE_ID" AS "LOAD_CYCLE_ID"
			, "SAT_SRC"."LOAD_END_DATE" AS "LOAD_END_DATE"
			, 'SAT' AS "RECORD_TYPE"
			, 'SAT' AS "SOURCE"
			, 0 AS "ORIGIN_ID"
			, "SAT_SRC"."HASH_DIFF" AS "HASH_DIFF"
			, "SAT_SRC"."DELETE_FLAG" AS "DELETE_FLAG"
			, "SAT_SRC"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP"
			, "SAT_SRC"."SHKCOO" AS "SHKCOO"
			, "SAT_SRC"."SHDOCO" AS "SHDOCO"
			, "SAT_SRC"."SHDCTO" AS "SHDCTO"
			, "SAT_SRC"."SHMCU" AS "SHMCU"
			, "SAT_SRC"."SHAN8" AS "SHAN8"
			, "SAT_SRC"."SHSFXO" AS "SHSFXO"
			, "SAT_SRC"."SHCO" AS "SHCO"
			, "SAT_SRC"."SHOKCO" AS "SHOKCO"
			, "SAT_SRC"."SHOORN" AS "SHOORN"
			, "SAT_SRC"."SHOCTO" AS "SHOCTO"
			, "SAT_SRC"."SHRKCO" AS "SHRKCO"
			, "SAT_SRC"."SHRORN" AS "SHRORN"
			, "SAT_SRC"."SHRCTO" AS "SHRCTO"
			, "SAT_SRC"."SHSHAN" AS "SHSHAN"
			, "SAT_SRC"."SHPA8" AS "SHPA8"
			, "SAT_SRC"."SHDRQJ" AS "SHDRQJ"
			, "SAT_SRC"."SHTRDJ" AS "SHTRDJ"
			, "SAT_SRC"."SHPDDJ" AS "SHPDDJ"
			, "SAT_SRC"."SHOPDJ" AS "SHOPDJ"
			, "SAT_SRC"."SHADDJ" AS "SHADDJ"
			, "SAT_SRC"."SHCNDJ" AS "SHCNDJ"
			, "SAT_SRC"."SHPEFJ" AS "SHPEFJ"
			, "SAT_SRC"."SHPPDJ" AS "SHPPDJ"
			, "SAT_SRC"."SHVR01" AS "SHVR01"
			, "SAT_SRC"."SHVR02" AS "SHVR02"
			, "SAT_SRC"."SHDEL1" AS "SHDEL1"
			, "SAT_SRC"."SHDEL2" AS "SHDEL2"
			, "SAT_SRC"."SHINMG" AS "SHINMG"
			, "SAT_SRC"."SHPTC" AS "SHPTC"
			, "SAT_SRC"."SHRYIN" AS "SHRYIN"
			, "SAT_SRC"."SHASN" AS "SHASN"
			, "SAT_SRC"."SHPRGP" AS "SHPRGP"
			, "SAT_SRC"."SHTRDC" AS "SHTRDC"
			, "SAT_SRC"."SHPCRT" AS "SHPCRT"
			, "SAT_SRC"."SHTXA1" AS "SHTXA1"
			, "SAT_SRC"."SHEXR1" AS "SHEXR1"
			, "SAT_SRC"."SHTXCT" AS "SHTXCT"
			, "SAT_SRC"."SHATXT" AS "SHATXT"
			, "SAT_SRC"."SHPRIO" AS "SHPRIO"
			, "SAT_SRC"."SHBACK" AS "SHBACK"
			, "SAT_SRC"."SHSBAL" AS "SHSBAL"
			, "SAT_SRC"."SHHOLD" AS "SHHOLD"
			, "SAT_SRC"."SHPLST" AS "SHPLST"
			, "SAT_SRC"."SHINVC" AS "SHINVC"
			, "SAT_SRC"."SHNTR" AS "SHNTR"
			, "SAT_SRC"."SHANBY" AS "SHANBY"
			, "SAT_SRC"."SHCARS" AS "SHCARS"
			, "SAT_SRC"."SHMOT" AS "SHMOT"
			, "SAT_SRC"."SHCOT" AS "SHCOT"
			, "SAT_SRC"."SHROUT" AS "SHROUT"
			, "SAT_SRC"."SHSTOP" AS "SHSTOP"
			, "SAT_SRC"."SHZON" AS "SHZON"
			, "SAT_SRC"."SHCNID" AS "SHCNID"
			, "SAT_SRC"."SHFRTH" AS "SHFRTH"
			, "SAT_SRC"."SHAFT" AS "SHAFT"
			, "SAT_SRC"."SHFUF1" AS "SHFUF1"
			, "SAT_SRC"."SHFRTC" AS "SHFRTC"
			, "SAT_SRC"."SHMORD" AS "SHMORD"
			, "SAT_SRC"."SHRCD" AS "SHRCD"
			, "SAT_SRC"."SHFUF2" AS "SHFUF2"
			, "SAT_SRC"."SHOTOT" AS "SHOTOT"
			, "SAT_SRC"."SHTOTC" AS "SHTOTC"
			, "SAT_SRC"."SHWUMD" AS "SHWUMD"
			, "SAT_SRC"."SHVUMD" AS "SHVUMD"
			, "SAT_SRC"."SHAUTN" AS "SHAUTN"
			, "SAT_SRC"."SHCACT" AS "SHCACT"
			, "SAT_SRC"."SHCEXP" AS "SHCEXP"
			, "SAT_SRC"."SHSBLI" AS "SHSBLI"
			, "SAT_SRC"."SHCRMD" AS "SHCRMD"
			, "SAT_SRC"."SHCRRM" AS "SHCRRM"
			, "SAT_SRC"."SHCRCD" AS "SHCRCD"
			, "SAT_SRC"."SHCRR" AS "SHCRR"
			, "SAT_SRC"."SHLNGP" AS "SHLNGP"
			, "SAT_SRC"."SHFAP" AS "SHFAP"
			, "SAT_SRC"."SHFCST" AS "SHFCST"
			, "SAT_SRC"."SHORBY" AS "SHORBY"
			, "SAT_SRC"."SHTKBY" AS "SHTKBY"
			, "SAT_SRC"."SHURCD" AS "SHURCD"
			, "SAT_SRC"."SHURDT" AS "SHURDT"
			, "SAT_SRC"."SHURAT" AS "SHURAT"
			, "SAT_SRC"."SHURAB" AS "SHURAB"
			, "SAT_SRC"."SHURRF" AS "SHURRF"
			, "SAT_SRC"."SHUSER" AS "SHUSER"
			, "SAT_SRC"."SHPID" AS "SHPID"
			, "SAT_SRC"."SHJOBN" AS "SHJOBN"
			, "SAT_SRC"."SHUPMJ" AS "SHUPMJ"
			, "SAT_SRC"."SHTDAY" AS "SHTDAY"
			, "SAT_SRC"."SHIR01" AS "SHIR01"
			, "SAT_SRC"."SHIR02" AS "SHIR02"
			, "SAT_SRC"."SHIR03" AS "SHIR03"
			, "SAT_SRC"."SHIR04" AS "SHIR04"
			, "SAT_SRC"."SHIR05" AS "SHIR05"
			, "SAT_SRC"."SHVR03" AS "SHVR03"
			, "SAT_SRC"."SHSOOR" AS "SHSOOR"
			, "SAT_SRC"."SHPMDT" AS "SHPMDT"
			, "SAT_SRC"."SHRSDT" AS "SHRSDT"
			, "SAT_SRC"."SHRQSJ" AS "SHRQSJ"
			, "SAT_SRC"."SHPSTM" AS "SHPSTM"
			, "SAT_SRC"."SHPDTT" AS "SHPDTT"
			, "SAT_SRC"."SHOPTT" AS "SHOPTT"
			, "SAT_SRC"."SHDRQT" AS "SHDRQT"
			, "SAT_SRC"."SHADTM" AS "SHADTM"
			, "SAT_SRC"."SHADLJ" AS "SHADLJ"
			, "SAT_SRC"."SHPBAN" AS "SHPBAN"
			, "SAT_SRC"."SHITAN" AS "SHITAN"
			, "SAT_SRC"."SHFTAN" AS "SHFTAN"
			, "SAT_SRC"."SHDVAN" AS "SHDVAN"
			, "SAT_SRC"."SHDOC1" AS "SHDOC1"
			, "SAT_SRC"."SHDCT4" AS "SHDCT4"
			, "SAT_SRC"."SHCORD" AS "SHCORD"
			, "SAT_SRC"."SHBSC" AS "SHBSC"
			, "SAT_SRC"."SHBCRC" AS "SHBCRC"
			, "SAT_SRC"."SHAUFT" AS "SHAUFT"
			, "SAT_SRC"."SHAUFI" AS "SHAUFI"
			, "SAT_SRC"."SHOPBO" AS "SHOPBO"
			, "SAT_SRC"."SHOPTC" AS "SHOPTC"
			, "SAT_SRC"."SHOPLD" AS "SHOPLD"
			, "SAT_SRC"."SHOPBK" AS "SHOPBK"
			, "SAT_SRC"."SHOPSB" AS "SHOPSB"
			, "SAT_SRC"."SHOPPS" AS "SHOPPS"
			, "SAT_SRC"."SHOPPL" AS "SHOPPL"
			, "SAT_SRC"."SHOPMS" AS "SHOPMS"
			, "SAT_SRC"."SHOPSS" AS "SHOPSS"
			, "SAT_SRC"."SHOPBA" AS "SHOPBA"
			, "SAT_SRC"."SHOPLL" AS "SHOPLL"
			, "SAT_SRC"."SHPRAN8" AS "SHPRAN8"
			, "SAT_SRC"."SHOPPID" AS "SHOPPID"
			, "SAT_SRC"."SHSDATTN" AS "SHSDATTN"
			, "SAT_SRC"."SHSPATTN" AS "SHSPATTN"
			, "SAT_SRC"."SHOTIND" AS "SHOTIND"
			, "SAT_SRC"."SHPRCIDLN" AS "SHPRCIDLN"
			, "SAT_SRC"."SHCCIDLN" AS "SHCCIDLN"
			, "SAT_SRC"."SHSHCCIDLN" AS "SHSHCCIDLN"
		FROM {{ source('DEMO_FL', 'SAT_JDE_SALESORDERHEADERHISTORY') }} "SAT_SRC"
		INNER JOIN "DIST_STG" "DIST_STG" ON  "SAT_SRC"."SALESORDERHEADERHISTORY_HKEY" = "DIST_STG"."SALESORDERHEADERHISTORY_HKEY"
		WHERE  "SAT_SRC"."LOAD_END_DATE" = TO_TIMESTAMP('31/12/2999 23:59:59' , 'DD/MM/YYYY HH24:MI:SS')
	)
	SELECT 
		  "TEMP_TABLE_SET"."SALESORDERHEADERHISTORY_HKEY" AS "SALESORDERHEADERHISTORY_HKEY"
		, "TEMP_TABLE_SET"."LOAD_DATE" AS "LOAD_DATE"
		, "TEMP_TABLE_SET"."LOAD_END_DATE" AS "LOAD_END_DATE"
		, "TEMP_TABLE_SET"."LOAD_CYCLE_ID" AS "LOAD_CYCLE_ID"
		, "TEMP_TABLE_SET"."RECORD_TYPE" AS "RECORD_TYPE"
		, "TEMP_TABLE_SET"."SOURCE" AS "SOURCE"
		, CASE WHEN "TEMP_TABLE_SET"."SOURCE" = 'STG' AND TO_CHAR("TEMP_TABLE_SET"."DELETE_FLAG") || TO_CHAR("TEMP_TABLE_SET"."HASH_DIFF")
			= LAG( TO_CHAR("TEMP_TABLE_SET"."DELETE_FLAG") || TO_CHAR("TEMP_TABLE_SET"."HASH_DIFF"),1)OVER(PARTITION BY "TEMP_TABLE_SET"."SALESORDERHEADERHISTORY_HKEY" ORDER BY "TEMP_TABLE_SET"."LOAD_DATE","TEMP_TABLE_SET"."ORIGIN_ID")THEN 1 ELSE 0 END AS "EQUAL"
		, "TEMP_TABLE_SET"."HASH_DIFF" AS "HASH_DIFF"
		, "TEMP_TABLE_SET"."DELETE_FLAG" AS "DELETE_FLAG"
		, "TEMP_TABLE_SET"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP"
		, "TEMP_TABLE_SET"."SHKCOO" AS "SHKCOO"
		, "TEMP_TABLE_SET"."SHDOCO" AS "SHDOCO"
		, "TEMP_TABLE_SET"."SHDCTO" AS "SHDCTO"
		, "TEMP_TABLE_SET"."SHMCU" AS "SHMCU"
		, "TEMP_TABLE_SET"."SHAN8" AS "SHAN8"
		, "TEMP_TABLE_SET"."SHSFXO" AS "SHSFXO"
		, "TEMP_TABLE_SET"."SHCO" AS "SHCO"
		, "TEMP_TABLE_SET"."SHOKCO" AS "SHOKCO"
		, "TEMP_TABLE_SET"."SHOORN" AS "SHOORN"
		, "TEMP_TABLE_SET"."SHOCTO" AS "SHOCTO"
		, "TEMP_TABLE_SET"."SHRKCO" AS "SHRKCO"
		, "TEMP_TABLE_SET"."SHRORN" AS "SHRORN"
		, "TEMP_TABLE_SET"."SHRCTO" AS "SHRCTO"
		, "TEMP_TABLE_SET"."SHSHAN" AS "SHSHAN"
		, "TEMP_TABLE_SET"."SHPA8" AS "SHPA8"
		, "TEMP_TABLE_SET"."SHDRQJ" AS "SHDRQJ"
		, "TEMP_TABLE_SET"."SHTRDJ" AS "SHTRDJ"
		, "TEMP_TABLE_SET"."SHPDDJ" AS "SHPDDJ"
		, "TEMP_TABLE_SET"."SHOPDJ" AS "SHOPDJ"
		, "TEMP_TABLE_SET"."SHADDJ" AS "SHADDJ"
		, "TEMP_TABLE_SET"."SHCNDJ" AS "SHCNDJ"
		, "TEMP_TABLE_SET"."SHPEFJ" AS "SHPEFJ"
		, "TEMP_TABLE_SET"."SHPPDJ" AS "SHPPDJ"
		, "TEMP_TABLE_SET"."SHVR01" AS "SHVR01"
		, "TEMP_TABLE_SET"."SHVR02" AS "SHVR02"
		, "TEMP_TABLE_SET"."SHDEL1" AS "SHDEL1"
		, "TEMP_TABLE_SET"."SHDEL2" AS "SHDEL2"
		, "TEMP_TABLE_SET"."SHINMG" AS "SHINMG"
		, "TEMP_TABLE_SET"."SHPTC" AS "SHPTC"
		, "TEMP_TABLE_SET"."SHRYIN" AS "SHRYIN"
		, "TEMP_TABLE_SET"."SHASN" AS "SHASN"
		, "TEMP_TABLE_SET"."SHPRGP" AS "SHPRGP"
		, "TEMP_TABLE_SET"."SHTRDC" AS "SHTRDC"
		, "TEMP_TABLE_SET"."SHPCRT" AS "SHPCRT"
		, "TEMP_TABLE_SET"."SHTXA1" AS "SHTXA1"
		, "TEMP_TABLE_SET"."SHEXR1" AS "SHEXR1"
		, "TEMP_TABLE_SET"."SHTXCT" AS "SHTXCT"
		, "TEMP_TABLE_SET"."SHATXT" AS "SHATXT"
		, "TEMP_TABLE_SET"."SHPRIO" AS "SHPRIO"
		, "TEMP_TABLE_SET"."SHBACK" AS "SHBACK"
		, "TEMP_TABLE_SET"."SHSBAL" AS "SHSBAL"
		, "TEMP_TABLE_SET"."SHHOLD" AS "SHHOLD"
		, "TEMP_TABLE_SET"."SHPLST" AS "SHPLST"
		, "TEMP_TABLE_SET"."SHINVC" AS "SHINVC"
		, "TEMP_TABLE_SET"."SHNTR" AS "SHNTR"
		, "TEMP_TABLE_SET"."SHANBY" AS "SHANBY"
		, "TEMP_TABLE_SET"."SHCARS" AS "SHCARS"
		, "TEMP_TABLE_SET"."SHMOT" AS "SHMOT"
		, "TEMP_TABLE_SET"."SHCOT" AS "SHCOT"
		, "TEMP_TABLE_SET"."SHROUT" AS "SHROUT"
		, "TEMP_TABLE_SET"."SHSTOP" AS "SHSTOP"
		, "TEMP_TABLE_SET"."SHZON" AS "SHZON"
		, "TEMP_TABLE_SET"."SHCNID" AS "SHCNID"
		, "TEMP_TABLE_SET"."SHFRTH" AS "SHFRTH"
		, "TEMP_TABLE_SET"."SHAFT" AS "SHAFT"
		, "TEMP_TABLE_SET"."SHFUF1" AS "SHFUF1"
		, "TEMP_TABLE_SET"."SHFRTC" AS "SHFRTC"
		, "TEMP_TABLE_SET"."SHMORD" AS "SHMORD"
		, "TEMP_TABLE_SET"."SHRCD" AS "SHRCD"
		, "TEMP_TABLE_SET"."SHFUF2" AS "SHFUF2"
		, "TEMP_TABLE_SET"."SHOTOT" AS "SHOTOT"
		, "TEMP_TABLE_SET"."SHTOTC" AS "SHTOTC"
		, "TEMP_TABLE_SET"."SHWUMD" AS "SHWUMD"
		, "TEMP_TABLE_SET"."SHVUMD" AS "SHVUMD"
		, "TEMP_TABLE_SET"."SHAUTN" AS "SHAUTN"
		, "TEMP_TABLE_SET"."SHCACT" AS "SHCACT"
		, "TEMP_TABLE_SET"."SHCEXP" AS "SHCEXP"
		, "TEMP_TABLE_SET"."SHSBLI" AS "SHSBLI"
		, "TEMP_TABLE_SET"."SHCRMD" AS "SHCRMD"
		, "TEMP_TABLE_SET"."SHCRRM" AS "SHCRRM"
		, "TEMP_TABLE_SET"."SHCRCD" AS "SHCRCD"
		, "TEMP_TABLE_SET"."SHCRR" AS "SHCRR"
		, "TEMP_TABLE_SET"."SHLNGP" AS "SHLNGP"
		, "TEMP_TABLE_SET"."SHFAP" AS "SHFAP"
		, "TEMP_TABLE_SET"."SHFCST" AS "SHFCST"
		, "TEMP_TABLE_SET"."SHORBY" AS "SHORBY"
		, "TEMP_TABLE_SET"."SHTKBY" AS "SHTKBY"
		, "TEMP_TABLE_SET"."SHURCD" AS "SHURCD"
		, "TEMP_TABLE_SET"."SHURDT" AS "SHURDT"
		, "TEMP_TABLE_SET"."SHURAT" AS "SHURAT"
		, "TEMP_TABLE_SET"."SHURAB" AS "SHURAB"
		, "TEMP_TABLE_SET"."SHURRF" AS "SHURRF"
		, "TEMP_TABLE_SET"."SHUSER" AS "SHUSER"
		, "TEMP_TABLE_SET"."SHPID" AS "SHPID"
		, "TEMP_TABLE_SET"."SHJOBN" AS "SHJOBN"
		, "TEMP_TABLE_SET"."SHUPMJ" AS "SHUPMJ"
		, "TEMP_TABLE_SET"."SHTDAY" AS "SHTDAY"
		, "TEMP_TABLE_SET"."SHIR01" AS "SHIR01"
		, "TEMP_TABLE_SET"."SHIR02" AS "SHIR02"
		, "TEMP_TABLE_SET"."SHIR03" AS "SHIR03"
		, "TEMP_TABLE_SET"."SHIR04" AS "SHIR04"
		, "TEMP_TABLE_SET"."SHIR05" AS "SHIR05"
		, "TEMP_TABLE_SET"."SHVR03" AS "SHVR03"
		, "TEMP_TABLE_SET"."SHSOOR" AS "SHSOOR"
		, "TEMP_TABLE_SET"."SHPMDT" AS "SHPMDT"
		, "TEMP_TABLE_SET"."SHRSDT" AS "SHRSDT"
		, "TEMP_TABLE_SET"."SHRQSJ" AS "SHRQSJ"
		, "TEMP_TABLE_SET"."SHPSTM" AS "SHPSTM"
		, "TEMP_TABLE_SET"."SHPDTT" AS "SHPDTT"
		, "TEMP_TABLE_SET"."SHOPTT" AS "SHOPTT"
		, "TEMP_TABLE_SET"."SHDRQT" AS "SHDRQT"
		, "TEMP_TABLE_SET"."SHADTM" AS "SHADTM"
		, "TEMP_TABLE_SET"."SHADLJ" AS "SHADLJ"
		, "TEMP_TABLE_SET"."SHPBAN" AS "SHPBAN"
		, "TEMP_TABLE_SET"."SHITAN" AS "SHITAN"
		, "TEMP_TABLE_SET"."SHFTAN" AS "SHFTAN"
		, "TEMP_TABLE_SET"."SHDVAN" AS "SHDVAN"
		, "TEMP_TABLE_SET"."SHDOC1" AS "SHDOC1"
		, "TEMP_TABLE_SET"."SHDCT4" AS "SHDCT4"
		, "TEMP_TABLE_SET"."SHCORD" AS "SHCORD"
		, "TEMP_TABLE_SET"."SHBSC" AS "SHBSC"
		, "TEMP_TABLE_SET"."SHBCRC" AS "SHBCRC"
		, "TEMP_TABLE_SET"."SHAUFT" AS "SHAUFT"
		, "TEMP_TABLE_SET"."SHAUFI" AS "SHAUFI"
		, "TEMP_TABLE_SET"."SHOPBO" AS "SHOPBO"
		, "TEMP_TABLE_SET"."SHOPTC" AS "SHOPTC"
		, "TEMP_TABLE_SET"."SHOPLD" AS "SHOPLD"
		, "TEMP_TABLE_SET"."SHOPBK" AS "SHOPBK"
		, "TEMP_TABLE_SET"."SHOPSB" AS "SHOPSB"
		, "TEMP_TABLE_SET"."SHOPPS" AS "SHOPPS"
		, "TEMP_TABLE_SET"."SHOPPL" AS "SHOPPL"
		, "TEMP_TABLE_SET"."SHOPMS" AS "SHOPMS"
		, "TEMP_TABLE_SET"."SHOPSS" AS "SHOPSS"
		, "TEMP_TABLE_SET"."SHOPBA" AS "SHOPBA"
		, "TEMP_TABLE_SET"."SHOPLL" AS "SHOPLL"
		, "TEMP_TABLE_SET"."SHPRAN8" AS "SHPRAN8"
		, "TEMP_TABLE_SET"."SHOPPID" AS "SHOPPID"
		, "TEMP_TABLE_SET"."SHSDATTN" AS "SHSDATTN"
		, "TEMP_TABLE_SET"."SHSPATTN" AS "SHSPATTN"
		, "TEMP_TABLE_SET"."SHOTIND" AS "SHOTIND"
		, "TEMP_TABLE_SET"."SHPRCIDLN" AS "SHPRCIDLN"
		, "TEMP_TABLE_SET"."SHCCIDLN" AS "SHCCIDLN"
		, "TEMP_TABLE_SET"."SHSHCCIDLN" AS "SHSHCCIDLN"
	FROM "TEMP_TABLE_SET" "TEMP_TABLE_SET"

) final 
where '{{ var("load_type") }}' = 'INCR' and '{{ var("source") }}' = 'JDEDWARDS'