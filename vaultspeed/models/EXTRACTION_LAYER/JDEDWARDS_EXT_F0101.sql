{{
	config(
		materialized='incremental',
		pre_hook= [
			'{% if var("load_type") == "INCR" and var("source") == "JDEDWARDS" %} TRUNCATE TABLE {{ this }}; {% endif %}',
			'{% if var("load_type") == "INIT" and var("source") == "JDEDWARDS" %} TRUNCATE TABLE {{ this }}; {% endif %}'
		],
		alias='F0101',
		schema='JDEDWARDS_EXT',
		tags=['JDEDWARDS', 'EXT_JDE_ADDRESSBOOK_INCR', 'EXT_JDE_ADDRESSBOOK_INIT']
	)
}}
select * from (
	WITH "CALCULATE_BK" AS 
	( 
		SELECT 
			  "LCI_SRC"."LOAD_CYCLE_ID" AS "LOAD_CYCLE_ID"
			, DATEADD(microsecond, 2*row_number() over (order by "TDFV_SRC"."CDC_TIMESTAMP"),
				TO_TIMESTAMP_NTZ(CURRENT_TIMESTAMP()))   AS "LOAD_DATE"
			, "TDFV_SRC"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP"
			, COALESCE("TDFV_SRC"."JRN_FLAG","MEX_SRC"."ATTRIBUTE_VARCHAR") AS "JRN_FLAG"
			, "TDFV_SRC"."RECORD_TYPE" AS "RECORD_TYPE"
			, "TDFV_SRC"."ABAN8" AS "ABAN8"
			, "TDFV_SRC"."ABMCU" AS "ABMCU"
			, COALESCE(UPPER( TO_CHAR("TDFV_SRC"."ABAN8")),"MEX_SRC"."KEY_ATTRIBUTE_FLOAT") AS "ABAN8_BK"
			, REPLACE(TRIM( "TDFV_SRC"."ABMCU"),'\#','\\' || '\#') AS "MCMCU_FK_ABMCU_BK"
			, "TDFV_SRC"."ABALKY" AS "ABALKY"
			, "TDFV_SRC"."ABTAX" AS "ABTAX"
			, "TDFV_SRC"."ABALPH" AS "ABALPH"
			, "TDFV_SRC"."ABDC" AS "ABDC"
			, "TDFV_SRC"."ABSIC" AS "ABSIC"
			, "TDFV_SRC"."ABLNGP" AS "ABLNGP"
			, "TDFV_SRC"."ABAT1" AS "ABAT1"
			, "TDFV_SRC"."ABCM" AS "ABCM"
			, "TDFV_SRC"."ABTAXC" AS "ABTAXC"
			, "TDFV_SRC"."ABAT2" AS "ABAT2"
			, "TDFV_SRC"."ABAT3" AS "ABAT3"
			, "TDFV_SRC"."ABAT4" AS "ABAT4"
			, "TDFV_SRC"."ABAT5" AS "ABAT5"
			, "TDFV_SRC"."ABATP" AS "ABATP"
			, "TDFV_SRC"."ABATR" AS "ABATR"
			, "TDFV_SRC"."ABATPR" AS "ABATPR"
			, "TDFV_SRC"."ABAB3" AS "ABAB3"
			, "TDFV_SRC"."ABATE" AS "ABATE"
			, "TDFV_SRC"."ABSBLI" AS "ABSBLI"
			, "TDFV_SRC"."ABEFTB" AS "ABEFTB"
			, "TDFV_SRC"."ABAN81" AS "ABAN81"
			, "TDFV_SRC"."ABAN82" AS "ABAN82"
			, "TDFV_SRC"."ABAN83" AS "ABAN83"
			, "TDFV_SRC"."ABAN84" AS "ABAN84"
			, "TDFV_SRC"."ABAN86" AS "ABAN86"
			, "TDFV_SRC"."ABAN85" AS "ABAN85"
			, "TDFV_SRC"."ABAC01" AS "ABAC01"
			, "TDFV_SRC"."ABAC02" AS "ABAC02"
			, "TDFV_SRC"."ABAC03" AS "ABAC03"
			, "TDFV_SRC"."ABAC04" AS "ABAC04"
			, "TDFV_SRC"."ABAC05" AS "ABAC05"
			, "TDFV_SRC"."ABAC06" AS "ABAC06"
			, "TDFV_SRC"."ABAC07" AS "ABAC07"
			, "TDFV_SRC"."ABAC08" AS "ABAC08"
			, "TDFV_SRC"."ABAC09" AS "ABAC09"
			, "TDFV_SRC"."ABAC10" AS "ABAC10"
			, "TDFV_SRC"."ABAC11" AS "ABAC11"
			, "TDFV_SRC"."ABAC12" AS "ABAC12"
			, "TDFV_SRC"."ABAC13" AS "ABAC13"
			, "TDFV_SRC"."ABAC14" AS "ABAC14"
			, "TDFV_SRC"."ABAC15" AS "ABAC15"
			, "TDFV_SRC"."ABAC16" AS "ABAC16"
			, "TDFV_SRC"."ABAC17" AS "ABAC17"
			, "TDFV_SRC"."ABAC18" AS "ABAC18"
			, "TDFV_SRC"."ABAC19" AS "ABAC19"
			, "TDFV_SRC"."ABAC20" AS "ABAC20"
			, "TDFV_SRC"."ABAC21" AS "ABAC21"
			, "TDFV_SRC"."ABAC22" AS "ABAC22"
			, "TDFV_SRC"."ABAC23" AS "ABAC23"
			, "TDFV_SRC"."ABAC24" AS "ABAC24"
			, "TDFV_SRC"."ABAC25" AS "ABAC25"
			, "TDFV_SRC"."ABAC26" AS "ABAC26"
			, "TDFV_SRC"."ABAC27" AS "ABAC27"
			, "TDFV_SRC"."ABAC28" AS "ABAC28"
			, "TDFV_SRC"."ABAC29" AS "ABAC29"
			, "TDFV_SRC"."ABAC30" AS "ABAC30"
			, "TDFV_SRC"."ABGLBA" AS "ABGLBA"
			, "TDFV_SRC"."ABPTI" AS "ABPTI"
			, "TDFV_SRC"."ABPDI" AS "ABPDI"
			, "TDFV_SRC"."ABMSGA" AS "ABMSGA"
			, "TDFV_SRC"."ABRMK" AS "ABRMK"
			, "TDFV_SRC"."ABTXCT" AS "ABTXCT"
			, "TDFV_SRC"."ABTX2" AS "ABTX2"
			, "TDFV_SRC"."ABALP1" AS "ABALP1"
			, "TDFV_SRC"."ABURCD" AS "ABURCD"
			, "TDFV_SRC"."ABURDT" AS "ABURDT"
			, "TDFV_SRC"."ABURAT" AS "ABURAT"
			, "TDFV_SRC"."ABURAB" AS "ABURAB"
			, "TDFV_SRC"."ABURRF" AS "ABURRF"
			, "TDFV_SRC"."ABUSER" AS "ABUSER"
			, "TDFV_SRC"."ABPID" AS "ABPID"
			, "TDFV_SRC"."ABUPMJ" AS "ABUPMJ"
			, "TDFV_SRC"."ABJOBN" AS "ABJOBN"
			, "TDFV_SRC"."ABUPMT" AS "ABUPMT"
			, "TDFV_SRC"."ABPRGF" AS "ABPRGF"
			, "TDFV_SRC"."ABSCCLTP" AS "ABSCCLTP"
			, "TDFV_SRC"."ABTICKER" AS "ABTICKER"
			, "TDFV_SRC"."ABEXCHG" AS "ABEXCHG"
			, "TDFV_SRC"."ABDUNS" AS "ABDUNS"
			, "TDFV_SRC"."ABCLASS01" AS "ABCLASS01"
			, "TDFV_SRC"."ABCLASS02" AS "ABCLASS02"
			, "TDFV_SRC"."ABCLASS03" AS "ABCLASS03"
			, "TDFV_SRC"."ABCLASS04" AS "ABCLASS04"
			, "TDFV_SRC"."ABCLASS05" AS "ABCLASS05"
			, "TDFV_SRC"."ABNOE" AS "ABNOE"
			, "TDFV_SRC"."ABGROWTHR" AS "ABGROWTHR"
			, "TDFV_SRC"."ABYEARSTAR" AS "ABYEARSTAR"
			, "TDFV_SRC"."ABAEMPGP" AS "ABAEMPGP"
			, "TDFV_SRC"."ABACTIN" AS "ABACTIN"
			, "TDFV_SRC"."ABREVRNG" AS "ABREVRNG"
			, "TDFV_SRC"."ABSYNCS" AS "ABSYNCS"
			, "TDFV_SRC"."ABPERRS" AS "ABPERRS"
			, "TDFV_SRC"."ABCAAD" AS "ABCAAD"
		FROM {{ ref('JDEDWARDS_DFV_VW_F0101') }} "TDFV_SRC"
		INNER JOIN {{ source('JDEDWARDS_MTD', 'LOAD_CYCLE_INFO') }} "LCI_SRC" ON  1 = 1
		INNER JOIN {{ source('JDEDWARDS_MTD', 'MTD_EXCEPTION_RECORDS') }} "MEX_SRC" ON  1 = 1
		WHERE  "MEX_SRC"."RECORD_TYPE" = 'N'
	)
	, "EXT_UNION" AS 
	( 
		SELECT 
			  "CALCULATE_BK"."LOAD_CYCLE_ID" AS "LOAD_CYCLE_ID"
			, "CALCULATE_BK"."LOAD_DATE" AS "LOAD_DATE"
			, "CALCULATE_BK"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP"
			, "CALCULATE_BK"."JRN_FLAG" AS "JRN_FLAG"
			, "CALCULATE_BK"."RECORD_TYPE" AS "RECORD_TYPE"
			, "CALCULATE_BK"."ABAN8" AS "ABAN8"
			, "CALCULATE_BK"."ABMCU" AS "ABMCU"
			, "CALCULATE_BK"."ABAN8_BK" AS "ABAN8_BK"
			, "CALCULATE_BK"."MCMCU_FK_ABMCU_BK" AS "MCMCU_FK_ABMCU_BK"
			, "CALCULATE_BK"."ABALKY" AS "ABALKY"
			, "CALCULATE_BK"."ABTAX" AS "ABTAX"
			, "CALCULATE_BK"."ABALPH" AS "ABALPH"
			, "CALCULATE_BK"."ABDC" AS "ABDC"
			, "CALCULATE_BK"."ABSIC" AS "ABSIC"
			, "CALCULATE_BK"."ABLNGP" AS "ABLNGP"
			, "CALCULATE_BK"."ABAT1" AS "ABAT1"
			, "CALCULATE_BK"."ABCM" AS "ABCM"
			, "CALCULATE_BK"."ABTAXC" AS "ABTAXC"
			, "CALCULATE_BK"."ABAT2" AS "ABAT2"
			, "CALCULATE_BK"."ABAT3" AS "ABAT3"
			, "CALCULATE_BK"."ABAT4" AS "ABAT4"
			, "CALCULATE_BK"."ABAT5" AS "ABAT5"
			, "CALCULATE_BK"."ABATP" AS "ABATP"
			, "CALCULATE_BK"."ABATR" AS "ABATR"
			, "CALCULATE_BK"."ABATPR" AS "ABATPR"
			, "CALCULATE_BK"."ABAB3" AS "ABAB3"
			, "CALCULATE_BK"."ABATE" AS "ABATE"
			, "CALCULATE_BK"."ABSBLI" AS "ABSBLI"
			, "CALCULATE_BK"."ABEFTB" AS "ABEFTB"
			, "CALCULATE_BK"."ABAN81" AS "ABAN81"
			, "CALCULATE_BK"."ABAN82" AS "ABAN82"
			, "CALCULATE_BK"."ABAN83" AS "ABAN83"
			, "CALCULATE_BK"."ABAN84" AS "ABAN84"
			, "CALCULATE_BK"."ABAN86" AS "ABAN86"
			, "CALCULATE_BK"."ABAN85" AS "ABAN85"
			, "CALCULATE_BK"."ABAC01" AS "ABAC01"
			, "CALCULATE_BK"."ABAC02" AS "ABAC02"
			, "CALCULATE_BK"."ABAC03" AS "ABAC03"
			, "CALCULATE_BK"."ABAC04" AS "ABAC04"
			, "CALCULATE_BK"."ABAC05" AS "ABAC05"
			, "CALCULATE_BK"."ABAC06" AS "ABAC06"
			, "CALCULATE_BK"."ABAC07" AS "ABAC07"
			, "CALCULATE_BK"."ABAC08" AS "ABAC08"
			, "CALCULATE_BK"."ABAC09" AS "ABAC09"
			, "CALCULATE_BK"."ABAC10" AS "ABAC10"
			, "CALCULATE_BK"."ABAC11" AS "ABAC11"
			, "CALCULATE_BK"."ABAC12" AS "ABAC12"
			, "CALCULATE_BK"."ABAC13" AS "ABAC13"
			, "CALCULATE_BK"."ABAC14" AS "ABAC14"
			, "CALCULATE_BK"."ABAC15" AS "ABAC15"
			, "CALCULATE_BK"."ABAC16" AS "ABAC16"
			, "CALCULATE_BK"."ABAC17" AS "ABAC17"
			, "CALCULATE_BK"."ABAC18" AS "ABAC18"
			, "CALCULATE_BK"."ABAC19" AS "ABAC19"
			, "CALCULATE_BK"."ABAC20" AS "ABAC20"
			, "CALCULATE_BK"."ABAC21" AS "ABAC21"
			, "CALCULATE_BK"."ABAC22" AS "ABAC22"
			, "CALCULATE_BK"."ABAC23" AS "ABAC23"
			, "CALCULATE_BK"."ABAC24" AS "ABAC24"
			, "CALCULATE_BK"."ABAC25" AS "ABAC25"
			, "CALCULATE_BK"."ABAC26" AS "ABAC26"
			, "CALCULATE_BK"."ABAC27" AS "ABAC27"
			, "CALCULATE_BK"."ABAC28" AS "ABAC28"
			, "CALCULATE_BK"."ABAC29" AS "ABAC29"
			, "CALCULATE_BK"."ABAC30" AS "ABAC30"
			, "CALCULATE_BK"."ABGLBA" AS "ABGLBA"
			, "CALCULATE_BK"."ABPTI" AS "ABPTI"
			, "CALCULATE_BK"."ABPDI" AS "ABPDI"
			, "CALCULATE_BK"."ABMSGA" AS "ABMSGA"
			, "CALCULATE_BK"."ABRMK" AS "ABRMK"
			, "CALCULATE_BK"."ABTXCT" AS "ABTXCT"
			, "CALCULATE_BK"."ABTX2" AS "ABTX2"
			, "CALCULATE_BK"."ABALP1" AS "ABALP1"
			, "CALCULATE_BK"."ABURCD" AS "ABURCD"
			, "CALCULATE_BK"."ABURDT" AS "ABURDT"
			, "CALCULATE_BK"."ABURAT" AS "ABURAT"
			, "CALCULATE_BK"."ABURAB" AS "ABURAB"
			, "CALCULATE_BK"."ABURRF" AS "ABURRF"
			, "CALCULATE_BK"."ABUSER" AS "ABUSER"
			, "CALCULATE_BK"."ABPID" AS "ABPID"
			, "CALCULATE_BK"."ABUPMJ" AS "ABUPMJ"
			, "CALCULATE_BK"."ABJOBN" AS "ABJOBN"
			, "CALCULATE_BK"."ABUPMT" AS "ABUPMT"
			, "CALCULATE_BK"."ABPRGF" AS "ABPRGF"
			, "CALCULATE_BK"."ABSCCLTP" AS "ABSCCLTP"
			, "CALCULATE_BK"."ABTICKER" AS "ABTICKER"
			, "CALCULATE_BK"."ABEXCHG" AS "ABEXCHG"
			, "CALCULATE_BK"."ABDUNS" AS "ABDUNS"
			, "CALCULATE_BK"."ABCLASS01" AS "ABCLASS01"
			, "CALCULATE_BK"."ABCLASS02" AS "ABCLASS02"
			, "CALCULATE_BK"."ABCLASS03" AS "ABCLASS03"
			, "CALCULATE_BK"."ABCLASS04" AS "ABCLASS04"
			, "CALCULATE_BK"."ABCLASS05" AS "ABCLASS05"
			, "CALCULATE_BK"."ABNOE" AS "ABNOE"
			, "CALCULATE_BK"."ABGROWTHR" AS "ABGROWTHR"
			, "CALCULATE_BK"."ABYEARSTAR" AS "ABYEARSTAR"
			, "CALCULATE_BK"."ABAEMPGP" AS "ABAEMPGP"
			, "CALCULATE_BK"."ABACTIN" AS "ABACTIN"
			, "CALCULATE_BK"."ABREVRNG" AS "ABREVRNG"
			, "CALCULATE_BK"."ABSYNCS" AS "ABSYNCS"
			, "CALCULATE_BK"."ABPERRS" AS "ABPERRS"
			, "CALCULATE_BK"."ABCAAD" AS "ABCAAD"
		FROM "CALCULATE_BK" "CALCULATE_BK"
	)
	SELECT 
		  "EXT_UNION"."LOAD_CYCLE_ID" AS "LOAD_CYCLE_ID"
		, "EXT_UNION"."LOAD_DATE" AS "LOAD_DATE"
		, "EXT_UNION"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP"
		, "EXT_UNION"."JRN_FLAG" AS "JRN_FLAG"
		, "EXT_UNION"."RECORD_TYPE" AS "RECORD_TYPE"
		, "EXT_UNION"."ABAN8" AS "ABAN8"
		, "EXT_UNION"."ABMCU" AS "ABMCU"
		, "EXT_UNION"."ABAN8_BK" AS "ABAN8_BK"
		, "EXT_UNION"."MCMCU_FK_ABMCU_BK" AS "MCMCU_FK_ABMCU_BK"
		, "EXT_UNION"."ABALKY" AS "ABALKY"
		, "EXT_UNION"."ABTAX" AS "ABTAX"
		, "EXT_UNION"."ABALPH" AS "ABALPH"
		, "EXT_UNION"."ABDC" AS "ABDC"
		, "EXT_UNION"."ABSIC" AS "ABSIC"
		, "EXT_UNION"."ABLNGP" AS "ABLNGP"
		, "EXT_UNION"."ABAT1" AS "ABAT1"
		, "EXT_UNION"."ABCM" AS "ABCM"
		, "EXT_UNION"."ABTAXC" AS "ABTAXC"
		, "EXT_UNION"."ABAT2" AS "ABAT2"
		, "EXT_UNION"."ABAT3" AS "ABAT3"
		, "EXT_UNION"."ABAT4" AS "ABAT4"
		, "EXT_UNION"."ABAT5" AS "ABAT5"
		, "EXT_UNION"."ABATP" AS "ABATP"
		, "EXT_UNION"."ABATR" AS "ABATR"
		, "EXT_UNION"."ABATPR" AS "ABATPR"
		, "EXT_UNION"."ABAB3" AS "ABAB3"
		, "EXT_UNION"."ABATE" AS "ABATE"
		, "EXT_UNION"."ABSBLI" AS "ABSBLI"
		, "EXT_UNION"."ABEFTB" AS "ABEFTB"
		, "EXT_UNION"."ABAN81" AS "ABAN81"
		, "EXT_UNION"."ABAN82" AS "ABAN82"
		, "EXT_UNION"."ABAN83" AS "ABAN83"
		, "EXT_UNION"."ABAN84" AS "ABAN84"
		, "EXT_UNION"."ABAN86" AS "ABAN86"
		, "EXT_UNION"."ABAN85" AS "ABAN85"
		, "EXT_UNION"."ABAC01" AS "ABAC01"
		, "EXT_UNION"."ABAC02" AS "ABAC02"
		, "EXT_UNION"."ABAC03" AS "ABAC03"
		, "EXT_UNION"."ABAC04" AS "ABAC04"
		, "EXT_UNION"."ABAC05" AS "ABAC05"
		, "EXT_UNION"."ABAC06" AS "ABAC06"
		, "EXT_UNION"."ABAC07" AS "ABAC07"
		, "EXT_UNION"."ABAC08" AS "ABAC08"
		, "EXT_UNION"."ABAC09" AS "ABAC09"
		, "EXT_UNION"."ABAC10" AS "ABAC10"
		, "EXT_UNION"."ABAC11" AS "ABAC11"
		, "EXT_UNION"."ABAC12" AS "ABAC12"
		, "EXT_UNION"."ABAC13" AS "ABAC13"
		, "EXT_UNION"."ABAC14" AS "ABAC14"
		, "EXT_UNION"."ABAC15" AS "ABAC15"
		, "EXT_UNION"."ABAC16" AS "ABAC16"
		, "EXT_UNION"."ABAC17" AS "ABAC17"
		, "EXT_UNION"."ABAC18" AS "ABAC18"
		, "EXT_UNION"."ABAC19" AS "ABAC19"
		, "EXT_UNION"."ABAC20" AS "ABAC20"
		, "EXT_UNION"."ABAC21" AS "ABAC21"
		, "EXT_UNION"."ABAC22" AS "ABAC22"
		, "EXT_UNION"."ABAC23" AS "ABAC23"
		, "EXT_UNION"."ABAC24" AS "ABAC24"
		, "EXT_UNION"."ABAC25" AS "ABAC25"
		, "EXT_UNION"."ABAC26" AS "ABAC26"
		, "EXT_UNION"."ABAC27" AS "ABAC27"
		, "EXT_UNION"."ABAC28" AS "ABAC28"
		, "EXT_UNION"."ABAC29" AS "ABAC29"
		, "EXT_UNION"."ABAC30" AS "ABAC30"
		, "EXT_UNION"."ABGLBA" AS "ABGLBA"
		, "EXT_UNION"."ABPTI" AS "ABPTI"
		, "EXT_UNION"."ABPDI" AS "ABPDI"
		, "EXT_UNION"."ABMSGA" AS "ABMSGA"
		, "EXT_UNION"."ABRMK" AS "ABRMK"
		, "EXT_UNION"."ABTXCT" AS "ABTXCT"
		, "EXT_UNION"."ABTX2" AS "ABTX2"
		, "EXT_UNION"."ABALP1" AS "ABALP1"
		, "EXT_UNION"."ABURCD" AS "ABURCD"
		, "EXT_UNION"."ABURDT" AS "ABURDT"
		, "EXT_UNION"."ABURAT" AS "ABURAT"
		, "EXT_UNION"."ABURAB" AS "ABURAB"
		, "EXT_UNION"."ABURRF" AS "ABURRF"
		, "EXT_UNION"."ABUSER" AS "ABUSER"
		, "EXT_UNION"."ABPID" AS "ABPID"
		, "EXT_UNION"."ABUPMJ" AS "ABUPMJ"
		, "EXT_UNION"."ABJOBN" AS "ABJOBN"
		, "EXT_UNION"."ABUPMT" AS "ABUPMT"
		, "EXT_UNION"."ABPRGF" AS "ABPRGF"
		, "EXT_UNION"."ABSCCLTP" AS "ABSCCLTP"
		, "EXT_UNION"."ABTICKER" AS "ABTICKER"
		, "EXT_UNION"."ABEXCHG" AS "ABEXCHG"
		, "EXT_UNION"."ABDUNS" AS "ABDUNS"
		, "EXT_UNION"."ABCLASS01" AS "ABCLASS01"
		, "EXT_UNION"."ABCLASS02" AS "ABCLASS02"
		, "EXT_UNION"."ABCLASS03" AS "ABCLASS03"
		, "EXT_UNION"."ABCLASS04" AS "ABCLASS04"
		, "EXT_UNION"."ABCLASS05" AS "ABCLASS05"
		, "EXT_UNION"."ABNOE" AS "ABNOE"
		, "EXT_UNION"."ABGROWTHR" AS "ABGROWTHR"
		, "EXT_UNION"."ABYEARSTAR" AS "ABYEARSTAR"
		, "EXT_UNION"."ABAEMPGP" AS "ABAEMPGP"
		, "EXT_UNION"."ABACTIN" AS "ABACTIN"
		, "EXT_UNION"."ABREVRNG" AS "ABREVRNG"
		, "EXT_UNION"."ABSYNCS" AS "ABSYNCS"
		, "EXT_UNION"."ABPERRS" AS "ABPERRS"
		, "EXT_UNION"."ABCAAD" AS "ABCAAD"
	FROM "EXT_UNION" "EXT_UNION"

) final 
where '{{ var("load_type") }}' = 'INCR' and '{{ var("source") }}' = 'JDEDWARDS'

UNION ALL

select * from (
	WITH "LOAD_INIT_DATA" AS 
	( 
		SELECT 
			  TO_CHAR('I' ) AS "JRN_FLAG"
			, TO_CHAR('S') AS "RECORD_TYPE"
			, COALESCE("INI_SRC"."ABAN8", CAST("MEX_INR_SRC"."KEY_ATTRIBUTE_FLOAT" AS FLOAT)) AS "ABAN8"
			, COALESCE("INI_SRC"."ABMCU", CAST("MEX_INR_SRC"."KEY_ATTRIBUTE_VARCHAR" AS VARCHAR)) AS "ABMCU"
			, "INI_SRC"."ABALKY" AS "ABALKY"
			, "INI_SRC"."ABTAX" AS "ABTAX"
			, "INI_SRC"."ABALPH" AS "ABALPH"
			, "INI_SRC"."ABDC" AS "ABDC"
			, "INI_SRC"."ABSIC" AS "ABSIC"
			, "INI_SRC"."ABLNGP" AS "ABLNGP"
			, "INI_SRC"."ABAT1" AS "ABAT1"
			, "INI_SRC"."ABCM" AS "ABCM"
			, "INI_SRC"."ABTAXC" AS "ABTAXC"
			, "INI_SRC"."ABAT2" AS "ABAT2"
			, "INI_SRC"."ABAT3" AS "ABAT3"
			, "INI_SRC"."ABAT4" AS "ABAT4"
			, "INI_SRC"."ABAT5" AS "ABAT5"
			, "INI_SRC"."ABATP" AS "ABATP"
			, "INI_SRC"."ABATR" AS "ABATR"
			, "INI_SRC"."ABATPR" AS "ABATPR"
			, "INI_SRC"."ABAB3" AS "ABAB3"
			, "INI_SRC"."ABATE" AS "ABATE"
			, "INI_SRC"."ABSBLI" AS "ABSBLI"
			, "INI_SRC"."ABEFTB" AS "ABEFTB"
			, "INI_SRC"."ABAN81" AS "ABAN81"
			, "INI_SRC"."ABAN82" AS "ABAN82"
			, "INI_SRC"."ABAN83" AS "ABAN83"
			, "INI_SRC"."ABAN84" AS "ABAN84"
			, "INI_SRC"."ABAN86" AS "ABAN86"
			, "INI_SRC"."ABAN85" AS "ABAN85"
			, "INI_SRC"."ABAC01" AS "ABAC01"
			, "INI_SRC"."ABAC02" AS "ABAC02"
			, "INI_SRC"."ABAC03" AS "ABAC03"
			, "INI_SRC"."ABAC04" AS "ABAC04"
			, "INI_SRC"."ABAC05" AS "ABAC05"
			, "INI_SRC"."ABAC06" AS "ABAC06"
			, "INI_SRC"."ABAC07" AS "ABAC07"
			, "INI_SRC"."ABAC08" AS "ABAC08"
			, "INI_SRC"."ABAC09" AS "ABAC09"
			, "INI_SRC"."ABAC10" AS "ABAC10"
			, "INI_SRC"."ABAC11" AS "ABAC11"
			, "INI_SRC"."ABAC12" AS "ABAC12"
			, "INI_SRC"."ABAC13" AS "ABAC13"
			, "INI_SRC"."ABAC14" AS "ABAC14"
			, "INI_SRC"."ABAC15" AS "ABAC15"
			, "INI_SRC"."ABAC16" AS "ABAC16"
			, "INI_SRC"."ABAC17" AS "ABAC17"
			, "INI_SRC"."ABAC18" AS "ABAC18"
			, "INI_SRC"."ABAC19" AS "ABAC19"
			, "INI_SRC"."ABAC20" AS "ABAC20"
			, "INI_SRC"."ABAC21" AS "ABAC21"
			, "INI_SRC"."ABAC22" AS "ABAC22"
			, "INI_SRC"."ABAC23" AS "ABAC23"
			, "INI_SRC"."ABAC24" AS "ABAC24"
			, "INI_SRC"."ABAC25" AS "ABAC25"
			, "INI_SRC"."ABAC26" AS "ABAC26"
			, "INI_SRC"."ABAC27" AS "ABAC27"
			, "INI_SRC"."ABAC28" AS "ABAC28"
			, "INI_SRC"."ABAC29" AS "ABAC29"
			, "INI_SRC"."ABAC30" AS "ABAC30"
			, "INI_SRC"."ABGLBA" AS "ABGLBA"
			, "INI_SRC"."ABPTI" AS "ABPTI"
			, "INI_SRC"."ABPDI" AS "ABPDI"
			, "INI_SRC"."ABMSGA" AS "ABMSGA"
			, "INI_SRC"."ABRMK" AS "ABRMK"
			, "INI_SRC"."ABTXCT" AS "ABTXCT"
			, "INI_SRC"."ABTX2" AS "ABTX2"
			, "INI_SRC"."ABALP1" AS "ABALP1"
			, "INI_SRC"."ABURCD" AS "ABURCD"
			, "INI_SRC"."ABURDT" AS "ABURDT"
			, "INI_SRC"."ABURAT" AS "ABURAT"
			, "INI_SRC"."ABURAB" AS "ABURAB"
			, "INI_SRC"."ABURRF" AS "ABURRF"
			, "INI_SRC"."ABUSER" AS "ABUSER"
			, "INI_SRC"."ABPID" AS "ABPID"
			, "INI_SRC"."ABUPMJ" AS "ABUPMJ"
			, "INI_SRC"."ABJOBN" AS "ABJOBN"
			, "INI_SRC"."ABUPMT" AS "ABUPMT"
			, "INI_SRC"."ABPRGF" AS "ABPRGF"
			, "INI_SRC"."ABSCCLTP" AS "ABSCCLTP"
			, "INI_SRC"."ABTICKER" AS "ABTICKER"
			, "INI_SRC"."ABEXCHG" AS "ABEXCHG"
			, "INI_SRC"."ABDUNS" AS "ABDUNS"
			, "INI_SRC"."ABCLASS01" AS "ABCLASS01"
			, "INI_SRC"."ABCLASS02" AS "ABCLASS02"
			, "INI_SRC"."ABCLASS03" AS "ABCLASS03"
			, "INI_SRC"."ABCLASS04" AS "ABCLASS04"
			, "INI_SRC"."ABCLASS05" AS "ABCLASS05"
			, "INI_SRC"."ABNOE" AS "ABNOE"
			, "INI_SRC"."ABGROWTHR" AS "ABGROWTHR"
			, "INI_SRC"."ABYEARSTAR" AS "ABYEARSTAR"
			, "INI_SRC"."ABAEMPGP" AS "ABAEMPGP"
			, "INI_SRC"."ABACTIN" AS "ABACTIN"
			, "INI_SRC"."ABREVRNG" AS "ABREVRNG"
			, "INI_SRC"."ABSYNCS" AS "ABSYNCS"
			, "INI_SRC"."ABPERRS" AS "ABPERRS"
			, "INI_SRC"."ABCAAD" AS "ABCAAD"
		FROM {{ source('JDEDWARDS_INI', 'F0101') }} "INI_SRC"
		INNER JOIN {{ source('JDEDWARDS_MTD', 'MTD_EXCEPTION_RECORDS') }} "MEX_INR_SRC" ON  "MEX_INR_SRC"."RECORD_TYPE" = 'N'
	)
	, "PREP_EXCEP" AS 
	( 
		SELECT 
			  "LOAD_INIT_DATA"."JRN_FLAG" AS "JRN_FLAG"
			, "LOAD_INIT_DATA"."RECORD_TYPE" AS "RECORD_TYPE"
			, NULL AS "LOAD_CYCLE_ID"
			, "LOAD_INIT_DATA"."ABAN8" AS "ABAN8"
			, "LOAD_INIT_DATA"."ABMCU" AS "ABMCU"
			, "LOAD_INIT_DATA"."ABALKY" AS "ABALKY"
			, "LOAD_INIT_DATA"."ABTAX" AS "ABTAX"
			, "LOAD_INIT_DATA"."ABALPH" AS "ABALPH"
			, "LOAD_INIT_DATA"."ABDC" AS "ABDC"
			, "LOAD_INIT_DATA"."ABSIC" AS "ABSIC"
			, "LOAD_INIT_DATA"."ABLNGP" AS "ABLNGP"
			, "LOAD_INIT_DATA"."ABAT1" AS "ABAT1"
			, "LOAD_INIT_DATA"."ABCM" AS "ABCM"
			, "LOAD_INIT_DATA"."ABTAXC" AS "ABTAXC"
			, "LOAD_INIT_DATA"."ABAT2" AS "ABAT2"
			, "LOAD_INIT_DATA"."ABAT3" AS "ABAT3"
			, "LOAD_INIT_DATA"."ABAT4" AS "ABAT4"
			, "LOAD_INIT_DATA"."ABAT5" AS "ABAT5"
			, "LOAD_INIT_DATA"."ABATP" AS "ABATP"
			, "LOAD_INIT_DATA"."ABATR" AS "ABATR"
			, "LOAD_INIT_DATA"."ABATPR" AS "ABATPR"
			, "LOAD_INIT_DATA"."ABAB3" AS "ABAB3"
			, "LOAD_INIT_DATA"."ABATE" AS "ABATE"
			, "LOAD_INIT_DATA"."ABSBLI" AS "ABSBLI"
			, "LOAD_INIT_DATA"."ABEFTB" AS "ABEFTB"
			, "LOAD_INIT_DATA"."ABAN81" AS "ABAN81"
			, "LOAD_INIT_DATA"."ABAN82" AS "ABAN82"
			, "LOAD_INIT_DATA"."ABAN83" AS "ABAN83"
			, "LOAD_INIT_DATA"."ABAN84" AS "ABAN84"
			, "LOAD_INIT_DATA"."ABAN86" AS "ABAN86"
			, "LOAD_INIT_DATA"."ABAN85" AS "ABAN85"
			, "LOAD_INIT_DATA"."ABAC01" AS "ABAC01"
			, "LOAD_INIT_DATA"."ABAC02" AS "ABAC02"
			, "LOAD_INIT_DATA"."ABAC03" AS "ABAC03"
			, "LOAD_INIT_DATA"."ABAC04" AS "ABAC04"
			, "LOAD_INIT_DATA"."ABAC05" AS "ABAC05"
			, "LOAD_INIT_DATA"."ABAC06" AS "ABAC06"
			, "LOAD_INIT_DATA"."ABAC07" AS "ABAC07"
			, "LOAD_INIT_DATA"."ABAC08" AS "ABAC08"
			, "LOAD_INIT_DATA"."ABAC09" AS "ABAC09"
			, "LOAD_INIT_DATA"."ABAC10" AS "ABAC10"
			, "LOAD_INIT_DATA"."ABAC11" AS "ABAC11"
			, "LOAD_INIT_DATA"."ABAC12" AS "ABAC12"
			, "LOAD_INIT_DATA"."ABAC13" AS "ABAC13"
			, "LOAD_INIT_DATA"."ABAC14" AS "ABAC14"
			, "LOAD_INIT_DATA"."ABAC15" AS "ABAC15"
			, "LOAD_INIT_DATA"."ABAC16" AS "ABAC16"
			, "LOAD_INIT_DATA"."ABAC17" AS "ABAC17"
			, "LOAD_INIT_DATA"."ABAC18" AS "ABAC18"
			, "LOAD_INIT_DATA"."ABAC19" AS "ABAC19"
			, "LOAD_INIT_DATA"."ABAC20" AS "ABAC20"
			, "LOAD_INIT_DATA"."ABAC21" AS "ABAC21"
			, "LOAD_INIT_DATA"."ABAC22" AS "ABAC22"
			, "LOAD_INIT_DATA"."ABAC23" AS "ABAC23"
			, "LOAD_INIT_DATA"."ABAC24" AS "ABAC24"
			, "LOAD_INIT_DATA"."ABAC25" AS "ABAC25"
			, "LOAD_INIT_DATA"."ABAC26" AS "ABAC26"
			, "LOAD_INIT_DATA"."ABAC27" AS "ABAC27"
			, "LOAD_INIT_DATA"."ABAC28" AS "ABAC28"
			, "LOAD_INIT_DATA"."ABAC29" AS "ABAC29"
			, "LOAD_INIT_DATA"."ABAC30" AS "ABAC30"
			, "LOAD_INIT_DATA"."ABGLBA" AS "ABGLBA"
			, "LOAD_INIT_DATA"."ABPTI" AS "ABPTI"
			, "LOAD_INIT_DATA"."ABPDI" AS "ABPDI"
			, "LOAD_INIT_DATA"."ABMSGA" AS "ABMSGA"
			, "LOAD_INIT_DATA"."ABRMK" AS "ABRMK"
			, "LOAD_INIT_DATA"."ABTXCT" AS "ABTXCT"
			, "LOAD_INIT_DATA"."ABTX2" AS "ABTX2"
			, "LOAD_INIT_DATA"."ABALP1" AS "ABALP1"
			, "LOAD_INIT_DATA"."ABURCD" AS "ABURCD"
			, "LOAD_INIT_DATA"."ABURDT" AS "ABURDT"
			, "LOAD_INIT_DATA"."ABURAT" AS "ABURAT"
			, "LOAD_INIT_DATA"."ABURAB" AS "ABURAB"
			, "LOAD_INIT_DATA"."ABURRF" AS "ABURRF"
			, "LOAD_INIT_DATA"."ABUSER" AS "ABUSER"
			, "LOAD_INIT_DATA"."ABPID" AS "ABPID"
			, "LOAD_INIT_DATA"."ABUPMJ" AS "ABUPMJ"
			, "LOAD_INIT_DATA"."ABJOBN" AS "ABJOBN"
			, "LOAD_INIT_DATA"."ABUPMT" AS "ABUPMT"
			, "LOAD_INIT_DATA"."ABPRGF" AS "ABPRGF"
			, "LOAD_INIT_DATA"."ABSCCLTP" AS "ABSCCLTP"
			, "LOAD_INIT_DATA"."ABTICKER" AS "ABTICKER"
			, "LOAD_INIT_DATA"."ABEXCHG" AS "ABEXCHG"
			, "LOAD_INIT_DATA"."ABDUNS" AS "ABDUNS"
			, "LOAD_INIT_DATA"."ABCLASS01" AS "ABCLASS01"
			, "LOAD_INIT_DATA"."ABCLASS02" AS "ABCLASS02"
			, "LOAD_INIT_DATA"."ABCLASS03" AS "ABCLASS03"
			, "LOAD_INIT_DATA"."ABCLASS04" AS "ABCLASS04"
			, "LOAD_INIT_DATA"."ABCLASS05" AS "ABCLASS05"
			, "LOAD_INIT_DATA"."ABNOE" AS "ABNOE"
			, "LOAD_INIT_DATA"."ABGROWTHR" AS "ABGROWTHR"
			, "LOAD_INIT_DATA"."ABYEARSTAR" AS "ABYEARSTAR"
			, "LOAD_INIT_DATA"."ABAEMPGP" AS "ABAEMPGP"
			, "LOAD_INIT_DATA"."ABACTIN" AS "ABACTIN"
			, "LOAD_INIT_DATA"."ABREVRNG" AS "ABREVRNG"
			, "LOAD_INIT_DATA"."ABSYNCS" AS "ABSYNCS"
			, "LOAD_INIT_DATA"."ABPERRS" AS "ABPERRS"
			, "LOAD_INIT_DATA"."ABCAAD" AS "ABCAAD"
		FROM "LOAD_INIT_DATA" "LOAD_INIT_DATA"
		UNION ALL 
		SELECT 
			  TO_CHAR('I' ) AS "JRN_FLAG"
			, "MEX_EXT_SRC"."RECORD_TYPE" AS "RECORD_TYPE"
			, "MEX_EXT_SRC"."LOAD_CYCLE_ID" ::integer AS "LOAD_CYCLE_ID"
			, CAST("MEX_EXT_SRC"."KEY_ATTRIBUTE_FLOAT" AS FLOAT) AS "ABAN8"
			, CAST("MEX_EXT_SRC"."KEY_ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABMCU"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABALKY"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABTAX"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABALPH"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABDC"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABSIC"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABLNGP"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABAT1"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABCM"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABTAXC"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABAT2"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABAT3"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABAT4"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABAT5"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABATP"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABATR"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABATPR"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABAB3"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABATE"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABSBLI"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_NUMBER" AS NUMBER) AS "ABEFTB"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "ABAN81"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "ABAN82"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "ABAN83"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "ABAN84"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "ABAN86"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "ABAN85"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABAC01"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABAC02"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABAC03"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABAC04"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABAC05"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABAC06"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABAC07"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABAC08"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABAC09"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABAC10"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABAC11"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABAC12"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABAC13"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABAC14"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABAC15"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABAC16"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABAC17"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABAC18"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABAC19"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABAC20"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABAC21"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABAC22"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABAC23"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABAC24"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABAC25"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABAC26"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABAC27"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABAC28"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABAC29"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABAC30"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABGLBA"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "ABPTI"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_NUMBER" AS NUMBER) AS "ABPDI"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABMSGA"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABRMK"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABTXCT"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABTX2"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABALP1"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABURCD"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_NUMBER" AS NUMBER) AS "ABURDT"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "ABURAT"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "ABURAB"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABURRF"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABUSER"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABPID"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_NUMBER" AS NUMBER) AS "ABUPMJ"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABJOBN"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "ABUPMT"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABPRGF"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABSCCLTP"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABTICKER"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABEXCHG"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABDUNS"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABCLASS01"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABCLASS02"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABCLASS03"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABCLASS04"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABCLASS05"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "ABNOE"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "ABGROWTHR"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABYEARSTAR"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABAEMPGP"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABACTIN"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "ABREVRNG"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "ABSYNCS"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "ABPERRS"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "ABCAAD"
		FROM {{ source('JDEDWARDS_MTD', 'MTD_EXCEPTION_RECORDS') }} "MEX_EXT_SRC"
	)
	, "CALCULATE_BK" AS 
	( 
		SELECT 
			  COALESCE("PREP_EXCEP"."LOAD_CYCLE_ID","LCI_SRC"."LOAD_CYCLE_ID") AS "LOAD_CYCLE_ID"
			, "LCI_SRC"."LOAD_DATE" AS "LOAD_DATE"
			, "LCI_SRC"."LOAD_DATE" AS "CDC_TIMESTAMP"
			, "PREP_EXCEP"."JRN_FLAG" AS "JRN_FLAG"
			, "PREP_EXCEP"."RECORD_TYPE" AS "RECORD_TYPE"
			, "PREP_EXCEP"."ABAN8" AS "ABAN8"
			, "PREP_EXCEP"."ABMCU" AS "ABMCU"
			, COALESCE(UPPER( TO_CHAR("PREP_EXCEP"."ABAN8")),"MEX_SRC"."KEY_ATTRIBUTE_FLOAT") AS "ABAN8_BK"
			, REPLACE(TRIM("PREP_EXCEP"."ABMCU"),'\#','\\' || '\#') AS "MCMCU_FK_ABMCU_BK"
			, "PREP_EXCEP"."ABALKY" AS "ABALKY"
			, "PREP_EXCEP"."ABTAX" AS "ABTAX"
			, "PREP_EXCEP"."ABALPH" AS "ABALPH"
			, "PREP_EXCEP"."ABDC" AS "ABDC"
			, "PREP_EXCEP"."ABSIC" AS "ABSIC"
			, "PREP_EXCEP"."ABLNGP" AS "ABLNGP"
			, "PREP_EXCEP"."ABAT1" AS "ABAT1"
			, "PREP_EXCEP"."ABCM" AS "ABCM"
			, "PREP_EXCEP"."ABTAXC" AS "ABTAXC"
			, "PREP_EXCEP"."ABAT2" AS "ABAT2"
			, "PREP_EXCEP"."ABAT3" AS "ABAT3"
			, "PREP_EXCEP"."ABAT4" AS "ABAT4"
			, "PREP_EXCEP"."ABAT5" AS "ABAT5"
			, "PREP_EXCEP"."ABATP" AS "ABATP"
			, "PREP_EXCEP"."ABATR" AS "ABATR"
			, "PREP_EXCEP"."ABATPR" AS "ABATPR"
			, "PREP_EXCEP"."ABAB3" AS "ABAB3"
			, "PREP_EXCEP"."ABATE" AS "ABATE"
			, "PREP_EXCEP"."ABSBLI" AS "ABSBLI"
			, "PREP_EXCEP"."ABEFTB" AS "ABEFTB"
			, "PREP_EXCEP"."ABAN81" AS "ABAN81"
			, "PREP_EXCEP"."ABAN82" AS "ABAN82"
			, "PREP_EXCEP"."ABAN83" AS "ABAN83"
			, "PREP_EXCEP"."ABAN84" AS "ABAN84"
			, "PREP_EXCEP"."ABAN86" AS "ABAN86"
			, "PREP_EXCEP"."ABAN85" AS "ABAN85"
			, "PREP_EXCEP"."ABAC01" AS "ABAC01"
			, "PREP_EXCEP"."ABAC02" AS "ABAC02"
			, "PREP_EXCEP"."ABAC03" AS "ABAC03"
			, "PREP_EXCEP"."ABAC04" AS "ABAC04"
			, "PREP_EXCEP"."ABAC05" AS "ABAC05"
			, "PREP_EXCEP"."ABAC06" AS "ABAC06"
			, "PREP_EXCEP"."ABAC07" AS "ABAC07"
			, "PREP_EXCEP"."ABAC08" AS "ABAC08"
			, "PREP_EXCEP"."ABAC09" AS "ABAC09"
			, "PREP_EXCEP"."ABAC10" AS "ABAC10"
			, "PREP_EXCEP"."ABAC11" AS "ABAC11"
			, "PREP_EXCEP"."ABAC12" AS "ABAC12"
			, "PREP_EXCEP"."ABAC13" AS "ABAC13"
			, "PREP_EXCEP"."ABAC14" AS "ABAC14"
			, "PREP_EXCEP"."ABAC15" AS "ABAC15"
			, "PREP_EXCEP"."ABAC16" AS "ABAC16"
			, "PREP_EXCEP"."ABAC17" AS "ABAC17"
			, "PREP_EXCEP"."ABAC18" AS "ABAC18"
			, "PREP_EXCEP"."ABAC19" AS "ABAC19"
			, "PREP_EXCEP"."ABAC20" AS "ABAC20"
			, "PREP_EXCEP"."ABAC21" AS "ABAC21"
			, "PREP_EXCEP"."ABAC22" AS "ABAC22"
			, "PREP_EXCEP"."ABAC23" AS "ABAC23"
			, "PREP_EXCEP"."ABAC24" AS "ABAC24"
			, "PREP_EXCEP"."ABAC25" AS "ABAC25"
			, "PREP_EXCEP"."ABAC26" AS "ABAC26"
			, "PREP_EXCEP"."ABAC27" AS "ABAC27"
			, "PREP_EXCEP"."ABAC28" AS "ABAC28"
			, "PREP_EXCEP"."ABAC29" AS "ABAC29"
			, "PREP_EXCEP"."ABAC30" AS "ABAC30"
			, "PREP_EXCEP"."ABGLBA" AS "ABGLBA"
			, "PREP_EXCEP"."ABPTI" AS "ABPTI"
			, "PREP_EXCEP"."ABPDI" AS "ABPDI"
			, "PREP_EXCEP"."ABMSGA" AS "ABMSGA"
			, "PREP_EXCEP"."ABRMK" AS "ABRMK"
			, "PREP_EXCEP"."ABTXCT" AS "ABTXCT"
			, "PREP_EXCEP"."ABTX2" AS "ABTX2"
			, "PREP_EXCEP"."ABALP1" AS "ABALP1"
			, "PREP_EXCEP"."ABURCD" AS "ABURCD"
			, "PREP_EXCEP"."ABURDT" AS "ABURDT"
			, "PREP_EXCEP"."ABURAT" AS "ABURAT"
			, "PREP_EXCEP"."ABURAB" AS "ABURAB"
			, "PREP_EXCEP"."ABURRF" AS "ABURRF"
			, "PREP_EXCEP"."ABUSER" AS "ABUSER"
			, "PREP_EXCEP"."ABPID" AS "ABPID"
			, "PREP_EXCEP"."ABUPMJ" AS "ABUPMJ"
			, "PREP_EXCEP"."ABJOBN" AS "ABJOBN"
			, "PREP_EXCEP"."ABUPMT" AS "ABUPMT"
			, "PREP_EXCEP"."ABPRGF" AS "ABPRGF"
			, "PREP_EXCEP"."ABSCCLTP" AS "ABSCCLTP"
			, "PREP_EXCEP"."ABTICKER" AS "ABTICKER"
			, "PREP_EXCEP"."ABEXCHG" AS "ABEXCHG"
			, "PREP_EXCEP"."ABDUNS" AS "ABDUNS"
			, "PREP_EXCEP"."ABCLASS01" AS "ABCLASS01"
			, "PREP_EXCEP"."ABCLASS02" AS "ABCLASS02"
			, "PREP_EXCEP"."ABCLASS03" AS "ABCLASS03"
			, "PREP_EXCEP"."ABCLASS04" AS "ABCLASS04"
			, "PREP_EXCEP"."ABCLASS05" AS "ABCLASS05"
			, "PREP_EXCEP"."ABNOE" AS "ABNOE"
			, "PREP_EXCEP"."ABGROWTHR" AS "ABGROWTHR"
			, "PREP_EXCEP"."ABYEARSTAR" AS "ABYEARSTAR"
			, "PREP_EXCEP"."ABAEMPGP" AS "ABAEMPGP"
			, "PREP_EXCEP"."ABACTIN" AS "ABACTIN"
			, "PREP_EXCEP"."ABREVRNG" AS "ABREVRNG"
			, "PREP_EXCEP"."ABSYNCS" AS "ABSYNCS"
			, "PREP_EXCEP"."ABPERRS" AS "ABPERRS"
			, "PREP_EXCEP"."ABCAAD" AS "ABCAAD"
		FROM "PREP_EXCEP" "PREP_EXCEP"
		INNER JOIN {{ source('JDEDWARDS_MTD', 'LOAD_CYCLE_INFO') }} "LCI_SRC" ON  1 = 1
		INNER JOIN {{ source('JDEDWARDS_MTD', 'MTD_EXCEPTION_RECORDS') }} "MEX_SRC" ON  1 = 1
		WHERE  "MEX_SRC"."RECORD_TYPE" = 'N'
	)
	SELECT 
		  "CALCULATE_BK"."LOAD_CYCLE_ID" AS "LOAD_CYCLE_ID"
		, "CALCULATE_BK"."LOAD_DATE" AS "LOAD_DATE"
		, "CALCULATE_BK"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP"
		, "CALCULATE_BK"."JRN_FLAG" AS "JRN_FLAG"
		, "CALCULATE_BK"."RECORD_TYPE" AS "RECORD_TYPE"
		, "CALCULATE_BK"."ABAN8" AS "ABAN8"
		, "CALCULATE_BK"."ABMCU" AS "ABMCU"
		, "CALCULATE_BK"."ABAN8_BK" AS "ABAN8_BK"
		, "CALCULATE_BK"."MCMCU_FK_ABMCU_BK" AS "MCMCU_FK_ABMCU_BK"
		, "CALCULATE_BK"."ABALKY" AS "ABALKY"
		, "CALCULATE_BK"."ABTAX" AS "ABTAX"
		, "CALCULATE_BK"."ABALPH" AS "ABALPH"
		, "CALCULATE_BK"."ABDC" AS "ABDC"
		, "CALCULATE_BK"."ABSIC" AS "ABSIC"
		, "CALCULATE_BK"."ABLNGP" AS "ABLNGP"
		, "CALCULATE_BK"."ABAT1" AS "ABAT1"
		, "CALCULATE_BK"."ABCM" AS "ABCM"
		, "CALCULATE_BK"."ABTAXC" AS "ABTAXC"
		, "CALCULATE_BK"."ABAT2" AS "ABAT2"
		, "CALCULATE_BK"."ABAT3" AS "ABAT3"
		, "CALCULATE_BK"."ABAT4" AS "ABAT4"
		, "CALCULATE_BK"."ABAT5" AS "ABAT5"
		, "CALCULATE_BK"."ABATP" AS "ABATP"
		, "CALCULATE_BK"."ABATR" AS "ABATR"
		, "CALCULATE_BK"."ABATPR" AS "ABATPR"
		, "CALCULATE_BK"."ABAB3" AS "ABAB3"
		, "CALCULATE_BK"."ABATE" AS "ABATE"
		, "CALCULATE_BK"."ABSBLI" AS "ABSBLI"
		, "CALCULATE_BK"."ABEFTB" AS "ABEFTB"
		, "CALCULATE_BK"."ABAN81" AS "ABAN81"
		, "CALCULATE_BK"."ABAN82" AS "ABAN82"
		, "CALCULATE_BK"."ABAN83" AS "ABAN83"
		, "CALCULATE_BK"."ABAN84" AS "ABAN84"
		, "CALCULATE_BK"."ABAN86" AS "ABAN86"
		, "CALCULATE_BK"."ABAN85" AS "ABAN85"
		, "CALCULATE_BK"."ABAC01" AS "ABAC01"
		, "CALCULATE_BK"."ABAC02" AS "ABAC02"
		, "CALCULATE_BK"."ABAC03" AS "ABAC03"
		, "CALCULATE_BK"."ABAC04" AS "ABAC04"
		, "CALCULATE_BK"."ABAC05" AS "ABAC05"
		, "CALCULATE_BK"."ABAC06" AS "ABAC06"
		, "CALCULATE_BK"."ABAC07" AS "ABAC07"
		, "CALCULATE_BK"."ABAC08" AS "ABAC08"
		, "CALCULATE_BK"."ABAC09" AS "ABAC09"
		, "CALCULATE_BK"."ABAC10" AS "ABAC10"
		, "CALCULATE_BK"."ABAC11" AS "ABAC11"
		, "CALCULATE_BK"."ABAC12" AS "ABAC12"
		, "CALCULATE_BK"."ABAC13" AS "ABAC13"
		, "CALCULATE_BK"."ABAC14" AS "ABAC14"
		, "CALCULATE_BK"."ABAC15" AS "ABAC15"
		, "CALCULATE_BK"."ABAC16" AS "ABAC16"
		, "CALCULATE_BK"."ABAC17" AS "ABAC17"
		, "CALCULATE_BK"."ABAC18" AS "ABAC18"
		, "CALCULATE_BK"."ABAC19" AS "ABAC19"
		, "CALCULATE_BK"."ABAC20" AS "ABAC20"
		, "CALCULATE_BK"."ABAC21" AS "ABAC21"
		, "CALCULATE_BK"."ABAC22" AS "ABAC22"
		, "CALCULATE_BK"."ABAC23" AS "ABAC23"
		, "CALCULATE_BK"."ABAC24" AS "ABAC24"
		, "CALCULATE_BK"."ABAC25" AS "ABAC25"
		, "CALCULATE_BK"."ABAC26" AS "ABAC26"
		, "CALCULATE_BK"."ABAC27" AS "ABAC27"
		, "CALCULATE_BK"."ABAC28" AS "ABAC28"
		, "CALCULATE_BK"."ABAC29" AS "ABAC29"
		, "CALCULATE_BK"."ABAC30" AS "ABAC30"
		, "CALCULATE_BK"."ABGLBA" AS "ABGLBA"
		, "CALCULATE_BK"."ABPTI" AS "ABPTI"
		, "CALCULATE_BK"."ABPDI" AS "ABPDI"
		, "CALCULATE_BK"."ABMSGA" AS "ABMSGA"
		, "CALCULATE_BK"."ABRMK" AS "ABRMK"
		, "CALCULATE_BK"."ABTXCT" AS "ABTXCT"
		, "CALCULATE_BK"."ABTX2" AS "ABTX2"
		, "CALCULATE_BK"."ABALP1" AS "ABALP1"
		, "CALCULATE_BK"."ABURCD" AS "ABURCD"
		, "CALCULATE_BK"."ABURDT" AS "ABURDT"
		, "CALCULATE_BK"."ABURAT" AS "ABURAT"
		, "CALCULATE_BK"."ABURAB" AS "ABURAB"
		, "CALCULATE_BK"."ABURRF" AS "ABURRF"
		, "CALCULATE_BK"."ABUSER" AS "ABUSER"
		, "CALCULATE_BK"."ABPID" AS "ABPID"
		, "CALCULATE_BK"."ABUPMJ" AS "ABUPMJ"
		, "CALCULATE_BK"."ABJOBN" AS "ABJOBN"
		, "CALCULATE_BK"."ABUPMT" AS "ABUPMT"
		, "CALCULATE_BK"."ABPRGF" AS "ABPRGF"
		, "CALCULATE_BK"."ABSCCLTP" AS "ABSCCLTP"
		, "CALCULATE_BK"."ABTICKER" AS "ABTICKER"
		, "CALCULATE_BK"."ABEXCHG" AS "ABEXCHG"
		, "CALCULATE_BK"."ABDUNS" AS "ABDUNS"
		, "CALCULATE_BK"."ABCLASS01" AS "ABCLASS01"
		, "CALCULATE_BK"."ABCLASS02" AS "ABCLASS02"
		, "CALCULATE_BK"."ABCLASS03" AS "ABCLASS03"
		, "CALCULATE_BK"."ABCLASS04" AS "ABCLASS04"
		, "CALCULATE_BK"."ABCLASS05" AS "ABCLASS05"
		, "CALCULATE_BK"."ABNOE" AS "ABNOE"
		, "CALCULATE_BK"."ABGROWTHR" AS "ABGROWTHR"
		, "CALCULATE_BK"."ABYEARSTAR" AS "ABYEARSTAR"
		, "CALCULATE_BK"."ABAEMPGP" AS "ABAEMPGP"
		, "CALCULATE_BK"."ABACTIN" AS "ABACTIN"
		, "CALCULATE_BK"."ABREVRNG" AS "ABREVRNG"
		, "CALCULATE_BK"."ABSYNCS" AS "ABSYNCS"
		, "CALCULATE_BK"."ABPERRS" AS "ABPERRS"
		, "CALCULATE_BK"."ABCAAD" AS "ABCAAD"
	FROM "CALCULATE_BK" "CALCULATE_BK"

) final 
where '{{ var("load_type") }}' = 'INIT' and '{{ var("source") }}' = 'JDEDWARDS'