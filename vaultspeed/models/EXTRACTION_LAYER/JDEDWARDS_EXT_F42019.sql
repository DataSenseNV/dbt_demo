{{
	config(
		materialized='incremental',
		pre_hook= [
			'{% if var("load_type") == "INCR" and var("source") == "JDEDWARDS" %} TRUNCATE TABLE {{ this }}; {% endif %}',
			'{% if var("load_type") == "INIT" and var("source") == "JDEDWARDS" %} TRUNCATE TABLE {{ this }}; {% endif %}'
		],
		alias='F42019',
		schema='JDEDWARDS_EXT',
		tags=['JDEDWARDS', 'EXT_JDE_SOHEADERHIST_INCR', 'EXT_JDE_SOHEADERHIST_INIT']
	)
}}
select * from (
	WITH "CALCULATE_BK" AS 
	( 
		SELECT 
			  "LCI_SRC"."LOAD_CYCLE_ID" AS "LOAD_CYCLE_ID"
			, DATEADD(microsecond, 2*row_number() over (order by "TDFV_SRC"."CDC_TIMESTAMP"),
				TO_TIMESTAMP_NTZ(CURRENT_TIMESTAMP()))   AS "LOAD_DATE"
			, "TDFV_SRC"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP"
			, COALESCE("TDFV_SRC"."JRN_FLAG","MEX_SRC"."ATTRIBUTE_VARCHAR") AS "JRN_FLAG"
			, "TDFV_SRC"."RECORD_TYPE" AS "RECORD_TYPE"
			, "TDFV_SRC"."SHKCOO" AS "SHKCOO"
			, "TDFV_SRC"."SHDOCO" AS "SHDOCO"
			, "TDFV_SRC"."SHDCTO" AS "SHDCTO"
			, "TDFV_SRC"."SHMCU" AS "SHMCU"
			, "TDFV_SRC"."SHAN8" AS "SHAN8"
			, COALESCE(UPPER( TO_CHAR("TDFV_SRC"."SHDOCO")),"MEX_SRC"."KEY_ATTRIBUTE_FLOAT") AS "SHDOCO_BK"
			, COALESCE(REPLACE(TRIM( "TDFV_SRC"."SHDCTO"),'\#','\\' || '\#'),"MEX_SRC"."KEY_ATTRIBUTE_VARCHAR") AS "SHDCTO_BK"
			, COALESCE(REPLACE(TRIM( "TDFV_SRC"."SHKCOO"),'\#','\\' || '\#'),"MEX_SRC"."KEY_ATTRIBUTE_VARCHAR") AS "SHKCOO_BK"
			, UPPER( TO_CHAR("TDFV_SRC"."SHAN8")) AS "ABAN8_FK_SHAN8_BK"
			, REPLACE(TRIM( "TDFV_SRC"."SHMCU"),'\#','\\' || '\#') AS "MCMCU_FK_SHMCU_BK"
			, "TDFV_SRC"."SHSFXO" AS "SHSFXO"
			, "TDFV_SRC"."SHCO" AS "SHCO"
			, "TDFV_SRC"."SHOKCO" AS "SHOKCO"
			, "TDFV_SRC"."SHOORN" AS "SHOORN"
			, "TDFV_SRC"."SHOCTO" AS "SHOCTO"
			, "TDFV_SRC"."SHRKCO" AS "SHRKCO"
			, "TDFV_SRC"."SHRORN" AS "SHRORN"
			, "TDFV_SRC"."SHRCTO" AS "SHRCTO"
			, "TDFV_SRC"."SHSHAN" AS "SHSHAN"
			, "TDFV_SRC"."SHPA8" AS "SHPA8"
			, "TDFV_SRC"."SHDRQJ" AS "SHDRQJ"
			, "TDFV_SRC"."SHTRDJ" AS "SHTRDJ"
			, "TDFV_SRC"."SHPDDJ" AS "SHPDDJ"
			, "TDFV_SRC"."SHOPDJ" AS "SHOPDJ"
			, "TDFV_SRC"."SHADDJ" AS "SHADDJ"
			, "TDFV_SRC"."SHCNDJ" AS "SHCNDJ"
			, "TDFV_SRC"."SHPEFJ" AS "SHPEFJ"
			, "TDFV_SRC"."SHPPDJ" AS "SHPPDJ"
			, "TDFV_SRC"."SHVR01" AS "SHVR01"
			, "TDFV_SRC"."SHVR02" AS "SHVR02"
			, "TDFV_SRC"."SHDEL1" AS "SHDEL1"
			, "TDFV_SRC"."SHDEL2" AS "SHDEL2"
			, "TDFV_SRC"."SHINMG" AS "SHINMG"
			, "TDFV_SRC"."SHPTC" AS "SHPTC"
			, "TDFV_SRC"."SHRYIN" AS "SHRYIN"
			, "TDFV_SRC"."SHASN" AS "SHASN"
			, "TDFV_SRC"."SHPRGP" AS "SHPRGP"
			, "TDFV_SRC"."SHTRDC" AS "SHTRDC"
			, "TDFV_SRC"."SHPCRT" AS "SHPCRT"
			, "TDFV_SRC"."SHTXA1" AS "SHTXA1"
			, "TDFV_SRC"."SHEXR1" AS "SHEXR1"
			, "TDFV_SRC"."SHTXCT" AS "SHTXCT"
			, "TDFV_SRC"."SHATXT" AS "SHATXT"
			, "TDFV_SRC"."SHPRIO" AS "SHPRIO"
			, "TDFV_SRC"."SHBACK" AS "SHBACK"
			, "TDFV_SRC"."SHSBAL" AS "SHSBAL"
			, "TDFV_SRC"."SHHOLD" AS "SHHOLD"
			, "TDFV_SRC"."SHPLST" AS "SHPLST"
			, "TDFV_SRC"."SHINVC" AS "SHINVC"
			, "TDFV_SRC"."SHNTR" AS "SHNTR"
			, "TDFV_SRC"."SHANBY" AS "SHANBY"
			, "TDFV_SRC"."SHCARS" AS "SHCARS"
			, "TDFV_SRC"."SHMOT" AS "SHMOT"
			, "TDFV_SRC"."SHCOT" AS "SHCOT"
			, "TDFV_SRC"."SHROUT" AS "SHROUT"
			, "TDFV_SRC"."SHSTOP" AS "SHSTOP"
			, "TDFV_SRC"."SHZON" AS "SHZON"
			, "TDFV_SRC"."SHCNID" AS "SHCNID"
			, "TDFV_SRC"."SHFRTH" AS "SHFRTH"
			, "TDFV_SRC"."SHAFT" AS "SHAFT"
			, "TDFV_SRC"."SHFUF1" AS "SHFUF1"
			, "TDFV_SRC"."SHFRTC" AS "SHFRTC"
			, "TDFV_SRC"."SHMORD" AS "SHMORD"
			, "TDFV_SRC"."SHRCD" AS "SHRCD"
			, "TDFV_SRC"."SHFUF2" AS "SHFUF2"
			, "TDFV_SRC"."SHOTOT" AS "SHOTOT"
			, "TDFV_SRC"."SHTOTC" AS "SHTOTC"
			, "TDFV_SRC"."SHWUMD" AS "SHWUMD"
			, "TDFV_SRC"."SHVUMD" AS "SHVUMD"
			, "TDFV_SRC"."SHAUTN" AS "SHAUTN"
			, "TDFV_SRC"."SHCACT" AS "SHCACT"
			, "TDFV_SRC"."SHCEXP" AS "SHCEXP"
			, "TDFV_SRC"."SHSBLI" AS "SHSBLI"
			, "TDFV_SRC"."SHCRMD" AS "SHCRMD"
			, "TDFV_SRC"."SHCRRM" AS "SHCRRM"
			, "TDFV_SRC"."SHCRCD" AS "SHCRCD"
			, "TDFV_SRC"."SHCRR" AS "SHCRR"
			, "TDFV_SRC"."SHLNGP" AS "SHLNGP"
			, "TDFV_SRC"."SHFAP" AS "SHFAP"
			, "TDFV_SRC"."SHFCST" AS "SHFCST"
			, "TDFV_SRC"."SHORBY" AS "SHORBY"
			, "TDFV_SRC"."SHTKBY" AS "SHTKBY"
			, "TDFV_SRC"."SHURCD" AS "SHURCD"
			, "TDFV_SRC"."SHURDT" AS "SHURDT"
			, "TDFV_SRC"."SHURAT" AS "SHURAT"
			, "TDFV_SRC"."SHURAB" AS "SHURAB"
			, "TDFV_SRC"."SHURRF" AS "SHURRF"
			, "TDFV_SRC"."SHUSER" AS "SHUSER"
			, "TDFV_SRC"."SHPID" AS "SHPID"
			, "TDFV_SRC"."SHJOBN" AS "SHJOBN"
			, "TDFV_SRC"."SHUPMJ" AS "SHUPMJ"
			, "TDFV_SRC"."SHTDAY" AS "SHTDAY"
			, "TDFV_SRC"."SHIR01" AS "SHIR01"
			, "TDFV_SRC"."SHIR02" AS "SHIR02"
			, "TDFV_SRC"."SHIR03" AS "SHIR03"
			, "TDFV_SRC"."SHIR04" AS "SHIR04"
			, "TDFV_SRC"."SHIR05" AS "SHIR05"
			, "TDFV_SRC"."SHVR03" AS "SHVR03"
			, "TDFV_SRC"."SHSOOR" AS "SHSOOR"
			, "TDFV_SRC"."SHPMDT" AS "SHPMDT"
			, "TDFV_SRC"."SHRSDT" AS "SHRSDT"
			, "TDFV_SRC"."SHRQSJ" AS "SHRQSJ"
			, "TDFV_SRC"."SHPSTM" AS "SHPSTM"
			, "TDFV_SRC"."SHPDTT" AS "SHPDTT"
			, "TDFV_SRC"."SHOPTT" AS "SHOPTT"
			, "TDFV_SRC"."SHDRQT" AS "SHDRQT"
			, "TDFV_SRC"."SHADTM" AS "SHADTM"
			, "TDFV_SRC"."SHADLJ" AS "SHADLJ"
			, "TDFV_SRC"."SHPBAN" AS "SHPBAN"
			, "TDFV_SRC"."SHITAN" AS "SHITAN"
			, "TDFV_SRC"."SHFTAN" AS "SHFTAN"
			, "TDFV_SRC"."SHDVAN" AS "SHDVAN"
			, "TDFV_SRC"."SHDOC1" AS "SHDOC1"
			, "TDFV_SRC"."SHDCT4" AS "SHDCT4"
			, "TDFV_SRC"."SHCORD" AS "SHCORD"
			, "TDFV_SRC"."SHBSC" AS "SHBSC"
			, "TDFV_SRC"."SHBCRC" AS "SHBCRC"
			, "TDFV_SRC"."SHAUFT" AS "SHAUFT"
			, "TDFV_SRC"."SHAUFI" AS "SHAUFI"
			, "TDFV_SRC"."SHOPBO" AS "SHOPBO"
			, "TDFV_SRC"."SHOPTC" AS "SHOPTC"
			, "TDFV_SRC"."SHOPLD" AS "SHOPLD"
			, "TDFV_SRC"."SHOPBK" AS "SHOPBK"
			, "TDFV_SRC"."SHOPSB" AS "SHOPSB"
			, "TDFV_SRC"."SHOPPS" AS "SHOPPS"
			, "TDFV_SRC"."SHOPPL" AS "SHOPPL"
			, "TDFV_SRC"."SHOPMS" AS "SHOPMS"
			, "TDFV_SRC"."SHOPSS" AS "SHOPSS"
			, "TDFV_SRC"."SHOPBA" AS "SHOPBA"
			, "TDFV_SRC"."SHOPLL" AS "SHOPLL"
			, "TDFV_SRC"."SHPRAN8" AS "SHPRAN8"
			, "TDFV_SRC"."SHOPPID" AS "SHOPPID"
			, "TDFV_SRC"."SHSDATTN" AS "SHSDATTN"
			, "TDFV_SRC"."SHSPATTN" AS "SHSPATTN"
			, "TDFV_SRC"."SHOTIND" AS "SHOTIND"
			, "TDFV_SRC"."SHPRCIDLN" AS "SHPRCIDLN"
			, "TDFV_SRC"."SHCCIDLN" AS "SHCCIDLN"
			, "TDFV_SRC"."SHSHCCIDLN" AS "SHSHCCIDLN"
		FROM {{ ref('JDEDWARDS_DFV_VW_F42019') }} "TDFV_SRC"
		INNER JOIN {{ source('JDEDWARDS_MTD', 'LOAD_CYCLE_INFO') }} "LCI_SRC" ON  1 = 1
		INNER JOIN {{ source('JDEDWARDS_MTD', 'MTD_EXCEPTION_RECORDS') }} "MEX_SRC" ON  1 = 1
		WHERE  "MEX_SRC"."RECORD_TYPE" = 'N'
	)
	, "EXT_UNION" AS 
	( 
		SELECT 
			  "CALCULATE_BK"."LOAD_CYCLE_ID" AS "LOAD_CYCLE_ID"
			, "CALCULATE_BK"."LOAD_DATE" AS "LOAD_DATE"
			, "CALCULATE_BK"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP"
			, "CALCULATE_BK"."JRN_FLAG" AS "JRN_FLAG"
			, "CALCULATE_BK"."RECORD_TYPE" AS "RECORD_TYPE"
			, "CALCULATE_BK"."SHKCOO" AS "SHKCOO"
			, "CALCULATE_BK"."SHDOCO" AS "SHDOCO"
			, "CALCULATE_BK"."SHDCTO" AS "SHDCTO"
			, "CALCULATE_BK"."SHMCU" AS "SHMCU"
			, "CALCULATE_BK"."SHAN8" AS "SHAN8"
			, "CALCULATE_BK"."SHDOCO_BK" AS "SHDOCO_BK"
			, "CALCULATE_BK"."SHDCTO_BK" AS "SHDCTO_BK"
			, "CALCULATE_BK"."SHKCOO_BK" AS "SHKCOO_BK"
			, "CALCULATE_BK"."ABAN8_FK_SHAN8_BK" AS "ABAN8_FK_SHAN8_BK"
			, "CALCULATE_BK"."MCMCU_FK_SHMCU_BK" AS "MCMCU_FK_SHMCU_BK"
			, "CALCULATE_BK"."SHSFXO" AS "SHSFXO"
			, "CALCULATE_BK"."SHCO" AS "SHCO"
			, "CALCULATE_BK"."SHOKCO" AS "SHOKCO"
			, "CALCULATE_BK"."SHOORN" AS "SHOORN"
			, "CALCULATE_BK"."SHOCTO" AS "SHOCTO"
			, "CALCULATE_BK"."SHRKCO" AS "SHRKCO"
			, "CALCULATE_BK"."SHRORN" AS "SHRORN"
			, "CALCULATE_BK"."SHRCTO" AS "SHRCTO"
			, "CALCULATE_BK"."SHSHAN" AS "SHSHAN"
			, "CALCULATE_BK"."SHPA8" AS "SHPA8"
			, "CALCULATE_BK"."SHDRQJ" AS "SHDRQJ"
			, "CALCULATE_BK"."SHTRDJ" AS "SHTRDJ"
			, "CALCULATE_BK"."SHPDDJ" AS "SHPDDJ"
			, "CALCULATE_BK"."SHOPDJ" AS "SHOPDJ"
			, "CALCULATE_BK"."SHADDJ" AS "SHADDJ"
			, "CALCULATE_BK"."SHCNDJ" AS "SHCNDJ"
			, "CALCULATE_BK"."SHPEFJ" AS "SHPEFJ"
			, "CALCULATE_BK"."SHPPDJ" AS "SHPPDJ"
			, "CALCULATE_BK"."SHVR01" AS "SHVR01"
			, "CALCULATE_BK"."SHVR02" AS "SHVR02"
			, "CALCULATE_BK"."SHDEL1" AS "SHDEL1"
			, "CALCULATE_BK"."SHDEL2" AS "SHDEL2"
			, "CALCULATE_BK"."SHINMG" AS "SHINMG"
			, "CALCULATE_BK"."SHPTC" AS "SHPTC"
			, "CALCULATE_BK"."SHRYIN" AS "SHRYIN"
			, "CALCULATE_BK"."SHASN" AS "SHASN"
			, "CALCULATE_BK"."SHPRGP" AS "SHPRGP"
			, "CALCULATE_BK"."SHTRDC" AS "SHTRDC"
			, "CALCULATE_BK"."SHPCRT" AS "SHPCRT"
			, "CALCULATE_BK"."SHTXA1" AS "SHTXA1"
			, "CALCULATE_BK"."SHEXR1" AS "SHEXR1"
			, "CALCULATE_BK"."SHTXCT" AS "SHTXCT"
			, "CALCULATE_BK"."SHATXT" AS "SHATXT"
			, "CALCULATE_BK"."SHPRIO" AS "SHPRIO"
			, "CALCULATE_BK"."SHBACK" AS "SHBACK"
			, "CALCULATE_BK"."SHSBAL" AS "SHSBAL"
			, "CALCULATE_BK"."SHHOLD" AS "SHHOLD"
			, "CALCULATE_BK"."SHPLST" AS "SHPLST"
			, "CALCULATE_BK"."SHINVC" AS "SHINVC"
			, "CALCULATE_BK"."SHNTR" AS "SHNTR"
			, "CALCULATE_BK"."SHANBY" AS "SHANBY"
			, "CALCULATE_BK"."SHCARS" AS "SHCARS"
			, "CALCULATE_BK"."SHMOT" AS "SHMOT"
			, "CALCULATE_BK"."SHCOT" AS "SHCOT"
			, "CALCULATE_BK"."SHROUT" AS "SHROUT"
			, "CALCULATE_BK"."SHSTOP" AS "SHSTOP"
			, "CALCULATE_BK"."SHZON" AS "SHZON"
			, "CALCULATE_BK"."SHCNID" AS "SHCNID"
			, "CALCULATE_BK"."SHFRTH" AS "SHFRTH"
			, "CALCULATE_BK"."SHAFT" AS "SHAFT"
			, "CALCULATE_BK"."SHFUF1" AS "SHFUF1"
			, "CALCULATE_BK"."SHFRTC" AS "SHFRTC"
			, "CALCULATE_BK"."SHMORD" AS "SHMORD"
			, "CALCULATE_BK"."SHRCD" AS "SHRCD"
			, "CALCULATE_BK"."SHFUF2" AS "SHFUF2"
			, "CALCULATE_BK"."SHOTOT" AS "SHOTOT"
			, "CALCULATE_BK"."SHTOTC" AS "SHTOTC"
			, "CALCULATE_BK"."SHWUMD" AS "SHWUMD"
			, "CALCULATE_BK"."SHVUMD" AS "SHVUMD"
			, "CALCULATE_BK"."SHAUTN" AS "SHAUTN"
			, "CALCULATE_BK"."SHCACT" AS "SHCACT"
			, "CALCULATE_BK"."SHCEXP" AS "SHCEXP"
			, "CALCULATE_BK"."SHSBLI" AS "SHSBLI"
			, "CALCULATE_BK"."SHCRMD" AS "SHCRMD"
			, "CALCULATE_BK"."SHCRRM" AS "SHCRRM"
			, "CALCULATE_BK"."SHCRCD" AS "SHCRCD"
			, "CALCULATE_BK"."SHCRR" AS "SHCRR"
			, "CALCULATE_BK"."SHLNGP" AS "SHLNGP"
			, "CALCULATE_BK"."SHFAP" AS "SHFAP"
			, "CALCULATE_BK"."SHFCST" AS "SHFCST"
			, "CALCULATE_BK"."SHORBY" AS "SHORBY"
			, "CALCULATE_BK"."SHTKBY" AS "SHTKBY"
			, "CALCULATE_BK"."SHURCD" AS "SHURCD"
			, "CALCULATE_BK"."SHURDT" AS "SHURDT"
			, "CALCULATE_BK"."SHURAT" AS "SHURAT"
			, "CALCULATE_BK"."SHURAB" AS "SHURAB"
			, "CALCULATE_BK"."SHURRF" AS "SHURRF"
			, "CALCULATE_BK"."SHUSER" AS "SHUSER"
			, "CALCULATE_BK"."SHPID" AS "SHPID"
			, "CALCULATE_BK"."SHJOBN" AS "SHJOBN"
			, "CALCULATE_BK"."SHUPMJ" AS "SHUPMJ"
			, "CALCULATE_BK"."SHTDAY" AS "SHTDAY"
			, "CALCULATE_BK"."SHIR01" AS "SHIR01"
			, "CALCULATE_BK"."SHIR02" AS "SHIR02"
			, "CALCULATE_BK"."SHIR03" AS "SHIR03"
			, "CALCULATE_BK"."SHIR04" AS "SHIR04"
			, "CALCULATE_BK"."SHIR05" AS "SHIR05"
			, "CALCULATE_BK"."SHVR03" AS "SHVR03"
			, "CALCULATE_BK"."SHSOOR" AS "SHSOOR"
			, "CALCULATE_BK"."SHPMDT" AS "SHPMDT"
			, "CALCULATE_BK"."SHRSDT" AS "SHRSDT"
			, "CALCULATE_BK"."SHRQSJ" AS "SHRQSJ"
			, "CALCULATE_BK"."SHPSTM" AS "SHPSTM"
			, "CALCULATE_BK"."SHPDTT" AS "SHPDTT"
			, "CALCULATE_BK"."SHOPTT" AS "SHOPTT"
			, "CALCULATE_BK"."SHDRQT" AS "SHDRQT"
			, "CALCULATE_BK"."SHADTM" AS "SHADTM"
			, "CALCULATE_BK"."SHADLJ" AS "SHADLJ"
			, "CALCULATE_BK"."SHPBAN" AS "SHPBAN"
			, "CALCULATE_BK"."SHITAN" AS "SHITAN"
			, "CALCULATE_BK"."SHFTAN" AS "SHFTAN"
			, "CALCULATE_BK"."SHDVAN" AS "SHDVAN"
			, "CALCULATE_BK"."SHDOC1" AS "SHDOC1"
			, "CALCULATE_BK"."SHDCT4" AS "SHDCT4"
			, "CALCULATE_BK"."SHCORD" AS "SHCORD"
			, "CALCULATE_BK"."SHBSC" AS "SHBSC"
			, "CALCULATE_BK"."SHBCRC" AS "SHBCRC"
			, "CALCULATE_BK"."SHAUFT" AS "SHAUFT"
			, "CALCULATE_BK"."SHAUFI" AS "SHAUFI"
			, "CALCULATE_BK"."SHOPBO" AS "SHOPBO"
			, "CALCULATE_BK"."SHOPTC" AS "SHOPTC"
			, "CALCULATE_BK"."SHOPLD" AS "SHOPLD"
			, "CALCULATE_BK"."SHOPBK" AS "SHOPBK"
			, "CALCULATE_BK"."SHOPSB" AS "SHOPSB"
			, "CALCULATE_BK"."SHOPPS" AS "SHOPPS"
			, "CALCULATE_BK"."SHOPPL" AS "SHOPPL"
			, "CALCULATE_BK"."SHOPMS" AS "SHOPMS"
			, "CALCULATE_BK"."SHOPSS" AS "SHOPSS"
			, "CALCULATE_BK"."SHOPBA" AS "SHOPBA"
			, "CALCULATE_BK"."SHOPLL" AS "SHOPLL"
			, "CALCULATE_BK"."SHPRAN8" AS "SHPRAN8"
			, "CALCULATE_BK"."SHOPPID" AS "SHOPPID"
			, "CALCULATE_BK"."SHSDATTN" AS "SHSDATTN"
			, "CALCULATE_BK"."SHSPATTN" AS "SHSPATTN"
			, "CALCULATE_BK"."SHOTIND" AS "SHOTIND"
			, "CALCULATE_BK"."SHPRCIDLN" AS "SHPRCIDLN"
			, "CALCULATE_BK"."SHCCIDLN" AS "SHCCIDLN"
			, "CALCULATE_BK"."SHSHCCIDLN" AS "SHSHCCIDLN"
		FROM "CALCULATE_BK" "CALCULATE_BK"
	)
	SELECT 
		  "EXT_UNION"."LOAD_CYCLE_ID" AS "LOAD_CYCLE_ID"
		, "EXT_UNION"."LOAD_DATE" AS "LOAD_DATE"
		, "EXT_UNION"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP"
		, "EXT_UNION"."JRN_FLAG" AS "JRN_FLAG"
		, "EXT_UNION"."RECORD_TYPE" AS "RECORD_TYPE"
		, "EXT_UNION"."SHKCOO" AS "SHKCOO"
		, "EXT_UNION"."SHDOCO" AS "SHDOCO"
		, "EXT_UNION"."SHDCTO" AS "SHDCTO"
		, "EXT_UNION"."SHMCU" AS "SHMCU"
		, "EXT_UNION"."SHAN8" AS "SHAN8"
		, "EXT_UNION"."SHDOCO_BK" AS "SHDOCO_BK"
		, "EXT_UNION"."SHDCTO_BK" AS "SHDCTO_BK"
		, "EXT_UNION"."SHKCOO_BK" AS "SHKCOO_BK"
		, "EXT_UNION"."ABAN8_FK_SHAN8_BK" AS "ABAN8_FK_SHAN8_BK"
		, "EXT_UNION"."MCMCU_FK_SHMCU_BK" AS "MCMCU_FK_SHMCU_BK"
		, "EXT_UNION"."SHSFXO" AS "SHSFXO"
		, "EXT_UNION"."SHCO" AS "SHCO"
		, "EXT_UNION"."SHOKCO" AS "SHOKCO"
		, "EXT_UNION"."SHOORN" AS "SHOORN"
		, "EXT_UNION"."SHOCTO" AS "SHOCTO"
		, "EXT_UNION"."SHRKCO" AS "SHRKCO"
		, "EXT_UNION"."SHRORN" AS "SHRORN"
		, "EXT_UNION"."SHRCTO" AS "SHRCTO"
		, "EXT_UNION"."SHSHAN" AS "SHSHAN"
		, "EXT_UNION"."SHPA8" AS "SHPA8"
		, "EXT_UNION"."SHDRQJ" AS "SHDRQJ"
		, "EXT_UNION"."SHTRDJ" AS "SHTRDJ"
		, "EXT_UNION"."SHPDDJ" AS "SHPDDJ"
		, "EXT_UNION"."SHOPDJ" AS "SHOPDJ"
		, "EXT_UNION"."SHADDJ" AS "SHADDJ"
		, "EXT_UNION"."SHCNDJ" AS "SHCNDJ"
		, "EXT_UNION"."SHPEFJ" AS "SHPEFJ"
		, "EXT_UNION"."SHPPDJ" AS "SHPPDJ"
		, "EXT_UNION"."SHVR01" AS "SHVR01"
		, "EXT_UNION"."SHVR02" AS "SHVR02"
		, "EXT_UNION"."SHDEL1" AS "SHDEL1"
		, "EXT_UNION"."SHDEL2" AS "SHDEL2"
		, "EXT_UNION"."SHINMG" AS "SHINMG"
		, "EXT_UNION"."SHPTC" AS "SHPTC"
		, "EXT_UNION"."SHRYIN" AS "SHRYIN"
		, "EXT_UNION"."SHASN" AS "SHASN"
		, "EXT_UNION"."SHPRGP" AS "SHPRGP"
		, "EXT_UNION"."SHTRDC" AS "SHTRDC"
		, "EXT_UNION"."SHPCRT" AS "SHPCRT"
		, "EXT_UNION"."SHTXA1" AS "SHTXA1"
		, "EXT_UNION"."SHEXR1" AS "SHEXR1"
		, "EXT_UNION"."SHTXCT" AS "SHTXCT"
		, "EXT_UNION"."SHATXT" AS "SHATXT"
		, "EXT_UNION"."SHPRIO" AS "SHPRIO"
		, "EXT_UNION"."SHBACK" AS "SHBACK"
		, "EXT_UNION"."SHSBAL" AS "SHSBAL"
		, "EXT_UNION"."SHHOLD" AS "SHHOLD"
		, "EXT_UNION"."SHPLST" AS "SHPLST"
		, "EXT_UNION"."SHINVC" AS "SHINVC"
		, "EXT_UNION"."SHNTR" AS "SHNTR"
		, "EXT_UNION"."SHANBY" AS "SHANBY"
		, "EXT_UNION"."SHCARS" AS "SHCARS"
		, "EXT_UNION"."SHMOT" AS "SHMOT"
		, "EXT_UNION"."SHCOT" AS "SHCOT"
		, "EXT_UNION"."SHROUT" AS "SHROUT"
		, "EXT_UNION"."SHSTOP" AS "SHSTOP"
		, "EXT_UNION"."SHZON" AS "SHZON"
		, "EXT_UNION"."SHCNID" AS "SHCNID"
		, "EXT_UNION"."SHFRTH" AS "SHFRTH"
		, "EXT_UNION"."SHAFT" AS "SHAFT"
		, "EXT_UNION"."SHFUF1" AS "SHFUF1"
		, "EXT_UNION"."SHFRTC" AS "SHFRTC"
		, "EXT_UNION"."SHMORD" AS "SHMORD"
		, "EXT_UNION"."SHRCD" AS "SHRCD"
		, "EXT_UNION"."SHFUF2" AS "SHFUF2"
		, "EXT_UNION"."SHOTOT" AS "SHOTOT"
		, "EXT_UNION"."SHTOTC" AS "SHTOTC"
		, "EXT_UNION"."SHWUMD" AS "SHWUMD"
		, "EXT_UNION"."SHVUMD" AS "SHVUMD"
		, "EXT_UNION"."SHAUTN" AS "SHAUTN"
		, "EXT_UNION"."SHCACT" AS "SHCACT"
		, "EXT_UNION"."SHCEXP" AS "SHCEXP"
		, "EXT_UNION"."SHSBLI" AS "SHSBLI"
		, "EXT_UNION"."SHCRMD" AS "SHCRMD"
		, "EXT_UNION"."SHCRRM" AS "SHCRRM"
		, "EXT_UNION"."SHCRCD" AS "SHCRCD"
		, "EXT_UNION"."SHCRR" AS "SHCRR"
		, "EXT_UNION"."SHLNGP" AS "SHLNGP"
		, "EXT_UNION"."SHFAP" AS "SHFAP"
		, "EXT_UNION"."SHFCST" AS "SHFCST"
		, "EXT_UNION"."SHORBY" AS "SHORBY"
		, "EXT_UNION"."SHTKBY" AS "SHTKBY"
		, "EXT_UNION"."SHURCD" AS "SHURCD"
		, "EXT_UNION"."SHURDT" AS "SHURDT"
		, "EXT_UNION"."SHURAT" AS "SHURAT"
		, "EXT_UNION"."SHURAB" AS "SHURAB"
		, "EXT_UNION"."SHURRF" AS "SHURRF"
		, "EXT_UNION"."SHUSER" AS "SHUSER"
		, "EXT_UNION"."SHPID" AS "SHPID"
		, "EXT_UNION"."SHJOBN" AS "SHJOBN"
		, "EXT_UNION"."SHUPMJ" AS "SHUPMJ"
		, "EXT_UNION"."SHTDAY" AS "SHTDAY"
		, "EXT_UNION"."SHIR01" AS "SHIR01"
		, "EXT_UNION"."SHIR02" AS "SHIR02"
		, "EXT_UNION"."SHIR03" AS "SHIR03"
		, "EXT_UNION"."SHIR04" AS "SHIR04"
		, "EXT_UNION"."SHIR05" AS "SHIR05"
		, "EXT_UNION"."SHVR03" AS "SHVR03"
		, "EXT_UNION"."SHSOOR" AS "SHSOOR"
		, "EXT_UNION"."SHPMDT" AS "SHPMDT"
		, "EXT_UNION"."SHRSDT" AS "SHRSDT"
		, "EXT_UNION"."SHRQSJ" AS "SHRQSJ"
		, "EXT_UNION"."SHPSTM" AS "SHPSTM"
		, "EXT_UNION"."SHPDTT" AS "SHPDTT"
		, "EXT_UNION"."SHOPTT" AS "SHOPTT"
		, "EXT_UNION"."SHDRQT" AS "SHDRQT"
		, "EXT_UNION"."SHADTM" AS "SHADTM"
		, "EXT_UNION"."SHADLJ" AS "SHADLJ"
		, "EXT_UNION"."SHPBAN" AS "SHPBAN"
		, "EXT_UNION"."SHITAN" AS "SHITAN"
		, "EXT_UNION"."SHFTAN" AS "SHFTAN"
		, "EXT_UNION"."SHDVAN" AS "SHDVAN"
		, "EXT_UNION"."SHDOC1" AS "SHDOC1"
		, "EXT_UNION"."SHDCT4" AS "SHDCT4"
		, "EXT_UNION"."SHCORD" AS "SHCORD"
		, "EXT_UNION"."SHBSC" AS "SHBSC"
		, "EXT_UNION"."SHBCRC" AS "SHBCRC"
		, "EXT_UNION"."SHAUFT" AS "SHAUFT"
		, "EXT_UNION"."SHAUFI" AS "SHAUFI"
		, "EXT_UNION"."SHOPBO" AS "SHOPBO"
		, "EXT_UNION"."SHOPTC" AS "SHOPTC"
		, "EXT_UNION"."SHOPLD" AS "SHOPLD"
		, "EXT_UNION"."SHOPBK" AS "SHOPBK"
		, "EXT_UNION"."SHOPSB" AS "SHOPSB"
		, "EXT_UNION"."SHOPPS" AS "SHOPPS"
		, "EXT_UNION"."SHOPPL" AS "SHOPPL"
		, "EXT_UNION"."SHOPMS" AS "SHOPMS"
		, "EXT_UNION"."SHOPSS" AS "SHOPSS"
		, "EXT_UNION"."SHOPBA" AS "SHOPBA"
		, "EXT_UNION"."SHOPLL" AS "SHOPLL"
		, "EXT_UNION"."SHPRAN8" AS "SHPRAN8"
		, "EXT_UNION"."SHOPPID" AS "SHOPPID"
		, "EXT_UNION"."SHSDATTN" AS "SHSDATTN"
		, "EXT_UNION"."SHSPATTN" AS "SHSPATTN"
		, "EXT_UNION"."SHOTIND" AS "SHOTIND"
		, "EXT_UNION"."SHPRCIDLN" AS "SHPRCIDLN"
		, "EXT_UNION"."SHCCIDLN" AS "SHCCIDLN"
		, "EXT_UNION"."SHSHCCIDLN" AS "SHSHCCIDLN"
	FROM "EXT_UNION" "EXT_UNION"

) final 
where '{{ var("load_type") }}' = 'INCR' and '{{ var("source") }}' = 'JDEDWARDS'

UNION ALL

select * from (
	WITH "LOAD_INIT_DATA" AS 
	( 
		SELECT 
			  TO_CHAR('I' ) AS "JRN_FLAG"
			, TO_CHAR('S') AS "RECORD_TYPE"
			, COALESCE("INI_SRC"."SHKCOO", CAST("MEX_INR_SRC"."KEY_ATTRIBUTE_VARCHAR" AS VARCHAR)) AS "SHKCOO"
			, COALESCE("INI_SRC"."SHDOCO", CAST("MEX_INR_SRC"."KEY_ATTRIBUTE_FLOAT" AS FLOAT)) AS "SHDOCO"
			, COALESCE("INI_SRC"."SHDCTO", CAST("MEX_INR_SRC"."KEY_ATTRIBUTE_VARCHAR" AS VARCHAR)) AS "SHDCTO"
			, COALESCE("INI_SRC"."SHAN8", CAST("MEX_INR_SRC"."KEY_ATTRIBUTE_FLOAT" AS FLOAT)) AS "SHAN8"
			, COALESCE("INI_SRC"."SHMCU", CAST("MEX_INR_SRC"."KEY_ATTRIBUTE_VARCHAR" AS VARCHAR)) AS "SHMCU"
			, "INI_SRC"."SHSFXO" AS "SHSFXO"
			, "INI_SRC"."SHCO" AS "SHCO"
			, "INI_SRC"."SHOKCO" AS "SHOKCO"
			, "INI_SRC"."SHOORN" AS "SHOORN"
			, "INI_SRC"."SHOCTO" AS "SHOCTO"
			, "INI_SRC"."SHRKCO" AS "SHRKCO"
			, "INI_SRC"."SHRORN" AS "SHRORN"
			, "INI_SRC"."SHRCTO" AS "SHRCTO"
			, "INI_SRC"."SHSHAN" AS "SHSHAN"
			, "INI_SRC"."SHPA8" AS "SHPA8"
			, "INI_SRC"."SHDRQJ" AS "SHDRQJ"
			, "INI_SRC"."SHTRDJ" AS "SHTRDJ"
			, "INI_SRC"."SHPDDJ" AS "SHPDDJ"
			, "INI_SRC"."SHOPDJ" AS "SHOPDJ"
			, "INI_SRC"."SHADDJ" AS "SHADDJ"
			, "INI_SRC"."SHCNDJ" AS "SHCNDJ"
			, "INI_SRC"."SHPEFJ" AS "SHPEFJ"
			, "INI_SRC"."SHPPDJ" AS "SHPPDJ"
			, "INI_SRC"."SHVR01" AS "SHVR01"
			, "INI_SRC"."SHVR02" AS "SHVR02"
			, "INI_SRC"."SHDEL1" AS "SHDEL1"
			, "INI_SRC"."SHDEL2" AS "SHDEL2"
			, "INI_SRC"."SHINMG" AS "SHINMG"
			, "INI_SRC"."SHPTC" AS "SHPTC"
			, "INI_SRC"."SHRYIN" AS "SHRYIN"
			, "INI_SRC"."SHASN" AS "SHASN"
			, "INI_SRC"."SHPRGP" AS "SHPRGP"
			, "INI_SRC"."SHTRDC" AS "SHTRDC"
			, "INI_SRC"."SHPCRT" AS "SHPCRT"
			, "INI_SRC"."SHTXA1" AS "SHTXA1"
			, "INI_SRC"."SHEXR1" AS "SHEXR1"
			, "INI_SRC"."SHTXCT" AS "SHTXCT"
			, "INI_SRC"."SHATXT" AS "SHATXT"
			, "INI_SRC"."SHPRIO" AS "SHPRIO"
			, "INI_SRC"."SHBACK" AS "SHBACK"
			, "INI_SRC"."SHSBAL" AS "SHSBAL"
			, "INI_SRC"."SHHOLD" AS "SHHOLD"
			, "INI_SRC"."SHPLST" AS "SHPLST"
			, "INI_SRC"."SHINVC" AS "SHINVC"
			, "INI_SRC"."SHNTR" AS "SHNTR"
			, "INI_SRC"."SHANBY" AS "SHANBY"
			, "INI_SRC"."SHCARS" AS "SHCARS"
			, "INI_SRC"."SHMOT" AS "SHMOT"
			, "INI_SRC"."SHCOT" AS "SHCOT"
			, "INI_SRC"."SHROUT" AS "SHROUT"
			, "INI_SRC"."SHSTOP" AS "SHSTOP"
			, "INI_SRC"."SHZON" AS "SHZON"
			, "INI_SRC"."SHCNID" AS "SHCNID"
			, "INI_SRC"."SHFRTH" AS "SHFRTH"
			, "INI_SRC"."SHAFT" AS "SHAFT"
			, "INI_SRC"."SHFUF1" AS "SHFUF1"
			, "INI_SRC"."SHFRTC" AS "SHFRTC"
			, "INI_SRC"."SHMORD" AS "SHMORD"
			, "INI_SRC"."SHRCD" AS "SHRCD"
			, "INI_SRC"."SHFUF2" AS "SHFUF2"
			, "INI_SRC"."SHOTOT" AS "SHOTOT"
			, "INI_SRC"."SHTOTC" AS "SHTOTC"
			, "INI_SRC"."SHWUMD" AS "SHWUMD"
			, "INI_SRC"."SHVUMD" AS "SHVUMD"
			, "INI_SRC"."SHAUTN" AS "SHAUTN"
			, "INI_SRC"."SHCACT" AS "SHCACT"
			, "INI_SRC"."SHCEXP" AS "SHCEXP"
			, "INI_SRC"."SHSBLI" AS "SHSBLI"
			, "INI_SRC"."SHCRMD" AS "SHCRMD"
			, "INI_SRC"."SHCRRM" AS "SHCRRM"
			, "INI_SRC"."SHCRCD" AS "SHCRCD"
			, "INI_SRC"."SHCRR" AS "SHCRR"
			, "INI_SRC"."SHLNGP" AS "SHLNGP"
			, "INI_SRC"."SHFAP" AS "SHFAP"
			, "INI_SRC"."SHFCST" AS "SHFCST"
			, "INI_SRC"."SHORBY" AS "SHORBY"
			, "INI_SRC"."SHTKBY" AS "SHTKBY"
			, "INI_SRC"."SHURCD" AS "SHURCD"
			, "INI_SRC"."SHURDT" AS "SHURDT"
			, "INI_SRC"."SHURAT" AS "SHURAT"
			, "INI_SRC"."SHURAB" AS "SHURAB"
			, "INI_SRC"."SHURRF" AS "SHURRF"
			, "INI_SRC"."SHUSER" AS "SHUSER"
			, "INI_SRC"."SHPID" AS "SHPID"
			, "INI_SRC"."SHJOBN" AS "SHJOBN"
			, "INI_SRC"."SHUPMJ" AS "SHUPMJ"
			, "INI_SRC"."SHTDAY" AS "SHTDAY"
			, "INI_SRC"."SHIR01" AS "SHIR01"
			, "INI_SRC"."SHIR02" AS "SHIR02"
			, "INI_SRC"."SHIR03" AS "SHIR03"
			, "INI_SRC"."SHIR04" AS "SHIR04"
			, "INI_SRC"."SHIR05" AS "SHIR05"
			, "INI_SRC"."SHVR03" AS "SHVR03"
			, "INI_SRC"."SHSOOR" AS "SHSOOR"
			, "INI_SRC"."SHPMDT" AS "SHPMDT"
			, "INI_SRC"."SHRSDT" AS "SHRSDT"
			, "INI_SRC"."SHRQSJ" AS "SHRQSJ"
			, "INI_SRC"."SHPSTM" AS "SHPSTM"
			, "INI_SRC"."SHPDTT" AS "SHPDTT"
			, "INI_SRC"."SHOPTT" AS "SHOPTT"
			, "INI_SRC"."SHDRQT" AS "SHDRQT"
			, "INI_SRC"."SHADTM" AS "SHADTM"
			, "INI_SRC"."SHADLJ" AS "SHADLJ"
			, "INI_SRC"."SHPBAN" AS "SHPBAN"
			, "INI_SRC"."SHITAN" AS "SHITAN"
			, "INI_SRC"."SHFTAN" AS "SHFTAN"
			, "INI_SRC"."SHDVAN" AS "SHDVAN"
			, "INI_SRC"."SHDOC1" AS "SHDOC1"
			, "INI_SRC"."SHDCT4" AS "SHDCT4"
			, "INI_SRC"."SHCORD" AS "SHCORD"
			, "INI_SRC"."SHBSC" AS "SHBSC"
			, "INI_SRC"."SHBCRC" AS "SHBCRC"
			, "INI_SRC"."SHAUFT" AS "SHAUFT"
			, "INI_SRC"."SHAUFI" AS "SHAUFI"
			, "INI_SRC"."SHOPBO" AS "SHOPBO"
			, "INI_SRC"."SHOPTC" AS "SHOPTC"
			, "INI_SRC"."SHOPLD" AS "SHOPLD"
			, "INI_SRC"."SHOPBK" AS "SHOPBK"
			, "INI_SRC"."SHOPSB" AS "SHOPSB"
			, "INI_SRC"."SHOPPS" AS "SHOPPS"
			, "INI_SRC"."SHOPPL" AS "SHOPPL"
			, "INI_SRC"."SHOPMS" AS "SHOPMS"
			, "INI_SRC"."SHOPSS" AS "SHOPSS"
			, "INI_SRC"."SHOPBA" AS "SHOPBA"
			, "INI_SRC"."SHOPLL" AS "SHOPLL"
			, "INI_SRC"."SHPRAN8" AS "SHPRAN8"
			, "INI_SRC"."SHOPPID" AS "SHOPPID"
			, "INI_SRC"."SHSDATTN" AS "SHSDATTN"
			, "INI_SRC"."SHSPATTN" AS "SHSPATTN"
			, "INI_SRC"."SHOTIND" AS "SHOTIND"
			, "INI_SRC"."SHPRCIDLN" AS "SHPRCIDLN"
			, "INI_SRC"."SHCCIDLN" AS "SHCCIDLN"
			, "INI_SRC"."SHSHCCIDLN" AS "SHSHCCIDLN"
		FROM {{ source('JDEDWARDS_INI', 'F42019') }} "INI_SRC"
		INNER JOIN {{ source('JDEDWARDS_MTD', 'MTD_EXCEPTION_RECORDS') }} "MEX_INR_SRC" ON  "MEX_INR_SRC"."RECORD_TYPE" = 'N'
	)
	, "PREP_EXCEP" AS 
	( 
		SELECT 
			  "LOAD_INIT_DATA"."JRN_FLAG" AS "JRN_FLAG"
			, "LOAD_INIT_DATA"."RECORD_TYPE" AS "RECORD_TYPE"
			, NULL AS "LOAD_CYCLE_ID"
			, "LOAD_INIT_DATA"."SHKCOO" AS "SHKCOO"
			, "LOAD_INIT_DATA"."SHDOCO" AS "SHDOCO"
			, "LOAD_INIT_DATA"."SHDCTO" AS "SHDCTO"
			, "LOAD_INIT_DATA"."SHMCU" AS "SHMCU"
			, "LOAD_INIT_DATA"."SHAN8" AS "SHAN8"
			, "LOAD_INIT_DATA"."SHSFXO" AS "SHSFXO"
			, "LOAD_INIT_DATA"."SHCO" AS "SHCO"
			, "LOAD_INIT_DATA"."SHOKCO" AS "SHOKCO"
			, "LOAD_INIT_DATA"."SHOORN" AS "SHOORN"
			, "LOAD_INIT_DATA"."SHOCTO" AS "SHOCTO"
			, "LOAD_INIT_DATA"."SHRKCO" AS "SHRKCO"
			, "LOAD_INIT_DATA"."SHRORN" AS "SHRORN"
			, "LOAD_INIT_DATA"."SHRCTO" AS "SHRCTO"
			, "LOAD_INIT_DATA"."SHSHAN" AS "SHSHAN"
			, "LOAD_INIT_DATA"."SHPA8" AS "SHPA8"
			, "LOAD_INIT_DATA"."SHDRQJ" AS "SHDRQJ"
			, "LOAD_INIT_DATA"."SHTRDJ" AS "SHTRDJ"
			, "LOAD_INIT_DATA"."SHPDDJ" AS "SHPDDJ"
			, "LOAD_INIT_DATA"."SHOPDJ" AS "SHOPDJ"
			, "LOAD_INIT_DATA"."SHADDJ" AS "SHADDJ"
			, "LOAD_INIT_DATA"."SHCNDJ" AS "SHCNDJ"
			, "LOAD_INIT_DATA"."SHPEFJ" AS "SHPEFJ"
			, "LOAD_INIT_DATA"."SHPPDJ" AS "SHPPDJ"
			, "LOAD_INIT_DATA"."SHVR01" AS "SHVR01"
			, "LOAD_INIT_DATA"."SHVR02" AS "SHVR02"
			, "LOAD_INIT_DATA"."SHDEL1" AS "SHDEL1"
			, "LOAD_INIT_DATA"."SHDEL2" AS "SHDEL2"
			, "LOAD_INIT_DATA"."SHINMG" AS "SHINMG"
			, "LOAD_INIT_DATA"."SHPTC" AS "SHPTC"
			, "LOAD_INIT_DATA"."SHRYIN" AS "SHRYIN"
			, "LOAD_INIT_DATA"."SHASN" AS "SHASN"
			, "LOAD_INIT_DATA"."SHPRGP" AS "SHPRGP"
			, "LOAD_INIT_DATA"."SHTRDC" AS "SHTRDC"
			, "LOAD_INIT_DATA"."SHPCRT" AS "SHPCRT"
			, "LOAD_INIT_DATA"."SHTXA1" AS "SHTXA1"
			, "LOAD_INIT_DATA"."SHEXR1" AS "SHEXR1"
			, "LOAD_INIT_DATA"."SHTXCT" AS "SHTXCT"
			, "LOAD_INIT_DATA"."SHATXT" AS "SHATXT"
			, "LOAD_INIT_DATA"."SHPRIO" AS "SHPRIO"
			, "LOAD_INIT_DATA"."SHBACK" AS "SHBACK"
			, "LOAD_INIT_DATA"."SHSBAL" AS "SHSBAL"
			, "LOAD_INIT_DATA"."SHHOLD" AS "SHHOLD"
			, "LOAD_INIT_DATA"."SHPLST" AS "SHPLST"
			, "LOAD_INIT_DATA"."SHINVC" AS "SHINVC"
			, "LOAD_INIT_DATA"."SHNTR" AS "SHNTR"
			, "LOAD_INIT_DATA"."SHANBY" AS "SHANBY"
			, "LOAD_INIT_DATA"."SHCARS" AS "SHCARS"
			, "LOAD_INIT_DATA"."SHMOT" AS "SHMOT"
			, "LOAD_INIT_DATA"."SHCOT" AS "SHCOT"
			, "LOAD_INIT_DATA"."SHROUT" AS "SHROUT"
			, "LOAD_INIT_DATA"."SHSTOP" AS "SHSTOP"
			, "LOAD_INIT_DATA"."SHZON" AS "SHZON"
			, "LOAD_INIT_DATA"."SHCNID" AS "SHCNID"
			, "LOAD_INIT_DATA"."SHFRTH" AS "SHFRTH"
			, "LOAD_INIT_DATA"."SHAFT" AS "SHAFT"
			, "LOAD_INIT_DATA"."SHFUF1" AS "SHFUF1"
			, "LOAD_INIT_DATA"."SHFRTC" AS "SHFRTC"
			, "LOAD_INIT_DATA"."SHMORD" AS "SHMORD"
			, "LOAD_INIT_DATA"."SHRCD" AS "SHRCD"
			, "LOAD_INIT_DATA"."SHFUF2" AS "SHFUF2"
			, "LOAD_INIT_DATA"."SHOTOT" AS "SHOTOT"
			, "LOAD_INIT_DATA"."SHTOTC" AS "SHTOTC"
			, "LOAD_INIT_DATA"."SHWUMD" AS "SHWUMD"
			, "LOAD_INIT_DATA"."SHVUMD" AS "SHVUMD"
			, "LOAD_INIT_DATA"."SHAUTN" AS "SHAUTN"
			, "LOAD_INIT_DATA"."SHCACT" AS "SHCACT"
			, "LOAD_INIT_DATA"."SHCEXP" AS "SHCEXP"
			, "LOAD_INIT_DATA"."SHSBLI" AS "SHSBLI"
			, "LOAD_INIT_DATA"."SHCRMD" AS "SHCRMD"
			, "LOAD_INIT_DATA"."SHCRRM" AS "SHCRRM"
			, "LOAD_INIT_DATA"."SHCRCD" AS "SHCRCD"
			, "LOAD_INIT_DATA"."SHCRR" AS "SHCRR"
			, "LOAD_INIT_DATA"."SHLNGP" AS "SHLNGP"
			, "LOAD_INIT_DATA"."SHFAP" AS "SHFAP"
			, "LOAD_INIT_DATA"."SHFCST" AS "SHFCST"
			, "LOAD_INIT_DATA"."SHORBY" AS "SHORBY"
			, "LOAD_INIT_DATA"."SHTKBY" AS "SHTKBY"
			, "LOAD_INIT_DATA"."SHURCD" AS "SHURCD"
			, "LOAD_INIT_DATA"."SHURDT" AS "SHURDT"
			, "LOAD_INIT_DATA"."SHURAT" AS "SHURAT"
			, "LOAD_INIT_DATA"."SHURAB" AS "SHURAB"
			, "LOAD_INIT_DATA"."SHURRF" AS "SHURRF"
			, "LOAD_INIT_DATA"."SHUSER" AS "SHUSER"
			, "LOAD_INIT_DATA"."SHPID" AS "SHPID"
			, "LOAD_INIT_DATA"."SHJOBN" AS "SHJOBN"
			, "LOAD_INIT_DATA"."SHUPMJ" AS "SHUPMJ"
			, "LOAD_INIT_DATA"."SHTDAY" AS "SHTDAY"
			, "LOAD_INIT_DATA"."SHIR01" AS "SHIR01"
			, "LOAD_INIT_DATA"."SHIR02" AS "SHIR02"
			, "LOAD_INIT_DATA"."SHIR03" AS "SHIR03"
			, "LOAD_INIT_DATA"."SHIR04" AS "SHIR04"
			, "LOAD_INIT_DATA"."SHIR05" AS "SHIR05"
			, "LOAD_INIT_DATA"."SHVR03" AS "SHVR03"
			, "LOAD_INIT_DATA"."SHSOOR" AS "SHSOOR"
			, "LOAD_INIT_DATA"."SHPMDT" AS "SHPMDT"
			, "LOAD_INIT_DATA"."SHRSDT" AS "SHRSDT"
			, "LOAD_INIT_DATA"."SHRQSJ" AS "SHRQSJ"
			, "LOAD_INIT_DATA"."SHPSTM" AS "SHPSTM"
			, "LOAD_INIT_DATA"."SHPDTT" AS "SHPDTT"
			, "LOAD_INIT_DATA"."SHOPTT" AS "SHOPTT"
			, "LOAD_INIT_DATA"."SHDRQT" AS "SHDRQT"
			, "LOAD_INIT_DATA"."SHADTM" AS "SHADTM"
			, "LOAD_INIT_DATA"."SHADLJ" AS "SHADLJ"
			, "LOAD_INIT_DATA"."SHPBAN" AS "SHPBAN"
			, "LOAD_INIT_DATA"."SHITAN" AS "SHITAN"
			, "LOAD_INIT_DATA"."SHFTAN" AS "SHFTAN"
			, "LOAD_INIT_DATA"."SHDVAN" AS "SHDVAN"
			, "LOAD_INIT_DATA"."SHDOC1" AS "SHDOC1"
			, "LOAD_INIT_DATA"."SHDCT4" AS "SHDCT4"
			, "LOAD_INIT_DATA"."SHCORD" AS "SHCORD"
			, "LOAD_INIT_DATA"."SHBSC" AS "SHBSC"
			, "LOAD_INIT_DATA"."SHBCRC" AS "SHBCRC"
			, "LOAD_INIT_DATA"."SHAUFT" AS "SHAUFT"
			, "LOAD_INIT_DATA"."SHAUFI" AS "SHAUFI"
			, "LOAD_INIT_DATA"."SHOPBO" AS "SHOPBO"
			, "LOAD_INIT_DATA"."SHOPTC" AS "SHOPTC"
			, "LOAD_INIT_DATA"."SHOPLD" AS "SHOPLD"
			, "LOAD_INIT_DATA"."SHOPBK" AS "SHOPBK"
			, "LOAD_INIT_DATA"."SHOPSB" AS "SHOPSB"
			, "LOAD_INIT_DATA"."SHOPPS" AS "SHOPPS"
			, "LOAD_INIT_DATA"."SHOPPL" AS "SHOPPL"
			, "LOAD_INIT_DATA"."SHOPMS" AS "SHOPMS"
			, "LOAD_INIT_DATA"."SHOPSS" AS "SHOPSS"
			, "LOAD_INIT_DATA"."SHOPBA" AS "SHOPBA"
			, "LOAD_INIT_DATA"."SHOPLL" AS "SHOPLL"
			, "LOAD_INIT_DATA"."SHPRAN8" AS "SHPRAN8"
			, "LOAD_INIT_DATA"."SHOPPID" AS "SHOPPID"
			, "LOAD_INIT_DATA"."SHSDATTN" AS "SHSDATTN"
			, "LOAD_INIT_DATA"."SHSPATTN" AS "SHSPATTN"
			, "LOAD_INIT_DATA"."SHOTIND" AS "SHOTIND"
			, "LOAD_INIT_DATA"."SHPRCIDLN" AS "SHPRCIDLN"
			, "LOAD_INIT_DATA"."SHCCIDLN" AS "SHCCIDLN"
			, "LOAD_INIT_DATA"."SHSHCCIDLN" AS "SHSHCCIDLN"
		FROM "LOAD_INIT_DATA" "LOAD_INIT_DATA"
		UNION ALL 
		SELECT 
			  TO_CHAR('I' ) AS "JRN_FLAG"
			, "MEX_EXT_SRC"."RECORD_TYPE" AS "RECORD_TYPE"
			, "MEX_EXT_SRC"."LOAD_CYCLE_ID" ::integer AS "LOAD_CYCLE_ID"
			, CAST("MEX_EXT_SRC"."KEY_ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHKCOO"
			, CAST("MEX_EXT_SRC"."KEY_ATTRIBUTE_FLOAT" AS FLOAT) AS "SHDOCO"
			, CAST("MEX_EXT_SRC"."KEY_ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHDCTO"
			, CAST("MEX_EXT_SRC"."KEY_ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHMCU"
			, CAST("MEX_EXT_SRC"."KEY_ATTRIBUTE_FLOAT" AS FLOAT) AS "SHAN8"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHSFXO"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHCO"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHOKCO"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHOORN"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHOCTO"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHRKCO"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHRORN"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHRCTO"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "SHSHAN"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "SHPA8"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_NUMBER" AS NUMBER) AS "SHDRQJ"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_NUMBER" AS NUMBER) AS "SHTRDJ"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_NUMBER" AS NUMBER) AS "SHPDDJ"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_NUMBER" AS NUMBER) AS "SHOPDJ"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_NUMBER" AS NUMBER) AS "SHADDJ"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_NUMBER" AS NUMBER) AS "SHCNDJ"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_NUMBER" AS NUMBER) AS "SHPEFJ"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_NUMBER" AS NUMBER) AS "SHPPDJ"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHVR01"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHVR02"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHDEL1"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHDEL2"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHINMG"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHPTC"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHRYIN"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHASN"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHPRGP"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "SHTRDC"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "SHPCRT"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHTXA1"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHEXR1"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHTXCT"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHATXT"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHPRIO"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHBACK"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHSBAL"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHHOLD"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHPLST"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "SHINVC"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHNTR"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "SHANBY"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "SHCARS"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHMOT"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHCOT"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHROUT"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHSTOP"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHZON"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHCNID"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHFRTH"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHAFT"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHFUF1"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHFRTC"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHMORD"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHRCD"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHFUF2"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "SHOTOT"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "SHTOTC"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHWUMD"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHVUMD"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHAUTN"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHCACT"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_NUMBER" AS NUMBER) AS "SHCEXP"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHSBLI"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHCRMD"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHCRRM"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHCRCD"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "SHCRR"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHLNGP"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "SHFAP"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "SHFCST"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHORBY"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHTKBY"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHURCD"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_NUMBER" AS NUMBER) AS "SHURDT"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "SHURAT"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "SHURAB"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHURRF"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHUSER"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHPID"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHJOBN"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_NUMBER" AS NUMBER) AS "SHUPMJ"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "SHTDAY"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHIR01"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHIR02"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHIR03"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHIR04"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHIR05"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHVR03"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_NUMBER" AS NUMBER) AS "SHSOOR"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "SHPMDT"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "SHRSDT"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_NUMBER" AS NUMBER) AS "SHRQSJ"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "SHPSTM"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "SHPDTT"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "SHOPTT"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "SHDRQT"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "SHADTM"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_NUMBER" AS NUMBER) AS "SHADLJ"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "SHPBAN"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "SHITAN"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "SHFTAN"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "SHDVAN"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "SHDOC1"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHDCT4"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "SHCORD"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHBSC"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHBCRC"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHAUFT"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHAUFI"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHOPBO"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "SHOPTC"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_NUMBER" AS NUMBER) AS "SHOPLD"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "SHOPBK"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "SHOPSB"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHOPPS"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHOPPL"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHOPMS"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHOPSS"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHOPBA"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHOPLL"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "SHPRAN8"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "SHOPPID"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHSDATTN"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHSPATTN"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "SHOTIND"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "SHPRCIDLN"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "SHCCIDLN"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "SHSHCCIDLN"
		FROM {{ source('JDEDWARDS_MTD', 'MTD_EXCEPTION_RECORDS') }} "MEX_EXT_SRC"
	)
	, "CALCULATE_BK" AS 
	( 
		SELECT 
			  COALESCE("PREP_EXCEP"."LOAD_CYCLE_ID","LCI_SRC"."LOAD_CYCLE_ID") AS "LOAD_CYCLE_ID"
			, "LCI_SRC"."LOAD_DATE" AS "LOAD_DATE"
			, "LCI_SRC"."LOAD_DATE" AS "CDC_TIMESTAMP"
			, "PREP_EXCEP"."JRN_FLAG" AS "JRN_FLAG"
			, "PREP_EXCEP"."RECORD_TYPE" AS "RECORD_TYPE"
			, "PREP_EXCEP"."SHKCOO" AS "SHKCOO"
			, "PREP_EXCEP"."SHDOCO" AS "SHDOCO"
			, "PREP_EXCEP"."SHDCTO" AS "SHDCTO"
			, "PREP_EXCEP"."SHMCU" AS "SHMCU"
			, "PREP_EXCEP"."SHAN8" AS "SHAN8"
			, COALESCE(UPPER( TO_CHAR("PREP_EXCEP"."SHDOCO")),"MEX_SRC"."KEY_ATTRIBUTE_FLOAT") AS "SHDOCO_BK"
			, COALESCE(REPLACE(TRIM("PREP_EXCEP"."SHDCTO"),'\#','\\' || '\#'),"MEX_SRC"."KEY_ATTRIBUTE_VARCHAR") AS "SHDCTO_BK"
			, COALESCE(REPLACE(TRIM("PREP_EXCEP"."SHKCOO"),'\#','\\' || '\#'),"MEX_SRC"."KEY_ATTRIBUTE_VARCHAR") AS "SHKCOO_BK"
			, UPPER( TO_CHAR("PREP_EXCEP"."SHAN8")) AS "ABAN8_FK_SHAN8_BK"
			, REPLACE(TRIM("PREP_EXCEP"."SHMCU"),'\#','\\' || '\#') AS "MCMCU_FK_SHMCU_BK"
			, "PREP_EXCEP"."SHSFXO" AS "SHSFXO"
			, "PREP_EXCEP"."SHCO" AS "SHCO"
			, "PREP_EXCEP"."SHOKCO" AS "SHOKCO"
			, "PREP_EXCEP"."SHOORN" AS "SHOORN"
			, "PREP_EXCEP"."SHOCTO" AS "SHOCTO"
			, "PREP_EXCEP"."SHRKCO" AS "SHRKCO"
			, "PREP_EXCEP"."SHRORN" AS "SHRORN"
			, "PREP_EXCEP"."SHRCTO" AS "SHRCTO"
			, "PREP_EXCEP"."SHSHAN" AS "SHSHAN"
			, "PREP_EXCEP"."SHPA8" AS "SHPA8"
			, "PREP_EXCEP"."SHDRQJ" AS "SHDRQJ"
			, "PREP_EXCEP"."SHTRDJ" AS "SHTRDJ"
			, "PREP_EXCEP"."SHPDDJ" AS "SHPDDJ"
			, "PREP_EXCEP"."SHOPDJ" AS "SHOPDJ"
			, "PREP_EXCEP"."SHADDJ" AS "SHADDJ"
			, "PREP_EXCEP"."SHCNDJ" AS "SHCNDJ"
			, "PREP_EXCEP"."SHPEFJ" AS "SHPEFJ"
			, "PREP_EXCEP"."SHPPDJ" AS "SHPPDJ"
			, "PREP_EXCEP"."SHVR01" AS "SHVR01"
			, "PREP_EXCEP"."SHVR02" AS "SHVR02"
			, "PREP_EXCEP"."SHDEL1" AS "SHDEL1"
			, "PREP_EXCEP"."SHDEL2" AS "SHDEL2"
			, "PREP_EXCEP"."SHINMG" AS "SHINMG"
			, "PREP_EXCEP"."SHPTC" AS "SHPTC"
			, "PREP_EXCEP"."SHRYIN" AS "SHRYIN"
			, "PREP_EXCEP"."SHASN" AS "SHASN"
			, "PREP_EXCEP"."SHPRGP" AS "SHPRGP"
			, "PREP_EXCEP"."SHTRDC" AS "SHTRDC"
			, "PREP_EXCEP"."SHPCRT" AS "SHPCRT"
			, "PREP_EXCEP"."SHTXA1" AS "SHTXA1"
			, "PREP_EXCEP"."SHEXR1" AS "SHEXR1"
			, "PREP_EXCEP"."SHTXCT" AS "SHTXCT"
			, "PREP_EXCEP"."SHATXT" AS "SHATXT"
			, "PREP_EXCEP"."SHPRIO" AS "SHPRIO"
			, "PREP_EXCEP"."SHBACK" AS "SHBACK"
			, "PREP_EXCEP"."SHSBAL" AS "SHSBAL"
			, "PREP_EXCEP"."SHHOLD" AS "SHHOLD"
			, "PREP_EXCEP"."SHPLST" AS "SHPLST"
			, "PREP_EXCEP"."SHINVC" AS "SHINVC"
			, "PREP_EXCEP"."SHNTR" AS "SHNTR"
			, "PREP_EXCEP"."SHANBY" AS "SHANBY"
			, "PREP_EXCEP"."SHCARS" AS "SHCARS"
			, "PREP_EXCEP"."SHMOT" AS "SHMOT"
			, "PREP_EXCEP"."SHCOT" AS "SHCOT"
			, "PREP_EXCEP"."SHROUT" AS "SHROUT"
			, "PREP_EXCEP"."SHSTOP" AS "SHSTOP"
			, "PREP_EXCEP"."SHZON" AS "SHZON"
			, "PREP_EXCEP"."SHCNID" AS "SHCNID"
			, "PREP_EXCEP"."SHFRTH" AS "SHFRTH"
			, "PREP_EXCEP"."SHAFT" AS "SHAFT"
			, "PREP_EXCEP"."SHFUF1" AS "SHFUF1"
			, "PREP_EXCEP"."SHFRTC" AS "SHFRTC"
			, "PREP_EXCEP"."SHMORD" AS "SHMORD"
			, "PREP_EXCEP"."SHRCD" AS "SHRCD"
			, "PREP_EXCEP"."SHFUF2" AS "SHFUF2"
			, "PREP_EXCEP"."SHOTOT" AS "SHOTOT"
			, "PREP_EXCEP"."SHTOTC" AS "SHTOTC"
			, "PREP_EXCEP"."SHWUMD" AS "SHWUMD"
			, "PREP_EXCEP"."SHVUMD" AS "SHVUMD"
			, "PREP_EXCEP"."SHAUTN" AS "SHAUTN"
			, "PREP_EXCEP"."SHCACT" AS "SHCACT"
			, "PREP_EXCEP"."SHCEXP" AS "SHCEXP"
			, "PREP_EXCEP"."SHSBLI" AS "SHSBLI"
			, "PREP_EXCEP"."SHCRMD" AS "SHCRMD"
			, "PREP_EXCEP"."SHCRRM" AS "SHCRRM"
			, "PREP_EXCEP"."SHCRCD" AS "SHCRCD"
			, "PREP_EXCEP"."SHCRR" AS "SHCRR"
			, "PREP_EXCEP"."SHLNGP" AS "SHLNGP"
			, "PREP_EXCEP"."SHFAP" AS "SHFAP"
			, "PREP_EXCEP"."SHFCST" AS "SHFCST"
			, "PREP_EXCEP"."SHORBY" AS "SHORBY"
			, "PREP_EXCEP"."SHTKBY" AS "SHTKBY"
			, "PREP_EXCEP"."SHURCD" AS "SHURCD"
			, "PREP_EXCEP"."SHURDT" AS "SHURDT"
			, "PREP_EXCEP"."SHURAT" AS "SHURAT"
			, "PREP_EXCEP"."SHURAB" AS "SHURAB"
			, "PREP_EXCEP"."SHURRF" AS "SHURRF"
			, "PREP_EXCEP"."SHUSER" AS "SHUSER"
			, "PREP_EXCEP"."SHPID" AS "SHPID"
			, "PREP_EXCEP"."SHJOBN" AS "SHJOBN"
			, "PREP_EXCEP"."SHUPMJ" AS "SHUPMJ"
			, "PREP_EXCEP"."SHTDAY" AS "SHTDAY"
			, "PREP_EXCEP"."SHIR01" AS "SHIR01"
			, "PREP_EXCEP"."SHIR02" AS "SHIR02"
			, "PREP_EXCEP"."SHIR03" AS "SHIR03"
			, "PREP_EXCEP"."SHIR04" AS "SHIR04"
			, "PREP_EXCEP"."SHIR05" AS "SHIR05"
			, "PREP_EXCEP"."SHVR03" AS "SHVR03"
			, "PREP_EXCEP"."SHSOOR" AS "SHSOOR"
			, "PREP_EXCEP"."SHPMDT" AS "SHPMDT"
			, "PREP_EXCEP"."SHRSDT" AS "SHRSDT"
			, "PREP_EXCEP"."SHRQSJ" AS "SHRQSJ"
			, "PREP_EXCEP"."SHPSTM" AS "SHPSTM"
			, "PREP_EXCEP"."SHPDTT" AS "SHPDTT"
			, "PREP_EXCEP"."SHOPTT" AS "SHOPTT"
			, "PREP_EXCEP"."SHDRQT" AS "SHDRQT"
			, "PREP_EXCEP"."SHADTM" AS "SHADTM"
			, "PREP_EXCEP"."SHADLJ" AS "SHADLJ"
			, "PREP_EXCEP"."SHPBAN" AS "SHPBAN"
			, "PREP_EXCEP"."SHITAN" AS "SHITAN"
			, "PREP_EXCEP"."SHFTAN" AS "SHFTAN"
			, "PREP_EXCEP"."SHDVAN" AS "SHDVAN"
			, "PREP_EXCEP"."SHDOC1" AS "SHDOC1"
			, "PREP_EXCEP"."SHDCT4" AS "SHDCT4"
			, "PREP_EXCEP"."SHCORD" AS "SHCORD"
			, "PREP_EXCEP"."SHBSC" AS "SHBSC"
			, "PREP_EXCEP"."SHBCRC" AS "SHBCRC"
			, "PREP_EXCEP"."SHAUFT" AS "SHAUFT"
			, "PREP_EXCEP"."SHAUFI" AS "SHAUFI"
			, "PREP_EXCEP"."SHOPBO" AS "SHOPBO"
			, "PREP_EXCEP"."SHOPTC" AS "SHOPTC"
			, "PREP_EXCEP"."SHOPLD" AS "SHOPLD"
			, "PREP_EXCEP"."SHOPBK" AS "SHOPBK"
			, "PREP_EXCEP"."SHOPSB" AS "SHOPSB"
			, "PREP_EXCEP"."SHOPPS" AS "SHOPPS"
			, "PREP_EXCEP"."SHOPPL" AS "SHOPPL"
			, "PREP_EXCEP"."SHOPMS" AS "SHOPMS"
			, "PREP_EXCEP"."SHOPSS" AS "SHOPSS"
			, "PREP_EXCEP"."SHOPBA" AS "SHOPBA"
			, "PREP_EXCEP"."SHOPLL" AS "SHOPLL"
			, "PREP_EXCEP"."SHPRAN8" AS "SHPRAN8"
			, "PREP_EXCEP"."SHOPPID" AS "SHOPPID"
			, "PREP_EXCEP"."SHSDATTN" AS "SHSDATTN"
			, "PREP_EXCEP"."SHSPATTN" AS "SHSPATTN"
			, "PREP_EXCEP"."SHOTIND" AS "SHOTIND"
			, "PREP_EXCEP"."SHPRCIDLN" AS "SHPRCIDLN"
			, "PREP_EXCEP"."SHCCIDLN" AS "SHCCIDLN"
			, "PREP_EXCEP"."SHSHCCIDLN" AS "SHSHCCIDLN"
		FROM "PREP_EXCEP" "PREP_EXCEP"
		INNER JOIN {{ source('JDEDWARDS_MTD', 'LOAD_CYCLE_INFO') }} "LCI_SRC" ON  1 = 1
		INNER JOIN {{ source('JDEDWARDS_MTD', 'MTD_EXCEPTION_RECORDS') }} "MEX_SRC" ON  1 = 1
		WHERE  "MEX_SRC"."RECORD_TYPE" = 'N'
	)
	SELECT 
		  "CALCULATE_BK"."LOAD_CYCLE_ID" AS "LOAD_CYCLE_ID"
		, "CALCULATE_BK"."LOAD_DATE" AS "LOAD_DATE"
		, "CALCULATE_BK"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP"
		, "CALCULATE_BK"."JRN_FLAG" AS "JRN_FLAG"
		, "CALCULATE_BK"."RECORD_TYPE" AS "RECORD_TYPE"
		, "CALCULATE_BK"."SHKCOO" AS "SHKCOO"
		, "CALCULATE_BK"."SHDOCO" AS "SHDOCO"
		, "CALCULATE_BK"."SHDCTO" AS "SHDCTO"
		, "CALCULATE_BK"."SHMCU" AS "SHMCU"
		, "CALCULATE_BK"."SHAN8" AS "SHAN8"
		, "CALCULATE_BK"."SHDOCO_BK" AS "SHDOCO_BK"
		, "CALCULATE_BK"."SHDCTO_BK" AS "SHDCTO_BK"
		, "CALCULATE_BK"."SHKCOO_BK" AS "SHKCOO_BK"
		, "CALCULATE_BK"."ABAN8_FK_SHAN8_BK" AS "ABAN8_FK_SHAN8_BK"
		, "CALCULATE_BK"."MCMCU_FK_SHMCU_BK" AS "MCMCU_FK_SHMCU_BK"
		, "CALCULATE_BK"."SHSFXO" AS "SHSFXO"
		, "CALCULATE_BK"."SHCO" AS "SHCO"
		, "CALCULATE_BK"."SHOKCO" AS "SHOKCO"
		, "CALCULATE_BK"."SHOORN" AS "SHOORN"
		, "CALCULATE_BK"."SHOCTO" AS "SHOCTO"
		, "CALCULATE_BK"."SHRKCO" AS "SHRKCO"
		, "CALCULATE_BK"."SHRORN" AS "SHRORN"
		, "CALCULATE_BK"."SHRCTO" AS "SHRCTO"
		, "CALCULATE_BK"."SHSHAN" AS "SHSHAN"
		, "CALCULATE_BK"."SHPA8" AS "SHPA8"
		, "CALCULATE_BK"."SHDRQJ" AS "SHDRQJ"
		, "CALCULATE_BK"."SHTRDJ" AS "SHTRDJ"
		, "CALCULATE_BK"."SHPDDJ" AS "SHPDDJ"
		, "CALCULATE_BK"."SHOPDJ" AS "SHOPDJ"
		, "CALCULATE_BK"."SHADDJ" AS "SHADDJ"
		, "CALCULATE_BK"."SHCNDJ" AS "SHCNDJ"
		, "CALCULATE_BK"."SHPEFJ" AS "SHPEFJ"
		, "CALCULATE_BK"."SHPPDJ" AS "SHPPDJ"
		, "CALCULATE_BK"."SHVR01" AS "SHVR01"
		, "CALCULATE_BK"."SHVR02" AS "SHVR02"
		, "CALCULATE_BK"."SHDEL1" AS "SHDEL1"
		, "CALCULATE_BK"."SHDEL2" AS "SHDEL2"
		, "CALCULATE_BK"."SHINMG" AS "SHINMG"
		, "CALCULATE_BK"."SHPTC" AS "SHPTC"
		, "CALCULATE_BK"."SHRYIN" AS "SHRYIN"
		, "CALCULATE_BK"."SHASN" AS "SHASN"
		, "CALCULATE_BK"."SHPRGP" AS "SHPRGP"
		, "CALCULATE_BK"."SHTRDC" AS "SHTRDC"
		, "CALCULATE_BK"."SHPCRT" AS "SHPCRT"
		, "CALCULATE_BK"."SHTXA1" AS "SHTXA1"
		, "CALCULATE_BK"."SHEXR1" AS "SHEXR1"
		, "CALCULATE_BK"."SHTXCT" AS "SHTXCT"
		, "CALCULATE_BK"."SHATXT" AS "SHATXT"
		, "CALCULATE_BK"."SHPRIO" AS "SHPRIO"
		, "CALCULATE_BK"."SHBACK" AS "SHBACK"
		, "CALCULATE_BK"."SHSBAL" AS "SHSBAL"
		, "CALCULATE_BK"."SHHOLD" AS "SHHOLD"
		, "CALCULATE_BK"."SHPLST" AS "SHPLST"
		, "CALCULATE_BK"."SHINVC" AS "SHINVC"
		, "CALCULATE_BK"."SHNTR" AS "SHNTR"
		, "CALCULATE_BK"."SHANBY" AS "SHANBY"
		, "CALCULATE_BK"."SHCARS" AS "SHCARS"
		, "CALCULATE_BK"."SHMOT" AS "SHMOT"
		, "CALCULATE_BK"."SHCOT" AS "SHCOT"
		, "CALCULATE_BK"."SHROUT" AS "SHROUT"
		, "CALCULATE_BK"."SHSTOP" AS "SHSTOP"
		, "CALCULATE_BK"."SHZON" AS "SHZON"
		, "CALCULATE_BK"."SHCNID" AS "SHCNID"
		, "CALCULATE_BK"."SHFRTH" AS "SHFRTH"
		, "CALCULATE_BK"."SHAFT" AS "SHAFT"
		, "CALCULATE_BK"."SHFUF1" AS "SHFUF1"
		, "CALCULATE_BK"."SHFRTC" AS "SHFRTC"
		, "CALCULATE_BK"."SHMORD" AS "SHMORD"
		, "CALCULATE_BK"."SHRCD" AS "SHRCD"
		, "CALCULATE_BK"."SHFUF2" AS "SHFUF2"
		, "CALCULATE_BK"."SHOTOT" AS "SHOTOT"
		, "CALCULATE_BK"."SHTOTC" AS "SHTOTC"
		, "CALCULATE_BK"."SHWUMD" AS "SHWUMD"
		, "CALCULATE_BK"."SHVUMD" AS "SHVUMD"
		, "CALCULATE_BK"."SHAUTN" AS "SHAUTN"
		, "CALCULATE_BK"."SHCACT" AS "SHCACT"
		, "CALCULATE_BK"."SHCEXP" AS "SHCEXP"
		, "CALCULATE_BK"."SHSBLI" AS "SHSBLI"
		, "CALCULATE_BK"."SHCRMD" AS "SHCRMD"
		, "CALCULATE_BK"."SHCRRM" AS "SHCRRM"
		, "CALCULATE_BK"."SHCRCD" AS "SHCRCD"
		, "CALCULATE_BK"."SHCRR" AS "SHCRR"
		, "CALCULATE_BK"."SHLNGP" AS "SHLNGP"
		, "CALCULATE_BK"."SHFAP" AS "SHFAP"
		, "CALCULATE_BK"."SHFCST" AS "SHFCST"
		, "CALCULATE_BK"."SHORBY" AS "SHORBY"
		, "CALCULATE_BK"."SHTKBY" AS "SHTKBY"
		, "CALCULATE_BK"."SHURCD" AS "SHURCD"
		, "CALCULATE_BK"."SHURDT" AS "SHURDT"
		, "CALCULATE_BK"."SHURAT" AS "SHURAT"
		, "CALCULATE_BK"."SHURAB" AS "SHURAB"
		, "CALCULATE_BK"."SHURRF" AS "SHURRF"
		, "CALCULATE_BK"."SHUSER" AS "SHUSER"
		, "CALCULATE_BK"."SHPID" AS "SHPID"
		, "CALCULATE_BK"."SHJOBN" AS "SHJOBN"
		, "CALCULATE_BK"."SHUPMJ" AS "SHUPMJ"
		, "CALCULATE_BK"."SHTDAY" AS "SHTDAY"
		, "CALCULATE_BK"."SHIR01" AS "SHIR01"
		, "CALCULATE_BK"."SHIR02" AS "SHIR02"
		, "CALCULATE_BK"."SHIR03" AS "SHIR03"
		, "CALCULATE_BK"."SHIR04" AS "SHIR04"
		, "CALCULATE_BK"."SHIR05" AS "SHIR05"
		, "CALCULATE_BK"."SHVR03" AS "SHVR03"
		, "CALCULATE_BK"."SHSOOR" AS "SHSOOR"
		, "CALCULATE_BK"."SHPMDT" AS "SHPMDT"
		, "CALCULATE_BK"."SHRSDT" AS "SHRSDT"
		, "CALCULATE_BK"."SHRQSJ" AS "SHRQSJ"
		, "CALCULATE_BK"."SHPSTM" AS "SHPSTM"
		, "CALCULATE_BK"."SHPDTT" AS "SHPDTT"
		, "CALCULATE_BK"."SHOPTT" AS "SHOPTT"
		, "CALCULATE_BK"."SHDRQT" AS "SHDRQT"
		, "CALCULATE_BK"."SHADTM" AS "SHADTM"
		, "CALCULATE_BK"."SHADLJ" AS "SHADLJ"
		, "CALCULATE_BK"."SHPBAN" AS "SHPBAN"
		, "CALCULATE_BK"."SHITAN" AS "SHITAN"
		, "CALCULATE_BK"."SHFTAN" AS "SHFTAN"
		, "CALCULATE_BK"."SHDVAN" AS "SHDVAN"
		, "CALCULATE_BK"."SHDOC1" AS "SHDOC1"
		, "CALCULATE_BK"."SHDCT4" AS "SHDCT4"
		, "CALCULATE_BK"."SHCORD" AS "SHCORD"
		, "CALCULATE_BK"."SHBSC" AS "SHBSC"
		, "CALCULATE_BK"."SHBCRC" AS "SHBCRC"
		, "CALCULATE_BK"."SHAUFT" AS "SHAUFT"
		, "CALCULATE_BK"."SHAUFI" AS "SHAUFI"
		, "CALCULATE_BK"."SHOPBO" AS "SHOPBO"
		, "CALCULATE_BK"."SHOPTC" AS "SHOPTC"
		, "CALCULATE_BK"."SHOPLD" AS "SHOPLD"
		, "CALCULATE_BK"."SHOPBK" AS "SHOPBK"
		, "CALCULATE_BK"."SHOPSB" AS "SHOPSB"
		, "CALCULATE_BK"."SHOPPS" AS "SHOPPS"
		, "CALCULATE_BK"."SHOPPL" AS "SHOPPL"
		, "CALCULATE_BK"."SHOPMS" AS "SHOPMS"
		, "CALCULATE_BK"."SHOPSS" AS "SHOPSS"
		, "CALCULATE_BK"."SHOPBA" AS "SHOPBA"
		, "CALCULATE_BK"."SHOPLL" AS "SHOPLL"
		, "CALCULATE_BK"."SHPRAN8" AS "SHPRAN8"
		, "CALCULATE_BK"."SHOPPID" AS "SHOPPID"
		, "CALCULATE_BK"."SHSDATTN" AS "SHSDATTN"
		, "CALCULATE_BK"."SHSPATTN" AS "SHSPATTN"
		, "CALCULATE_BK"."SHOTIND" AS "SHOTIND"
		, "CALCULATE_BK"."SHPRCIDLN" AS "SHPRCIDLN"
		, "CALCULATE_BK"."SHCCIDLN" AS "SHCCIDLN"
		, "CALCULATE_BK"."SHSHCCIDLN" AS "SHSHCCIDLN"
	FROM "CALCULATE_BK" "CALCULATE_BK"

) final 
where '{{ var("load_type") }}' = 'INIT' and '{{ var("source") }}' = 'JDEDWARDS'