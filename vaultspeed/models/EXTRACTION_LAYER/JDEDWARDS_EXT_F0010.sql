{{
	config(
		materialized='incremental',
		pre_hook= [
			'{% if var("load_type") == "INCR" and var("source") == "JDEDWARDS" %} TRUNCATE TABLE {{ this }}; {% endif %}',
			'{% if var("load_type") == "INIT" and var("source") == "JDEDWARDS" %} TRUNCATE TABLE {{ this }}; {% endif %}'
		],
		alias='F0010',
		schema='JDEDWARDS_EXT',
		tags=['JDEDWARDS', 'EXT_JDE_COMPANY_INCR', 'EXT_JDE_COMPANY_INIT']
	)
}}
select * from (
	WITH "CALCULATE_BK" AS 
	( 
		SELECT 
			  "LCI_SRC"."LOAD_CYCLE_ID" AS "LOAD_CYCLE_ID"
			, DATEADD(microsecond, 2*row_number() over (order by "TDFV_SRC"."CDC_TIMESTAMP"),
				TO_TIMESTAMP_NTZ(CURRENT_TIMESTAMP()))   AS "LOAD_DATE"
			, "TDFV_SRC"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP"
			, COALESCE("TDFV_SRC"."JRN_FLAG","MEX_SRC"."ATTRIBUTE_VARCHAR") AS "JRN_FLAG"
			, "TDFV_SRC"."RECORD_TYPE" AS "RECORD_TYPE"
			, "TDFV_SRC"."CCCO" AS "CCCO"
			, "TDFV_SRC"."CCAN8" AS "CCAN8"
			, COALESCE(REPLACE(TRIM( "TDFV_SRC"."CCCO"),'\#','\\' || '\#'),"MEX_SRC"."KEY_ATTRIBUTE_VARCHAR") AS "CCCO_BK"
			, UPPER( TO_CHAR("TDFV_SRC"."CCAN8")) AS "ABAN8_FK_CCAN8_BK"
			, "TDFV_SRC"."CCNAME" AS "CCNAME"
			, "TDFV_SRC"."CCALTC" AS "CCALTC"
			, "TDFV_SRC"."CCDFYJ" AS "CCDFYJ"
			, "TDFV_SRC"."CCPNC" AS "CCPNC"
			, "TDFV_SRC"."CCDOT1" AS "CCDOT1"
			, "TDFV_SRC"."CCCRYR" AS "CCCRYR"
			, "TDFV_SRC"."CCCRYC" AS "CCCRYC"
			, "TDFV_SRC"."CCDOT2" AS "CCDOT2"
			, "TDFV_SRC"."CCMCUA" AS "CCMCUA"
			, "TDFV_SRC"."CCMCUD" AS "CCMCUD"
			, "TDFV_SRC"."CCMCUC" AS "CCMCUC"
			, "TDFV_SRC"."CCMCUB" AS "CCMCUB"
			, "TDFV_SRC"."CCDPRC" AS "CCDPRC"
			, "TDFV_SRC"."CCBKTX" AS "CCBKTX"
			, "TDFV_SRC"."CCTXBM" AS "CCTXBM"
			, "TDFV_SRC"."CCTXBO" AS "CCTXBO"
			, "TDFV_SRC"."CCNWXJ" AS "CCNWXJ"
			, "TDFV_SRC"."CCGLIE" AS "CCGLIE"
			, "TDFV_SRC"."CCABIN" AS "CCABIN"
			, "TDFV_SRC"."CCCALD" AS "CCCALD"
			, "TDFV_SRC"."CCDTPN" AS "CCDTPN"
			, "TDFV_SRC"."CCPNF" AS "CCPNF"
			, "TDFV_SRC"."CCDFF" AS "CCDFF"
			, "TDFV_SRC"."CCCRCD" AS "CCCRCD"
			, "TDFV_SRC"."CCSMI" AS "CCSMI"
			, "TDFV_SRC"."CCSMU" AS "CCSMU"
			, "TDFV_SRC"."CCSMS" AS "CCSMS"
			, "TDFV_SRC"."CCDNLT" AS "CCDNLT"
			, "TDFV_SRC"."CCSTMT" AS "CCSTMT"
			, "TDFV_SRC"."CCATCS" AS "CCATCS"
			, "TDFV_SRC"."CCALGM" AS "CCALGM"
			, "TDFV_SRC"."CCAGEM" AS "CCAGEM"
			, "TDFV_SRC"."CCCRDY" AS "CCCRDY"
			, "TDFV_SRC"."CCAGR1" AS "CCAGR1"
			, "TDFV_SRC"."CCAGR2" AS "CCAGR2"
			, "TDFV_SRC"."CCAGR3" AS "CCAGR3"
			, "TDFV_SRC"."CCAGR4" AS "CCAGR4"
			, "TDFV_SRC"."CCAGR5" AS "CCAGR5"
			, "TDFV_SRC"."CCAGR6" AS "CCAGR6"
			, "TDFV_SRC"."CCAGR7" AS "CCAGR7"
			, "TDFV_SRC"."CCFRY" AS "CCFRY"
			, "TDFV_SRC"."CCFRP" AS "CCFRP"
			, "TDFV_SRC"."CCNNP" AS "CCNNP"
			, "TDFV_SRC"."CCFP" AS "CCFP"
			, "TDFV_SRC"."CCAGE" AS "CCAGE"
			, "TDFV_SRC"."CCDAG" AS "CCDAG"
			, "TDFV_SRC"."CCARPN" AS "CCARPN"
			, "TDFV_SRC"."CCAPPN" AS "CCAPPN"
			, "TDFV_SRC"."CCARFJ" AS "CCARFJ"
			, "TDFV_SRC"."CCAPFJ" AS "CCAPFJ"
			, "TDFV_SRC"."CCSGBK" AS "CCSGBK"
			, "TDFV_SRC"."CCPTCO" AS "CCPTCO"
			, "TDFV_SRC"."CCX1" AS "CCX1"
			, "TDFV_SRC"."CCX2" AS "CCX2"
			, "TDFV_SRC"."CCUSER" AS "CCUSER"
			, "TDFV_SRC"."CCPID" AS "CCPID"
			, "TDFV_SRC"."CCUPMJ" AS "CCUPMJ"
			, "TDFV_SRC"."CCJOBN" AS "CCJOBN"
			, "TDFV_SRC"."CCUPMT" AS "CCUPMT"
			, "TDFV_SRC"."CCTSID" AS "CCTSID"
			, "TDFV_SRC"."CCTSCO" AS "CCTSCO"
			, "TDFV_SRC"."CCTHCO" AS "CCTHCO"
			, "TDFV_SRC"."CCAN8C" AS "CCAN8C"
		FROM {{ ref('JDEDWARDS_DFV_VW_F0010') }} "TDFV_SRC"
		INNER JOIN {{ source('JDEDWARDS_MTD', 'LOAD_CYCLE_INFO') }} "LCI_SRC" ON  1 = 1
		INNER JOIN {{ source('JDEDWARDS_MTD', 'MTD_EXCEPTION_RECORDS') }} "MEX_SRC" ON  1 = 1
		WHERE  "MEX_SRC"."RECORD_TYPE" = 'N'
	)
	, "EXT_UNION" AS 
	( 
		SELECT 
			  "CALCULATE_BK"."LOAD_CYCLE_ID" AS "LOAD_CYCLE_ID"
			, "CALCULATE_BK"."LOAD_DATE" AS "LOAD_DATE"
			, "CALCULATE_BK"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP"
			, "CALCULATE_BK"."JRN_FLAG" AS "JRN_FLAG"
			, "CALCULATE_BK"."RECORD_TYPE" AS "RECORD_TYPE"
			, "CALCULATE_BK"."CCCO" AS "CCCO"
			, "CALCULATE_BK"."CCAN8" AS "CCAN8"
			, "CALCULATE_BK"."CCCO_BK" AS "CCCO_BK"
			, "CALCULATE_BK"."ABAN8_FK_CCAN8_BK" AS "ABAN8_FK_CCAN8_BK"
			, "CALCULATE_BK"."CCNAME" AS "CCNAME"
			, "CALCULATE_BK"."CCALTC" AS "CCALTC"
			, "CALCULATE_BK"."CCDFYJ" AS "CCDFYJ"
			, "CALCULATE_BK"."CCPNC" AS "CCPNC"
			, "CALCULATE_BK"."CCDOT1" AS "CCDOT1"
			, "CALCULATE_BK"."CCCRYR" AS "CCCRYR"
			, "CALCULATE_BK"."CCCRYC" AS "CCCRYC"
			, "CALCULATE_BK"."CCDOT2" AS "CCDOT2"
			, "CALCULATE_BK"."CCMCUA" AS "CCMCUA"
			, "CALCULATE_BK"."CCMCUD" AS "CCMCUD"
			, "CALCULATE_BK"."CCMCUC" AS "CCMCUC"
			, "CALCULATE_BK"."CCMCUB" AS "CCMCUB"
			, "CALCULATE_BK"."CCDPRC" AS "CCDPRC"
			, "CALCULATE_BK"."CCBKTX" AS "CCBKTX"
			, "CALCULATE_BK"."CCTXBM" AS "CCTXBM"
			, "CALCULATE_BK"."CCTXBO" AS "CCTXBO"
			, "CALCULATE_BK"."CCNWXJ" AS "CCNWXJ"
			, "CALCULATE_BK"."CCGLIE" AS "CCGLIE"
			, "CALCULATE_BK"."CCABIN" AS "CCABIN"
			, "CALCULATE_BK"."CCCALD" AS "CCCALD"
			, "CALCULATE_BK"."CCDTPN" AS "CCDTPN"
			, "CALCULATE_BK"."CCPNF" AS "CCPNF"
			, "CALCULATE_BK"."CCDFF" AS "CCDFF"
			, "CALCULATE_BK"."CCCRCD" AS "CCCRCD"
			, "CALCULATE_BK"."CCSMI" AS "CCSMI"
			, "CALCULATE_BK"."CCSMU" AS "CCSMU"
			, "CALCULATE_BK"."CCSMS" AS "CCSMS"
			, "CALCULATE_BK"."CCDNLT" AS "CCDNLT"
			, "CALCULATE_BK"."CCSTMT" AS "CCSTMT"
			, "CALCULATE_BK"."CCATCS" AS "CCATCS"
			, "CALCULATE_BK"."CCALGM" AS "CCALGM"
			, "CALCULATE_BK"."CCAGEM" AS "CCAGEM"
			, "CALCULATE_BK"."CCCRDY" AS "CCCRDY"
			, "CALCULATE_BK"."CCAGR1" AS "CCAGR1"
			, "CALCULATE_BK"."CCAGR2" AS "CCAGR2"
			, "CALCULATE_BK"."CCAGR3" AS "CCAGR3"
			, "CALCULATE_BK"."CCAGR4" AS "CCAGR4"
			, "CALCULATE_BK"."CCAGR5" AS "CCAGR5"
			, "CALCULATE_BK"."CCAGR6" AS "CCAGR6"
			, "CALCULATE_BK"."CCAGR7" AS "CCAGR7"
			, "CALCULATE_BK"."CCFRY" AS "CCFRY"
			, "CALCULATE_BK"."CCFRP" AS "CCFRP"
			, "CALCULATE_BK"."CCNNP" AS "CCNNP"
			, "CALCULATE_BK"."CCFP" AS "CCFP"
			, "CALCULATE_BK"."CCAGE" AS "CCAGE"
			, "CALCULATE_BK"."CCDAG" AS "CCDAG"
			, "CALCULATE_BK"."CCARPN" AS "CCARPN"
			, "CALCULATE_BK"."CCAPPN" AS "CCAPPN"
			, "CALCULATE_BK"."CCARFJ" AS "CCARFJ"
			, "CALCULATE_BK"."CCAPFJ" AS "CCAPFJ"
			, "CALCULATE_BK"."CCSGBK" AS "CCSGBK"
			, "CALCULATE_BK"."CCPTCO" AS "CCPTCO"
			, "CALCULATE_BK"."CCX1" AS "CCX1"
			, "CALCULATE_BK"."CCX2" AS "CCX2"
			, "CALCULATE_BK"."CCUSER" AS "CCUSER"
			, "CALCULATE_BK"."CCPID" AS "CCPID"
			, "CALCULATE_BK"."CCUPMJ" AS "CCUPMJ"
			, "CALCULATE_BK"."CCJOBN" AS "CCJOBN"
			, "CALCULATE_BK"."CCUPMT" AS "CCUPMT"
			, "CALCULATE_BK"."CCTSID" AS "CCTSID"
			, "CALCULATE_BK"."CCTSCO" AS "CCTSCO"
			, "CALCULATE_BK"."CCTHCO" AS "CCTHCO"
			, "CALCULATE_BK"."CCAN8C" AS "CCAN8C"
		FROM "CALCULATE_BK" "CALCULATE_BK"
	)
	SELECT 
		  "EXT_UNION"."LOAD_CYCLE_ID" AS "LOAD_CYCLE_ID"
		, "EXT_UNION"."LOAD_DATE" AS "LOAD_DATE"
		, "EXT_UNION"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP"
		, "EXT_UNION"."JRN_FLAG" AS "JRN_FLAG"
		, "EXT_UNION"."RECORD_TYPE" AS "RECORD_TYPE"
		, "EXT_UNION"."CCCO" AS "CCCO"
		, "EXT_UNION"."CCAN8" AS "CCAN8"
		, "EXT_UNION"."CCCO_BK" AS "CCCO_BK"
		, "EXT_UNION"."ABAN8_FK_CCAN8_BK" AS "ABAN8_FK_CCAN8_BK"
		, "EXT_UNION"."CCNAME" AS "CCNAME"
		, "EXT_UNION"."CCALTC" AS "CCALTC"
		, "EXT_UNION"."CCDFYJ" AS "CCDFYJ"
		, "EXT_UNION"."CCPNC" AS "CCPNC"
		, "EXT_UNION"."CCDOT1" AS "CCDOT1"
		, "EXT_UNION"."CCCRYR" AS "CCCRYR"
		, "EXT_UNION"."CCCRYC" AS "CCCRYC"
		, "EXT_UNION"."CCDOT2" AS "CCDOT2"
		, "EXT_UNION"."CCMCUA" AS "CCMCUA"
		, "EXT_UNION"."CCMCUD" AS "CCMCUD"
		, "EXT_UNION"."CCMCUC" AS "CCMCUC"
		, "EXT_UNION"."CCMCUB" AS "CCMCUB"
		, "EXT_UNION"."CCDPRC" AS "CCDPRC"
		, "EXT_UNION"."CCBKTX" AS "CCBKTX"
		, "EXT_UNION"."CCTXBM" AS "CCTXBM"
		, "EXT_UNION"."CCTXBO" AS "CCTXBO"
		, "EXT_UNION"."CCNWXJ" AS "CCNWXJ"
		, "EXT_UNION"."CCGLIE" AS "CCGLIE"
		, "EXT_UNION"."CCABIN" AS "CCABIN"
		, "EXT_UNION"."CCCALD" AS "CCCALD"
		, "EXT_UNION"."CCDTPN" AS "CCDTPN"
		, "EXT_UNION"."CCPNF" AS "CCPNF"
		, "EXT_UNION"."CCDFF" AS "CCDFF"
		, "EXT_UNION"."CCCRCD" AS "CCCRCD"
		, "EXT_UNION"."CCSMI" AS "CCSMI"
		, "EXT_UNION"."CCSMU" AS "CCSMU"
		, "EXT_UNION"."CCSMS" AS "CCSMS"
		, "EXT_UNION"."CCDNLT" AS "CCDNLT"
		, "EXT_UNION"."CCSTMT" AS "CCSTMT"
		, "EXT_UNION"."CCATCS" AS "CCATCS"
		, "EXT_UNION"."CCALGM" AS "CCALGM"
		, "EXT_UNION"."CCAGEM" AS "CCAGEM"
		, "EXT_UNION"."CCCRDY" AS "CCCRDY"
		, "EXT_UNION"."CCAGR1" AS "CCAGR1"
		, "EXT_UNION"."CCAGR2" AS "CCAGR2"
		, "EXT_UNION"."CCAGR3" AS "CCAGR3"
		, "EXT_UNION"."CCAGR4" AS "CCAGR4"
		, "EXT_UNION"."CCAGR5" AS "CCAGR5"
		, "EXT_UNION"."CCAGR6" AS "CCAGR6"
		, "EXT_UNION"."CCAGR7" AS "CCAGR7"
		, "EXT_UNION"."CCFRY" AS "CCFRY"
		, "EXT_UNION"."CCFRP" AS "CCFRP"
		, "EXT_UNION"."CCNNP" AS "CCNNP"
		, "EXT_UNION"."CCFP" AS "CCFP"
		, "EXT_UNION"."CCAGE" AS "CCAGE"
		, "EXT_UNION"."CCDAG" AS "CCDAG"
		, "EXT_UNION"."CCARPN" AS "CCARPN"
		, "EXT_UNION"."CCAPPN" AS "CCAPPN"
		, "EXT_UNION"."CCARFJ" AS "CCARFJ"
		, "EXT_UNION"."CCAPFJ" AS "CCAPFJ"
		, "EXT_UNION"."CCSGBK" AS "CCSGBK"
		, "EXT_UNION"."CCPTCO" AS "CCPTCO"
		, "EXT_UNION"."CCX1" AS "CCX1"
		, "EXT_UNION"."CCX2" AS "CCX2"
		, "EXT_UNION"."CCUSER" AS "CCUSER"
		, "EXT_UNION"."CCPID" AS "CCPID"
		, "EXT_UNION"."CCUPMJ" AS "CCUPMJ"
		, "EXT_UNION"."CCJOBN" AS "CCJOBN"
		, "EXT_UNION"."CCUPMT" AS "CCUPMT"
		, "EXT_UNION"."CCTSID" AS "CCTSID"
		, "EXT_UNION"."CCTSCO" AS "CCTSCO"
		, "EXT_UNION"."CCTHCO" AS "CCTHCO"
		, "EXT_UNION"."CCAN8C" AS "CCAN8C"
	FROM "EXT_UNION" "EXT_UNION"

) final 
where '{{ var("load_type") }}' = 'INCR' and '{{ var("source") }}' = 'JDEDWARDS'

UNION ALL

select * from (
	WITH "LOAD_INIT_DATA" AS 
	( 
		SELECT 
			  TO_CHAR('I' ) AS "JRN_FLAG"
			, TO_CHAR('S') AS "RECORD_TYPE"
			, COALESCE("INI_SRC"."CCCO", CAST("MEX_INR_SRC"."KEY_ATTRIBUTE_VARCHAR" AS VARCHAR)) AS "CCCO"
			, COALESCE("INI_SRC"."CCAN8", CAST("MEX_INR_SRC"."KEY_ATTRIBUTE_FLOAT" AS FLOAT)) AS "CCAN8"
			, "INI_SRC"."CCNAME" AS "CCNAME"
			, "INI_SRC"."CCALTC" AS "CCALTC"
			, "INI_SRC"."CCDFYJ" AS "CCDFYJ"
			, "INI_SRC"."CCPNC" AS "CCPNC"
			, "INI_SRC"."CCDOT1" AS "CCDOT1"
			, "INI_SRC"."CCCRYR" AS "CCCRYR"
			, "INI_SRC"."CCCRYC" AS "CCCRYC"
			, "INI_SRC"."CCDOT2" AS "CCDOT2"
			, "INI_SRC"."CCMCUA" AS "CCMCUA"
			, "INI_SRC"."CCMCUD" AS "CCMCUD"
			, "INI_SRC"."CCMCUC" AS "CCMCUC"
			, "INI_SRC"."CCMCUB" AS "CCMCUB"
			, "INI_SRC"."CCDPRC" AS "CCDPRC"
			, "INI_SRC"."CCBKTX" AS "CCBKTX"
			, "INI_SRC"."CCTXBM" AS "CCTXBM"
			, "INI_SRC"."CCTXBO" AS "CCTXBO"
			, "INI_SRC"."CCNWXJ" AS "CCNWXJ"
			, "INI_SRC"."CCGLIE" AS "CCGLIE"
			, "INI_SRC"."CCABIN" AS "CCABIN"
			, "INI_SRC"."CCCALD" AS "CCCALD"
			, "INI_SRC"."CCDTPN" AS "CCDTPN"
			, "INI_SRC"."CCPNF" AS "CCPNF"
			, "INI_SRC"."CCDFF" AS "CCDFF"
			, "INI_SRC"."CCCRCD" AS "CCCRCD"
			, "INI_SRC"."CCSMI" AS "CCSMI"
			, "INI_SRC"."CCSMU" AS "CCSMU"
			, "INI_SRC"."CCSMS" AS "CCSMS"
			, "INI_SRC"."CCDNLT" AS "CCDNLT"
			, "INI_SRC"."CCSTMT" AS "CCSTMT"
			, "INI_SRC"."CCATCS" AS "CCATCS"
			, "INI_SRC"."CCALGM" AS "CCALGM"
			, "INI_SRC"."CCAGEM" AS "CCAGEM"
			, "INI_SRC"."CCCRDY" AS "CCCRDY"
			, "INI_SRC"."CCAGR1" AS "CCAGR1"
			, "INI_SRC"."CCAGR2" AS "CCAGR2"
			, "INI_SRC"."CCAGR3" AS "CCAGR3"
			, "INI_SRC"."CCAGR4" AS "CCAGR4"
			, "INI_SRC"."CCAGR5" AS "CCAGR5"
			, "INI_SRC"."CCAGR6" AS "CCAGR6"
			, "INI_SRC"."CCAGR7" AS "CCAGR7"
			, "INI_SRC"."CCFRY" AS "CCFRY"
			, "INI_SRC"."CCFRP" AS "CCFRP"
			, "INI_SRC"."CCNNP" AS "CCNNP"
			, "INI_SRC"."CCFP" AS "CCFP"
			, "INI_SRC"."CCAGE" AS "CCAGE"
			, "INI_SRC"."CCDAG" AS "CCDAG"
			, "INI_SRC"."CCARPN" AS "CCARPN"
			, "INI_SRC"."CCAPPN" AS "CCAPPN"
			, "INI_SRC"."CCARFJ" AS "CCARFJ"
			, "INI_SRC"."CCAPFJ" AS "CCAPFJ"
			, "INI_SRC"."CCSGBK" AS "CCSGBK"
			, "INI_SRC"."CCPTCO" AS "CCPTCO"
			, "INI_SRC"."CCX1" AS "CCX1"
			, "INI_SRC"."CCX2" AS "CCX2"
			, "INI_SRC"."CCUSER" AS "CCUSER"
			, "INI_SRC"."CCPID" AS "CCPID"
			, "INI_SRC"."CCUPMJ" AS "CCUPMJ"
			, "INI_SRC"."CCJOBN" AS "CCJOBN"
			, "INI_SRC"."CCUPMT" AS "CCUPMT"
			, "INI_SRC"."CCTSID" AS "CCTSID"
			, "INI_SRC"."CCTSCO" AS "CCTSCO"
			, "INI_SRC"."CCTHCO" AS "CCTHCO"
			, "INI_SRC"."CCAN8C" AS "CCAN8C"
		FROM {{ source('JDEDWARDS_INI', 'F0010') }} "INI_SRC"
		INNER JOIN {{ source('JDEDWARDS_MTD', 'MTD_EXCEPTION_RECORDS') }} "MEX_INR_SRC" ON  "MEX_INR_SRC"."RECORD_TYPE" = 'N'
	)
	, "PREP_EXCEP" AS 
	( 
		SELECT 
			  "LOAD_INIT_DATA"."JRN_FLAG" AS "JRN_FLAG"
			, "LOAD_INIT_DATA"."RECORD_TYPE" AS "RECORD_TYPE"
			, NULL AS "LOAD_CYCLE_ID"
			, "LOAD_INIT_DATA"."CCCO" AS "CCCO"
			, "LOAD_INIT_DATA"."CCAN8" AS "CCAN8"
			, "LOAD_INIT_DATA"."CCNAME" AS "CCNAME"
			, "LOAD_INIT_DATA"."CCALTC" AS "CCALTC"
			, "LOAD_INIT_DATA"."CCDFYJ" AS "CCDFYJ"
			, "LOAD_INIT_DATA"."CCPNC" AS "CCPNC"
			, "LOAD_INIT_DATA"."CCDOT1" AS "CCDOT1"
			, "LOAD_INIT_DATA"."CCCRYR" AS "CCCRYR"
			, "LOAD_INIT_DATA"."CCCRYC" AS "CCCRYC"
			, "LOAD_INIT_DATA"."CCDOT2" AS "CCDOT2"
			, "LOAD_INIT_DATA"."CCMCUA" AS "CCMCUA"
			, "LOAD_INIT_DATA"."CCMCUD" AS "CCMCUD"
			, "LOAD_INIT_DATA"."CCMCUC" AS "CCMCUC"
			, "LOAD_INIT_DATA"."CCMCUB" AS "CCMCUB"
			, "LOAD_INIT_DATA"."CCDPRC" AS "CCDPRC"
			, "LOAD_INIT_DATA"."CCBKTX" AS "CCBKTX"
			, "LOAD_INIT_DATA"."CCTXBM" AS "CCTXBM"
			, "LOAD_INIT_DATA"."CCTXBO" AS "CCTXBO"
			, "LOAD_INIT_DATA"."CCNWXJ" AS "CCNWXJ"
			, "LOAD_INIT_DATA"."CCGLIE" AS "CCGLIE"
			, "LOAD_INIT_DATA"."CCABIN" AS "CCABIN"
			, "LOAD_INIT_DATA"."CCCALD" AS "CCCALD"
			, "LOAD_INIT_DATA"."CCDTPN" AS "CCDTPN"
			, "LOAD_INIT_DATA"."CCPNF" AS "CCPNF"
			, "LOAD_INIT_DATA"."CCDFF" AS "CCDFF"
			, "LOAD_INIT_DATA"."CCCRCD" AS "CCCRCD"
			, "LOAD_INIT_DATA"."CCSMI" AS "CCSMI"
			, "LOAD_INIT_DATA"."CCSMU" AS "CCSMU"
			, "LOAD_INIT_DATA"."CCSMS" AS "CCSMS"
			, "LOAD_INIT_DATA"."CCDNLT" AS "CCDNLT"
			, "LOAD_INIT_DATA"."CCSTMT" AS "CCSTMT"
			, "LOAD_INIT_DATA"."CCATCS" AS "CCATCS"
			, "LOAD_INIT_DATA"."CCALGM" AS "CCALGM"
			, "LOAD_INIT_DATA"."CCAGEM" AS "CCAGEM"
			, "LOAD_INIT_DATA"."CCCRDY" AS "CCCRDY"
			, "LOAD_INIT_DATA"."CCAGR1" AS "CCAGR1"
			, "LOAD_INIT_DATA"."CCAGR2" AS "CCAGR2"
			, "LOAD_INIT_DATA"."CCAGR3" AS "CCAGR3"
			, "LOAD_INIT_DATA"."CCAGR4" AS "CCAGR4"
			, "LOAD_INIT_DATA"."CCAGR5" AS "CCAGR5"
			, "LOAD_INIT_DATA"."CCAGR6" AS "CCAGR6"
			, "LOAD_INIT_DATA"."CCAGR7" AS "CCAGR7"
			, "LOAD_INIT_DATA"."CCFRY" AS "CCFRY"
			, "LOAD_INIT_DATA"."CCFRP" AS "CCFRP"
			, "LOAD_INIT_DATA"."CCNNP" AS "CCNNP"
			, "LOAD_INIT_DATA"."CCFP" AS "CCFP"
			, "LOAD_INIT_DATA"."CCAGE" AS "CCAGE"
			, "LOAD_INIT_DATA"."CCDAG" AS "CCDAG"
			, "LOAD_INIT_DATA"."CCARPN" AS "CCARPN"
			, "LOAD_INIT_DATA"."CCAPPN" AS "CCAPPN"
			, "LOAD_INIT_DATA"."CCARFJ" AS "CCARFJ"
			, "LOAD_INIT_DATA"."CCAPFJ" AS "CCAPFJ"
			, "LOAD_INIT_DATA"."CCSGBK" AS "CCSGBK"
			, "LOAD_INIT_DATA"."CCPTCO" AS "CCPTCO"
			, "LOAD_INIT_DATA"."CCX1" AS "CCX1"
			, "LOAD_INIT_DATA"."CCX2" AS "CCX2"
			, "LOAD_INIT_DATA"."CCUSER" AS "CCUSER"
			, "LOAD_INIT_DATA"."CCPID" AS "CCPID"
			, "LOAD_INIT_DATA"."CCUPMJ" AS "CCUPMJ"
			, "LOAD_INIT_DATA"."CCJOBN" AS "CCJOBN"
			, "LOAD_INIT_DATA"."CCUPMT" AS "CCUPMT"
			, "LOAD_INIT_DATA"."CCTSID" AS "CCTSID"
			, "LOAD_INIT_DATA"."CCTSCO" AS "CCTSCO"
			, "LOAD_INIT_DATA"."CCTHCO" AS "CCTHCO"
			, "LOAD_INIT_DATA"."CCAN8C" AS "CCAN8C"
		FROM "LOAD_INIT_DATA" "LOAD_INIT_DATA"
		UNION ALL 
		SELECT 
			  TO_CHAR('I' ) AS "JRN_FLAG"
			, "MEX_EXT_SRC"."RECORD_TYPE" AS "RECORD_TYPE"
			, "MEX_EXT_SRC"."LOAD_CYCLE_ID" ::integer AS "LOAD_CYCLE_ID"
			, CAST("MEX_EXT_SRC"."KEY_ATTRIBUTE_VARCHAR" AS VARCHAR) AS "CCCO"
			, CAST("MEX_EXT_SRC"."KEY_ATTRIBUTE_FLOAT" AS FLOAT) AS "CCAN8"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "CCNAME"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "CCALTC"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_NUMBER" AS NUMBER) AS "CCDFYJ"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "CCPNC"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "CCDOT1"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "CCCRYR"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "CCCRYC"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "CCDOT2"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "CCMCUA"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "CCMCUD"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "CCMCUC"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "CCMCUB"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "CCDPRC"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "CCBKTX"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "CCTXBM"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "CCTXBO"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_NUMBER" AS NUMBER) AS "CCNWXJ"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "CCGLIE"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "CCABIN"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "CCCALD"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "CCDTPN"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "CCPNF"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "CCDFF"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "CCCRCD"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "CCSMI"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "CCSMU"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "CCSMS"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "CCDNLT"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "CCSTMT"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "CCATCS"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "CCALGM"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "CCAGEM"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "CCCRDY"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "CCAGR1"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "CCAGR2"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "CCAGR3"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "CCAGR4"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "CCAGR5"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "CCAGR6"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "CCAGR7"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "CCFRY"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "CCFRP"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "CCNNP"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "CCFP"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "CCAGE"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_NUMBER" AS NUMBER) AS "CCDAG"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "CCARPN"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "CCAPPN"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_NUMBER" AS NUMBER) AS "CCARFJ"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_NUMBER" AS NUMBER) AS "CCAPFJ"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "CCSGBK"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "CCPTCO"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "CCX1"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "CCX2"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "CCUSER"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "CCPID"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_NUMBER" AS NUMBER) AS "CCUPMJ"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "CCJOBN"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "CCUPMT"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "CCTSID"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "CCTSCO"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_VARCHAR" AS VARCHAR) AS "CCTHCO"
			, CAST("MEX_EXT_SRC"."ATTRIBUTE_FLOAT" AS FLOAT) AS "CCAN8C"
		FROM {{ source('JDEDWARDS_MTD', 'MTD_EXCEPTION_RECORDS') }} "MEX_EXT_SRC"
	)
	, "CALCULATE_BK" AS 
	( 
		SELECT 
			  COALESCE("PREP_EXCEP"."LOAD_CYCLE_ID","LCI_SRC"."LOAD_CYCLE_ID") AS "LOAD_CYCLE_ID"
			, "LCI_SRC"."LOAD_DATE" AS "LOAD_DATE"
			, "LCI_SRC"."LOAD_DATE" AS "CDC_TIMESTAMP"
			, "PREP_EXCEP"."JRN_FLAG" AS "JRN_FLAG"
			, "PREP_EXCEP"."RECORD_TYPE" AS "RECORD_TYPE"
			, "PREP_EXCEP"."CCCO" AS "CCCO"
			, "PREP_EXCEP"."CCAN8" AS "CCAN8"
			, COALESCE(REPLACE(TRIM("PREP_EXCEP"."CCCO"),'\#','\\' || '\#'),"MEX_SRC"."KEY_ATTRIBUTE_VARCHAR") AS "CCCO_BK"
			, UPPER( TO_CHAR("PREP_EXCEP"."CCAN8")) AS "ABAN8_FK_CCAN8_BK"
			, "PREP_EXCEP"."CCNAME" AS "CCNAME"
			, "PREP_EXCEP"."CCALTC" AS "CCALTC"
			, "PREP_EXCEP"."CCDFYJ" AS "CCDFYJ"
			, "PREP_EXCEP"."CCPNC" AS "CCPNC"
			, "PREP_EXCEP"."CCDOT1" AS "CCDOT1"
			, "PREP_EXCEP"."CCCRYR" AS "CCCRYR"
			, "PREP_EXCEP"."CCCRYC" AS "CCCRYC"
			, "PREP_EXCEP"."CCDOT2" AS "CCDOT2"
			, "PREP_EXCEP"."CCMCUA" AS "CCMCUA"
			, "PREP_EXCEP"."CCMCUD" AS "CCMCUD"
			, "PREP_EXCEP"."CCMCUC" AS "CCMCUC"
			, "PREP_EXCEP"."CCMCUB" AS "CCMCUB"
			, "PREP_EXCEP"."CCDPRC" AS "CCDPRC"
			, "PREP_EXCEP"."CCBKTX" AS "CCBKTX"
			, "PREP_EXCEP"."CCTXBM" AS "CCTXBM"
			, "PREP_EXCEP"."CCTXBO" AS "CCTXBO"
			, "PREP_EXCEP"."CCNWXJ" AS "CCNWXJ"
			, "PREP_EXCEP"."CCGLIE" AS "CCGLIE"
			, "PREP_EXCEP"."CCABIN" AS "CCABIN"
			, "PREP_EXCEP"."CCCALD" AS "CCCALD"
			, "PREP_EXCEP"."CCDTPN" AS "CCDTPN"
			, "PREP_EXCEP"."CCPNF" AS "CCPNF"
			, "PREP_EXCEP"."CCDFF" AS "CCDFF"
			, "PREP_EXCEP"."CCCRCD" AS "CCCRCD"
			, "PREP_EXCEP"."CCSMI" AS "CCSMI"
			, "PREP_EXCEP"."CCSMU" AS "CCSMU"
			, "PREP_EXCEP"."CCSMS" AS "CCSMS"
			, "PREP_EXCEP"."CCDNLT" AS "CCDNLT"
			, "PREP_EXCEP"."CCSTMT" AS "CCSTMT"
			, "PREP_EXCEP"."CCATCS" AS "CCATCS"
			, "PREP_EXCEP"."CCALGM" AS "CCALGM"
			, "PREP_EXCEP"."CCAGEM" AS "CCAGEM"
			, "PREP_EXCEP"."CCCRDY" AS "CCCRDY"
			, "PREP_EXCEP"."CCAGR1" AS "CCAGR1"
			, "PREP_EXCEP"."CCAGR2" AS "CCAGR2"
			, "PREP_EXCEP"."CCAGR3" AS "CCAGR3"
			, "PREP_EXCEP"."CCAGR4" AS "CCAGR4"
			, "PREP_EXCEP"."CCAGR5" AS "CCAGR5"
			, "PREP_EXCEP"."CCAGR6" AS "CCAGR6"
			, "PREP_EXCEP"."CCAGR7" AS "CCAGR7"
			, "PREP_EXCEP"."CCFRY" AS "CCFRY"
			, "PREP_EXCEP"."CCFRP" AS "CCFRP"
			, "PREP_EXCEP"."CCNNP" AS "CCNNP"
			, "PREP_EXCEP"."CCFP" AS "CCFP"
			, "PREP_EXCEP"."CCAGE" AS "CCAGE"
			, "PREP_EXCEP"."CCDAG" AS "CCDAG"
			, "PREP_EXCEP"."CCARPN" AS "CCARPN"
			, "PREP_EXCEP"."CCAPPN" AS "CCAPPN"
			, "PREP_EXCEP"."CCARFJ" AS "CCARFJ"
			, "PREP_EXCEP"."CCAPFJ" AS "CCAPFJ"
			, "PREP_EXCEP"."CCSGBK" AS "CCSGBK"
			, "PREP_EXCEP"."CCPTCO" AS "CCPTCO"
			, "PREP_EXCEP"."CCX1" AS "CCX1"
			, "PREP_EXCEP"."CCX2" AS "CCX2"
			, "PREP_EXCEP"."CCUSER" AS "CCUSER"
			, "PREP_EXCEP"."CCPID" AS "CCPID"
			, "PREP_EXCEP"."CCUPMJ" AS "CCUPMJ"
			, "PREP_EXCEP"."CCJOBN" AS "CCJOBN"
			, "PREP_EXCEP"."CCUPMT" AS "CCUPMT"
			, "PREP_EXCEP"."CCTSID" AS "CCTSID"
			, "PREP_EXCEP"."CCTSCO" AS "CCTSCO"
			, "PREP_EXCEP"."CCTHCO" AS "CCTHCO"
			, "PREP_EXCEP"."CCAN8C" AS "CCAN8C"
		FROM "PREP_EXCEP" "PREP_EXCEP"
		INNER JOIN {{ source('JDEDWARDS_MTD', 'LOAD_CYCLE_INFO') }} "LCI_SRC" ON  1 = 1
		INNER JOIN {{ source('JDEDWARDS_MTD', 'MTD_EXCEPTION_RECORDS') }} "MEX_SRC" ON  1 = 1
		WHERE  "MEX_SRC"."RECORD_TYPE" = 'N'
	)
	SELECT 
		  "CALCULATE_BK"."LOAD_CYCLE_ID" AS "LOAD_CYCLE_ID"
		, "CALCULATE_BK"."LOAD_DATE" AS "LOAD_DATE"
		, "CALCULATE_BK"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP"
		, "CALCULATE_BK"."JRN_FLAG" AS "JRN_FLAG"
		, "CALCULATE_BK"."RECORD_TYPE" AS "RECORD_TYPE"
		, "CALCULATE_BK"."CCCO" AS "CCCO"
		, "CALCULATE_BK"."CCAN8" AS "CCAN8"
		, "CALCULATE_BK"."CCCO_BK" AS "CCCO_BK"
		, "CALCULATE_BK"."ABAN8_FK_CCAN8_BK" AS "ABAN8_FK_CCAN8_BK"
		, "CALCULATE_BK"."CCNAME" AS "CCNAME"
		, "CALCULATE_BK"."CCALTC" AS "CCALTC"
		, "CALCULATE_BK"."CCDFYJ" AS "CCDFYJ"
		, "CALCULATE_BK"."CCPNC" AS "CCPNC"
		, "CALCULATE_BK"."CCDOT1" AS "CCDOT1"
		, "CALCULATE_BK"."CCCRYR" AS "CCCRYR"
		, "CALCULATE_BK"."CCCRYC" AS "CCCRYC"
		, "CALCULATE_BK"."CCDOT2" AS "CCDOT2"
		, "CALCULATE_BK"."CCMCUA" AS "CCMCUA"
		, "CALCULATE_BK"."CCMCUD" AS "CCMCUD"
		, "CALCULATE_BK"."CCMCUC" AS "CCMCUC"
		, "CALCULATE_BK"."CCMCUB" AS "CCMCUB"
		, "CALCULATE_BK"."CCDPRC" AS "CCDPRC"
		, "CALCULATE_BK"."CCBKTX" AS "CCBKTX"
		, "CALCULATE_BK"."CCTXBM" AS "CCTXBM"
		, "CALCULATE_BK"."CCTXBO" AS "CCTXBO"
		, "CALCULATE_BK"."CCNWXJ" AS "CCNWXJ"
		, "CALCULATE_BK"."CCGLIE" AS "CCGLIE"
		, "CALCULATE_BK"."CCABIN" AS "CCABIN"
		, "CALCULATE_BK"."CCCALD" AS "CCCALD"
		, "CALCULATE_BK"."CCDTPN" AS "CCDTPN"
		, "CALCULATE_BK"."CCPNF" AS "CCPNF"
		, "CALCULATE_BK"."CCDFF" AS "CCDFF"
		, "CALCULATE_BK"."CCCRCD" AS "CCCRCD"
		, "CALCULATE_BK"."CCSMI" AS "CCSMI"
		, "CALCULATE_BK"."CCSMU" AS "CCSMU"
		, "CALCULATE_BK"."CCSMS" AS "CCSMS"
		, "CALCULATE_BK"."CCDNLT" AS "CCDNLT"
		, "CALCULATE_BK"."CCSTMT" AS "CCSTMT"
		, "CALCULATE_BK"."CCATCS" AS "CCATCS"
		, "CALCULATE_BK"."CCALGM" AS "CCALGM"
		, "CALCULATE_BK"."CCAGEM" AS "CCAGEM"
		, "CALCULATE_BK"."CCCRDY" AS "CCCRDY"
		, "CALCULATE_BK"."CCAGR1" AS "CCAGR1"
		, "CALCULATE_BK"."CCAGR2" AS "CCAGR2"
		, "CALCULATE_BK"."CCAGR3" AS "CCAGR3"
		, "CALCULATE_BK"."CCAGR4" AS "CCAGR4"
		, "CALCULATE_BK"."CCAGR5" AS "CCAGR5"
		, "CALCULATE_BK"."CCAGR6" AS "CCAGR6"
		, "CALCULATE_BK"."CCAGR7" AS "CCAGR7"
		, "CALCULATE_BK"."CCFRY" AS "CCFRY"
		, "CALCULATE_BK"."CCFRP" AS "CCFRP"
		, "CALCULATE_BK"."CCNNP" AS "CCNNP"
		, "CALCULATE_BK"."CCFP" AS "CCFP"
		, "CALCULATE_BK"."CCAGE" AS "CCAGE"
		, "CALCULATE_BK"."CCDAG" AS "CCDAG"
		, "CALCULATE_BK"."CCARPN" AS "CCARPN"
		, "CALCULATE_BK"."CCAPPN" AS "CCAPPN"
		, "CALCULATE_BK"."CCARFJ" AS "CCARFJ"
		, "CALCULATE_BK"."CCAPFJ" AS "CCAPFJ"
		, "CALCULATE_BK"."CCSGBK" AS "CCSGBK"
		, "CALCULATE_BK"."CCPTCO" AS "CCPTCO"
		, "CALCULATE_BK"."CCX1" AS "CCX1"
		, "CALCULATE_BK"."CCX2" AS "CCX2"
		, "CALCULATE_BK"."CCUSER" AS "CCUSER"
		, "CALCULATE_BK"."CCPID" AS "CCPID"
		, "CALCULATE_BK"."CCUPMJ" AS "CCUPMJ"
		, "CALCULATE_BK"."CCJOBN" AS "CCJOBN"
		, "CALCULATE_BK"."CCUPMT" AS "CCUPMT"
		, "CALCULATE_BK"."CCTSID" AS "CCTSID"
		, "CALCULATE_BK"."CCTSCO" AS "CCTSCO"
		, "CALCULATE_BK"."CCTHCO" AS "CCTHCO"
		, "CALCULATE_BK"."CCAN8C" AS "CCAN8C"
	FROM "CALCULATE_BK" "CALCULATE_BK"

) final 
where '{{ var("load_type") }}' = 'INIT' and '{{ var("source") }}' = 'JDEDWARDS'