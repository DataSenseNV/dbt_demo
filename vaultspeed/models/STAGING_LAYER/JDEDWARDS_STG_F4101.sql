{{
	config(
		materialized='incremental',
		pre_hook= [
			'{% if var("load_type") == "INCR" and var("source") == "JDEDWARDS" %} TRUNCATE TABLE {{ this }}; {% endif %}',
			'{% if var("load_type") == "INIT" and var("source") == "JDEDWARDS" %} TRUNCATE TABLE {{ this }}; {% endif %}'
		],
		alias='F4101',
		schema='JDEDWARDS_STG',
		tags=['JDEDWARDS', 'STG_JDE_ITEMMASTER_INCR', 'STG_JDE_ITEMMASTER_INIT']
	)
}}
select * from (
	SELECT 
		  UPPER(MD5_HEX( 'JDE' || '\#' || "EXT_SRC"."IMITM_BK" || '\#' )) AS "PRODUCT_HKEY"
		, "EXT_SRC"."LOAD_DATE" AS "LOAD_DATE"
		, "EXT_SRC"."LOAD_CYCLE_ID" AS "LOAD_CYCLE_ID"
		, 'JDE' AS "SRC_BK"
		, "EXT_SRC"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP"
		, "EXT_SRC"."JRN_FLAG" AS "JRN_FLAG"
		, "EXT_SRC"."RECORD_TYPE" AS "RECORD_TYPE"
		, "EXT_SRC"."IMITM" AS "IMITM"
		, "EXT_SRC"."IMITM_BK" AS "PRODUCT_BK"
		, "EXT_SRC"."IMLITM" AS "IMLITM"
		, "EXT_SRC"."IMAITM" AS "IMAITM"
		, "EXT_SRC"."IMDSC1" AS "IMDSC1"
		, "EXT_SRC"."IMDSC2" AS "IMDSC2"
		, "EXT_SRC"."IMSRTX" AS "IMSRTX"
		, "EXT_SRC"."IMALN" AS "IMALN"
		, "EXT_SRC"."IMSRP1" AS "IMSRP1"
		, "EXT_SRC"."IMSRP2" AS "IMSRP2"
		, "EXT_SRC"."IMSRP3" AS "IMSRP3"
		, "EXT_SRC"."IMSRP4" AS "IMSRP4"
		, "EXT_SRC"."IMSRP5" AS "IMSRP5"
		, "EXT_SRC"."IMSRP6" AS "IMSRP6"
		, "EXT_SRC"."IMSRP7" AS "IMSRP7"
		, "EXT_SRC"."IMSRP8" AS "IMSRP8"
		, "EXT_SRC"."IMSRP9" AS "IMSRP9"
		, "EXT_SRC"."IMSRP0" AS "IMSRP0"
		, "EXT_SRC"."IMPRP1" AS "IMPRP1"
		, "EXT_SRC"."IMPRP2" AS "IMPRP2"
		, "EXT_SRC"."IMPRP3" AS "IMPRP3"
		, "EXT_SRC"."IMPRP4" AS "IMPRP4"
		, "EXT_SRC"."IMPRP5" AS "IMPRP5"
		, "EXT_SRC"."IMPRP6" AS "IMPRP6"
		, "EXT_SRC"."IMPRP7" AS "IMPRP7"
		, "EXT_SRC"."IMPRP8" AS "IMPRP8"
		, "EXT_SRC"."IMPRP9" AS "IMPRP9"
		, "EXT_SRC"."IMPRP0" AS "IMPRP0"
		, "EXT_SRC"."IMCDCD" AS "IMCDCD"
		, "EXT_SRC"."IMPDGR" AS "IMPDGR"
		, "EXT_SRC"."IMDSGP" AS "IMDSGP"
		, "EXT_SRC"."IMPRGR" AS "IMPRGR"
		, "EXT_SRC"."IMRPRC" AS "IMRPRC"
		, "EXT_SRC"."IMORPR" AS "IMORPR"
		, "EXT_SRC"."IMBUYR" AS "IMBUYR"
		, "EXT_SRC"."IMDRAW" AS "IMDRAW"
		, "EXT_SRC"."IMRVNO" AS "IMRVNO"
		, "EXT_SRC"."IMDSZE" AS "IMDSZE"
		, "EXT_SRC"."IMVCUD" AS "IMVCUD"
		, "EXT_SRC"."IMCARS" AS "IMCARS"
		, "EXT_SRC"."IMCARP" AS "IMCARP"
		, "EXT_SRC"."IMSHCN" AS "IMSHCN"
		, "EXT_SRC"."IMSHCM" AS "IMSHCM"
		, "EXT_SRC"."IMUOM1" AS "IMUOM1"
		, "EXT_SRC"."IMUOM2" AS "IMUOM2"
		, "EXT_SRC"."IMUOM3" AS "IMUOM3"
		, "EXT_SRC"."IMUOM4" AS "IMUOM4"
		, "EXT_SRC"."IMUOM6" AS "IMUOM6"
		, "EXT_SRC"."IMUOM8" AS "IMUOM8"
		, "EXT_SRC"."IMUOM9" AS "IMUOM9"
		, "EXT_SRC"."IMUWUM" AS "IMUWUM"
		, "EXT_SRC"."IMUVM1" AS "IMUVM1"
		, "EXT_SRC"."IMSUTM" AS "IMSUTM"
		, "EXT_SRC"."IMUMVW" AS "IMUMVW"
		, "EXT_SRC"."IMCYCL" AS "IMCYCL"
		, "EXT_SRC"."IMGLPT" AS "IMGLPT"
		, "EXT_SRC"."IMPLEV" AS "IMPLEV"
		, "EXT_SRC"."IMPPLV" AS "IMPPLV"
		, "EXT_SRC"."IMCLEV" AS "IMCLEV"
		, "EXT_SRC"."IMPRPO" AS "IMPRPO"
		, "EXT_SRC"."IMCKAV" AS "IMCKAV"
		, "EXT_SRC"."IMBPFG" AS "IMBPFG"
		, "EXT_SRC"."IMSRCE" AS "IMSRCE"
		, "EXT_SRC"."IMOT1Y" AS "IMOT1Y"
		, "EXT_SRC"."IMOT2Y" AS "IMOT2Y"
		, "EXT_SRC"."IMSTDP" AS "IMSTDP"
		, "EXT_SRC"."IMFRMP" AS "IMFRMP"
		, "EXT_SRC"."IMTHRP" AS "IMTHRP"
		, "EXT_SRC"."IMSTDG" AS "IMSTDG"
		, "EXT_SRC"."IMFRGD" AS "IMFRGD"
		, "EXT_SRC"."IMTHGD" AS "IMTHGD"
		, "EXT_SRC"."IMCOTY" AS "IMCOTY"
		, "EXT_SRC"."IMSTKT" AS "IMSTKT"
		, "EXT_SRC"."IMLNTY" AS "IMLNTY"
		, "EXT_SRC"."IMCONT" AS "IMCONT"
		, "EXT_SRC"."IMBACK" AS "IMBACK"
		, "EXT_SRC"."IMIFLA" AS "IMIFLA"
		, "EXT_SRC"."IMTFLA" AS "IMTFLA"
		, "EXT_SRC"."IMINMG" AS "IMINMG"
		, "EXT_SRC"."IMABCS" AS "IMABCS"
		, "EXT_SRC"."IMABCM" AS "IMABCM"
		, "EXT_SRC"."IMABCI" AS "IMABCI"
		, "EXT_SRC"."IMOVR" AS "IMOVR"
		, "EXT_SRC"."IMWARR" AS "IMWARR"
		, "EXT_SRC"."IMCMCG" AS "IMCMCG"
		, "EXT_SRC"."IMSRNR" AS "IMSRNR"
		, "EXT_SRC"."IMPMTH" AS "IMPMTH"
		, "EXT_SRC"."IMFIFO" AS "IMFIFO"
		, "EXT_SRC"."IMLOTS" AS "IMLOTS"
		, "EXT_SRC"."IMSLD" AS "IMSLD"
		, "EXT_SRC"."IMANPL" AS "IMANPL"
		, "EXT_SRC"."IMMPST" AS "IMMPST"
		, "EXT_SRC"."IMPCTM" AS "IMPCTM"
		, "EXT_SRC"."IMMMPC" AS "IMMMPC"
		, "EXT_SRC"."IMPTSC" AS "IMPTSC"
		, "EXT_SRC"."IMSNS" AS "IMSNS"
		, "EXT_SRC"."IMLTLV" AS "IMLTLV"
		, "EXT_SRC"."IMLTMF" AS "IMLTMF"
		, "EXT_SRC"."IMLTCM" AS "IMLTCM"
		, "EXT_SRC"."IMOPC" AS "IMOPC"
		, "EXT_SRC"."IMOPV" AS "IMOPV"
		, "EXT_SRC"."IMACQ" AS "IMACQ"
		, "EXT_SRC"."IMMLQ" AS "IMMLQ"
		, "EXT_SRC"."IMLTPU" AS "IMLTPU"
		, "EXT_SRC"."IMMPSP" AS "IMMPSP"
		, "EXT_SRC"."IMMRPP" AS "IMMRPP"
		, "EXT_SRC"."IMITC" AS "IMITC"
		, "EXT_SRC"."IMORDW" AS "IMORDW"
		, "EXT_SRC"."IMMTF1" AS "IMMTF1"
		, "EXT_SRC"."IMMTF2" AS "IMMTF2"
		, "EXT_SRC"."IMMTF3" AS "IMMTF3"
		, "EXT_SRC"."IMMTF4" AS "IMMTF4"
		, "EXT_SRC"."IMMTF5" AS "IMMTF5"
		, "EXT_SRC"."IMEXPD" AS "IMEXPD"
		, "EXT_SRC"."IMDEFD" AS "IMDEFD"
		, "EXT_SRC"."IMSFLT" AS "IMSFLT"
		, "EXT_SRC"."IMMAKE" AS "IMMAKE"
		, "EXT_SRC"."IMCOBY" AS "IMCOBY"
		, "EXT_SRC"."IMLLX" AS "IMLLX"
		, "EXT_SRC"."IMCMGL" AS "IMCMGL"
		, "EXT_SRC"."IMCOMH" AS "IMCOMH"
		, "EXT_SRC"."IMURCD" AS "IMURCD"
		, "EXT_SRC"."IMURDT" AS "IMURDT"
		, "EXT_SRC"."IMURAT" AS "IMURAT"
		, "EXT_SRC"."IMURAB" AS "IMURAB"
		, "EXT_SRC"."IMURRF" AS "IMURRF"
		, "EXT_SRC"."IMUSER" AS "IMUSER"
		, "EXT_SRC"."IMPID" AS "IMPID"
		, "EXT_SRC"."IMJOBN" AS "IMJOBN"
		, "EXT_SRC"."IMUPMJ" AS "IMUPMJ"
		, "EXT_SRC"."IMTDAY" AS "IMTDAY"
		, "EXT_SRC"."IMUPCN" AS "IMUPCN"
		, "EXT_SRC"."IMSCC0" AS "IMSCC0"
		, "EXT_SRC"."IMUMUP" AS "IMUMUP"
		, "EXT_SRC"."IMUMDF" AS "IMUMDF"
		, "EXT_SRC"."IMUMS0" AS "IMUMS0"
		, "EXT_SRC"."IMUMS1" AS "IMUMS1"
		, "EXT_SRC"."IMUMS2" AS "IMUMS2"
		, "EXT_SRC"."IMUMS3" AS "IMUMS3"
		, "EXT_SRC"."IMUMS4" AS "IMUMS4"
		, "EXT_SRC"."IMUMS5" AS "IMUMS5"
		, "EXT_SRC"."IMUMS6" AS "IMUMS6"
		, "EXT_SRC"."IMUMS7" AS "IMUMS7"
		, "EXT_SRC"."IMUMS8" AS "IMUMS8"
		, "EXT_SRC"."IMPOC" AS "IMPOC"
		, "EXT_SRC"."IMAVRT" AS "IMAVRT"
		, "EXT_SRC"."IMEQTY" AS "IMEQTY"
		, "EXT_SRC"."IMWTRQ" AS "IMWTRQ"
		, "EXT_SRC"."IMTMPL" AS "IMTMPL"
		, "EXT_SRC"."IMSEG1" AS "IMSEG1"
		, "EXT_SRC"."IMSEG2" AS "IMSEG2"
		, "EXT_SRC"."IMSEG3" AS "IMSEG3"
		, "EXT_SRC"."IMSEG4" AS "IMSEG4"
		, "EXT_SRC"."IMSEG5" AS "IMSEG5"
		, "EXT_SRC"."IMSEG6" AS "IMSEG6"
		, "EXT_SRC"."IMSEG7" AS "IMSEG7"
		, "EXT_SRC"."IMSEG8" AS "IMSEG8"
		, "EXT_SRC"."IMSEG9" AS "IMSEG9"
		, "EXT_SRC"."IMSEG0" AS "IMSEG0"
		, "EXT_SRC"."IMMIC" AS "IMMIC"
		, "EXT_SRC"."IMAING" AS "IMAING"
		, "EXT_SRC"."IMBBDD" AS "IMBBDD"
		, "EXT_SRC"."IMCMDM" AS "IMCMDM"
		, "EXT_SRC"."IMLECM" AS "IMLECM"
		, "EXT_SRC"."IMLEDD" AS "IMLEDD"
		, "EXT_SRC"."IMPEFD" AS "IMPEFD"
		, "EXT_SRC"."IMSBDD" AS "IMSBDD"
		, "EXT_SRC"."IMU1DD" AS "IMU1DD"
		, "EXT_SRC"."IMU2DD" AS "IMU2DD"
		, "EXT_SRC"."IMU3DD" AS "IMU3DD"
		, "EXT_SRC"."IMU4DD" AS "IMU4DD"
		, "EXT_SRC"."IMU5DD" AS "IMU5DD"
		, "EXT_SRC"."IMDLTL" AS "IMDLTL"
		, "EXT_SRC"."IMDPPO" AS "IMDPPO"
		, "EXT_SRC"."IMDUAL" AS "IMDUAL"
		, "EXT_SRC"."IMXDCK" AS "IMXDCK"
		, "EXT_SRC"."IMLAF" AS "IMLAF"
		, "EXT_SRC"."IMLTFM" AS "IMLTFM"
		, "EXT_SRC"."IMRWLA" AS "IMRWLA"
		, "EXT_SRC"."IMLNPA" AS "IMLNPA"
		, "EXT_SRC"."IMLOTC" AS "IMLOTC"
		, "EXT_SRC"."IMAPSC" AS "IMAPSC"
		, "EXT_SRC"."IMAUOM" AS "IMAUOM"
		, "EXT_SRC"."IMCONB" AS "IMCONB"
		, "EXT_SRC"."IMGCMP" AS "IMGCMP"
		, "EXT_SRC"."IMPRI1" AS "IMPRI1"
		, "EXT_SRC"."IMPRI2" AS "IMPRI2"
		, "EXT_SRC"."IMASHL" AS "IMASHL"
		, "EXT_SRC"."IMVMINV" AS "IMVMINV"
		, "EXT_SRC"."IMCMETH" AS "IMCMETH"
		, "EXT_SRC"."IMEXPI" AS "IMEXPI"
		, "EXT_SRC"."IMOPTH" AS "IMOPTH"
		, "EXT_SRC"."IMCUTH" AS "IMCUTH"
		, "EXT_SRC"."IMUMTH" AS "IMUMTH"
		, "EXT_SRC"."IMLMFG" AS "IMLMFG"
		, "EXT_SRC"."IMLINE" AS "IMLINE"
		, "EXT_SRC"."IMDFTPCT" AS "IMDFTPCT"
		, "EXT_SRC"."IMKBIT" AS "IMKBIT"
		, "EXT_SRC"."IMDFENDITM" AS "IMDFENDITM"
		, "EXT_SRC"."IMKANEXLL" AS "IMKANEXLL"
		, "EXT_SRC"."IMSCPSELL" AS "IMSCPSELL"
		, "EXT_SRC"."IMMOPTH" AS "IMMOPTH"
		, "EXT_SRC"."IMMCUTH" AS "IMMCUTH"
		, "EXT_SRC"."IMCUMTH" AS "IMCUMTH"
		, "EXT_SRC"."IMATPRN" AS "IMATPRN"
		, "EXT_SRC"."IMATPCA" AS "IMATPCA"
		, "EXT_SRC"."IMATPAC" AS "IMATPAC"
		, "EXT_SRC"."IMCOORE" AS "IMCOORE"
		, "EXT_SRC"."IMVCPFC" AS "IMVCPFC"
		, "EXT_SRC"."IMPNYN" AS "IMPNYN"
	FROM {{ ref('JDEDWARDS_EXT_F4101') }} "EXT_SRC"
	INNER JOIN {{ source('JDEDWARDS_MTD', 'MTD_EXCEPTION_RECORDS') }} "MEX_SRC" ON  "MEX_SRC"."RECORD_TYPE" = 'U'

) final 
where '{{ var("load_type") }}' = 'INCR' and '{{ var("source") }}' = 'JDEDWARDS'

UNION ALL

select * from (
	SELECT 
		  UPPER(MD5_HEX( 'JDE' || '\#' || "EXT_SRC"."IMITM_BK" || '\#' )) AS "PRODUCT_HKEY"
		, "EXT_SRC"."LOAD_DATE" AS "LOAD_DATE"
		, "EXT_SRC"."LOAD_CYCLE_ID" AS "LOAD_CYCLE_ID"
		, 'JDE' AS "SRC_BK"
		, "EXT_SRC"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP"
		, "EXT_SRC"."JRN_FLAG" AS "JRN_FLAG"
		, "EXT_SRC"."RECORD_TYPE" AS "RECORD_TYPE"
		, "EXT_SRC"."IMITM" AS "IMITM"
		, "EXT_SRC"."IMITM_BK" AS "PRODUCT_BK"
		, "EXT_SRC"."IMLITM" AS "IMLITM"
		, "EXT_SRC"."IMAITM" AS "IMAITM"
		, "EXT_SRC"."IMDSC1" AS "IMDSC1"
		, "EXT_SRC"."IMDSC2" AS "IMDSC2"
		, "EXT_SRC"."IMSRTX" AS "IMSRTX"
		, "EXT_SRC"."IMALN" AS "IMALN"
		, "EXT_SRC"."IMSRP1" AS "IMSRP1"
		, "EXT_SRC"."IMSRP2" AS "IMSRP2"
		, "EXT_SRC"."IMSRP3" AS "IMSRP3"
		, "EXT_SRC"."IMSRP4" AS "IMSRP4"
		, "EXT_SRC"."IMSRP5" AS "IMSRP5"
		, "EXT_SRC"."IMSRP6" AS "IMSRP6"
		, "EXT_SRC"."IMSRP7" AS "IMSRP7"
		, "EXT_SRC"."IMSRP8" AS "IMSRP8"
		, "EXT_SRC"."IMSRP9" AS "IMSRP9"
		, "EXT_SRC"."IMSRP0" AS "IMSRP0"
		, "EXT_SRC"."IMPRP1" AS "IMPRP1"
		, "EXT_SRC"."IMPRP2" AS "IMPRP2"
		, "EXT_SRC"."IMPRP3" AS "IMPRP3"
		, "EXT_SRC"."IMPRP4" AS "IMPRP4"
		, "EXT_SRC"."IMPRP5" AS "IMPRP5"
		, "EXT_SRC"."IMPRP6" AS "IMPRP6"
		, "EXT_SRC"."IMPRP7" AS "IMPRP7"
		, "EXT_SRC"."IMPRP8" AS "IMPRP8"
		, "EXT_SRC"."IMPRP9" AS "IMPRP9"
		, "EXT_SRC"."IMPRP0" AS "IMPRP0"
		, "EXT_SRC"."IMCDCD" AS "IMCDCD"
		, "EXT_SRC"."IMPDGR" AS "IMPDGR"
		, "EXT_SRC"."IMDSGP" AS "IMDSGP"
		, "EXT_SRC"."IMPRGR" AS "IMPRGR"
		, "EXT_SRC"."IMRPRC" AS "IMRPRC"
		, "EXT_SRC"."IMORPR" AS "IMORPR"
		, "EXT_SRC"."IMBUYR" AS "IMBUYR"
		, "EXT_SRC"."IMDRAW" AS "IMDRAW"
		, "EXT_SRC"."IMRVNO" AS "IMRVNO"
		, "EXT_SRC"."IMDSZE" AS "IMDSZE"
		, "EXT_SRC"."IMVCUD" AS "IMVCUD"
		, "EXT_SRC"."IMCARS" AS "IMCARS"
		, "EXT_SRC"."IMCARP" AS "IMCARP"
		, "EXT_SRC"."IMSHCN" AS "IMSHCN"
		, "EXT_SRC"."IMSHCM" AS "IMSHCM"
		, "EXT_SRC"."IMUOM1" AS "IMUOM1"
		, "EXT_SRC"."IMUOM2" AS "IMUOM2"
		, "EXT_SRC"."IMUOM3" AS "IMUOM3"
		, "EXT_SRC"."IMUOM4" AS "IMUOM4"
		, "EXT_SRC"."IMUOM6" AS "IMUOM6"
		, "EXT_SRC"."IMUOM8" AS "IMUOM8"
		, "EXT_SRC"."IMUOM9" AS "IMUOM9"
		, "EXT_SRC"."IMUWUM" AS "IMUWUM"
		, "EXT_SRC"."IMUVM1" AS "IMUVM1"
		, "EXT_SRC"."IMSUTM" AS "IMSUTM"
		, "EXT_SRC"."IMUMVW" AS "IMUMVW"
		, "EXT_SRC"."IMCYCL" AS "IMCYCL"
		, "EXT_SRC"."IMGLPT" AS "IMGLPT"
		, "EXT_SRC"."IMPLEV" AS "IMPLEV"
		, "EXT_SRC"."IMPPLV" AS "IMPPLV"
		, "EXT_SRC"."IMCLEV" AS "IMCLEV"
		, "EXT_SRC"."IMPRPO" AS "IMPRPO"
		, "EXT_SRC"."IMCKAV" AS "IMCKAV"
		, "EXT_SRC"."IMBPFG" AS "IMBPFG"
		, "EXT_SRC"."IMSRCE" AS "IMSRCE"
		, "EXT_SRC"."IMOT1Y" AS "IMOT1Y"
		, "EXT_SRC"."IMOT2Y" AS "IMOT2Y"
		, "EXT_SRC"."IMSTDP" AS "IMSTDP"
		, "EXT_SRC"."IMFRMP" AS "IMFRMP"
		, "EXT_SRC"."IMTHRP" AS "IMTHRP"
		, "EXT_SRC"."IMSTDG" AS "IMSTDG"
		, "EXT_SRC"."IMFRGD" AS "IMFRGD"
		, "EXT_SRC"."IMTHGD" AS "IMTHGD"
		, "EXT_SRC"."IMCOTY" AS "IMCOTY"
		, "EXT_SRC"."IMSTKT" AS "IMSTKT"
		, "EXT_SRC"."IMLNTY" AS "IMLNTY"
		, "EXT_SRC"."IMCONT" AS "IMCONT"
		, "EXT_SRC"."IMBACK" AS "IMBACK"
		, "EXT_SRC"."IMIFLA" AS "IMIFLA"
		, "EXT_SRC"."IMTFLA" AS "IMTFLA"
		, "EXT_SRC"."IMINMG" AS "IMINMG"
		, "EXT_SRC"."IMABCS" AS "IMABCS"
		, "EXT_SRC"."IMABCM" AS "IMABCM"
		, "EXT_SRC"."IMABCI" AS "IMABCI"
		, "EXT_SRC"."IMOVR" AS "IMOVR"
		, "EXT_SRC"."IMWARR" AS "IMWARR"
		, "EXT_SRC"."IMCMCG" AS "IMCMCG"
		, "EXT_SRC"."IMSRNR" AS "IMSRNR"
		, "EXT_SRC"."IMPMTH" AS "IMPMTH"
		, "EXT_SRC"."IMFIFO" AS "IMFIFO"
		, "EXT_SRC"."IMLOTS" AS "IMLOTS"
		, "EXT_SRC"."IMSLD" AS "IMSLD"
		, "EXT_SRC"."IMANPL" AS "IMANPL"
		, "EXT_SRC"."IMMPST" AS "IMMPST"
		, "EXT_SRC"."IMPCTM" AS "IMPCTM"
		, "EXT_SRC"."IMMMPC" AS "IMMMPC"
		, "EXT_SRC"."IMPTSC" AS "IMPTSC"
		, "EXT_SRC"."IMSNS" AS "IMSNS"
		, "EXT_SRC"."IMLTLV" AS "IMLTLV"
		, "EXT_SRC"."IMLTMF" AS "IMLTMF"
		, "EXT_SRC"."IMLTCM" AS "IMLTCM"
		, "EXT_SRC"."IMOPC" AS "IMOPC"
		, "EXT_SRC"."IMOPV" AS "IMOPV"
		, "EXT_SRC"."IMACQ" AS "IMACQ"
		, "EXT_SRC"."IMMLQ" AS "IMMLQ"
		, "EXT_SRC"."IMLTPU" AS "IMLTPU"
		, "EXT_SRC"."IMMPSP" AS "IMMPSP"
		, "EXT_SRC"."IMMRPP" AS "IMMRPP"
		, "EXT_SRC"."IMITC" AS "IMITC"
		, "EXT_SRC"."IMORDW" AS "IMORDW"
		, "EXT_SRC"."IMMTF1" AS "IMMTF1"
		, "EXT_SRC"."IMMTF2" AS "IMMTF2"
		, "EXT_SRC"."IMMTF3" AS "IMMTF3"
		, "EXT_SRC"."IMMTF4" AS "IMMTF4"
		, "EXT_SRC"."IMMTF5" AS "IMMTF5"
		, "EXT_SRC"."IMEXPD" AS "IMEXPD"
		, "EXT_SRC"."IMDEFD" AS "IMDEFD"
		, "EXT_SRC"."IMSFLT" AS "IMSFLT"
		, "EXT_SRC"."IMMAKE" AS "IMMAKE"
		, "EXT_SRC"."IMCOBY" AS "IMCOBY"
		, "EXT_SRC"."IMLLX" AS "IMLLX"
		, "EXT_SRC"."IMCMGL" AS "IMCMGL"
		, "EXT_SRC"."IMCOMH" AS "IMCOMH"
		, "EXT_SRC"."IMURCD" AS "IMURCD"
		, "EXT_SRC"."IMURDT" AS "IMURDT"
		, "EXT_SRC"."IMURAT" AS "IMURAT"
		, "EXT_SRC"."IMURAB" AS "IMURAB"
		, "EXT_SRC"."IMURRF" AS "IMURRF"
		, "EXT_SRC"."IMUSER" AS "IMUSER"
		, "EXT_SRC"."IMPID" AS "IMPID"
		, "EXT_SRC"."IMJOBN" AS "IMJOBN"
		, "EXT_SRC"."IMUPMJ" AS "IMUPMJ"
		, "EXT_SRC"."IMTDAY" AS "IMTDAY"
		, "EXT_SRC"."IMUPCN" AS "IMUPCN"
		, "EXT_SRC"."IMSCC0" AS "IMSCC0"
		, "EXT_SRC"."IMUMUP" AS "IMUMUP"
		, "EXT_SRC"."IMUMDF" AS "IMUMDF"
		, "EXT_SRC"."IMUMS0" AS "IMUMS0"
		, "EXT_SRC"."IMUMS1" AS "IMUMS1"
		, "EXT_SRC"."IMUMS2" AS "IMUMS2"
		, "EXT_SRC"."IMUMS3" AS "IMUMS3"
		, "EXT_SRC"."IMUMS4" AS "IMUMS4"
		, "EXT_SRC"."IMUMS5" AS "IMUMS5"
		, "EXT_SRC"."IMUMS6" AS "IMUMS6"
		, "EXT_SRC"."IMUMS7" AS "IMUMS7"
		, "EXT_SRC"."IMUMS8" AS "IMUMS8"
		, "EXT_SRC"."IMPOC" AS "IMPOC"
		, "EXT_SRC"."IMAVRT" AS "IMAVRT"
		, "EXT_SRC"."IMEQTY" AS "IMEQTY"
		, "EXT_SRC"."IMWTRQ" AS "IMWTRQ"
		, "EXT_SRC"."IMTMPL" AS "IMTMPL"
		, "EXT_SRC"."IMSEG1" AS "IMSEG1"
		, "EXT_SRC"."IMSEG2" AS "IMSEG2"
		, "EXT_SRC"."IMSEG3" AS "IMSEG3"
		, "EXT_SRC"."IMSEG4" AS "IMSEG4"
		, "EXT_SRC"."IMSEG5" AS "IMSEG5"
		, "EXT_SRC"."IMSEG6" AS "IMSEG6"
		, "EXT_SRC"."IMSEG7" AS "IMSEG7"
		, "EXT_SRC"."IMSEG8" AS "IMSEG8"
		, "EXT_SRC"."IMSEG9" AS "IMSEG9"
		, "EXT_SRC"."IMSEG0" AS "IMSEG0"
		, "EXT_SRC"."IMMIC" AS "IMMIC"
		, "EXT_SRC"."IMAING" AS "IMAING"
		, "EXT_SRC"."IMBBDD" AS "IMBBDD"
		, "EXT_SRC"."IMCMDM" AS "IMCMDM"
		, "EXT_SRC"."IMLECM" AS "IMLECM"
		, "EXT_SRC"."IMLEDD" AS "IMLEDD"
		, "EXT_SRC"."IMPEFD" AS "IMPEFD"
		, "EXT_SRC"."IMSBDD" AS "IMSBDD"
		, "EXT_SRC"."IMU1DD" AS "IMU1DD"
		, "EXT_SRC"."IMU2DD" AS "IMU2DD"
		, "EXT_SRC"."IMU3DD" AS "IMU3DD"
		, "EXT_SRC"."IMU4DD" AS "IMU4DD"
		, "EXT_SRC"."IMU5DD" AS "IMU5DD"
		, "EXT_SRC"."IMDLTL" AS "IMDLTL"
		, "EXT_SRC"."IMDPPO" AS "IMDPPO"
		, "EXT_SRC"."IMDUAL" AS "IMDUAL"
		, "EXT_SRC"."IMXDCK" AS "IMXDCK"
		, "EXT_SRC"."IMLAF" AS "IMLAF"
		, "EXT_SRC"."IMLTFM" AS "IMLTFM"
		, "EXT_SRC"."IMRWLA" AS "IMRWLA"
		, "EXT_SRC"."IMLNPA" AS "IMLNPA"
		, "EXT_SRC"."IMLOTC" AS "IMLOTC"
		, "EXT_SRC"."IMAPSC" AS "IMAPSC"
		, "EXT_SRC"."IMAUOM" AS "IMAUOM"
		, "EXT_SRC"."IMCONB" AS "IMCONB"
		, "EXT_SRC"."IMGCMP" AS "IMGCMP"
		, "EXT_SRC"."IMPRI1" AS "IMPRI1"
		, "EXT_SRC"."IMPRI2" AS "IMPRI2"
		, "EXT_SRC"."IMASHL" AS "IMASHL"
		, "EXT_SRC"."IMVMINV" AS "IMVMINV"
		, "EXT_SRC"."IMCMETH" AS "IMCMETH"
		, "EXT_SRC"."IMEXPI" AS "IMEXPI"
		, "EXT_SRC"."IMOPTH" AS "IMOPTH"
		, "EXT_SRC"."IMCUTH" AS "IMCUTH"
		, "EXT_SRC"."IMUMTH" AS "IMUMTH"
		, "EXT_SRC"."IMLMFG" AS "IMLMFG"
		, "EXT_SRC"."IMLINE" AS "IMLINE"
		, "EXT_SRC"."IMDFTPCT" AS "IMDFTPCT"
		, "EXT_SRC"."IMKBIT" AS "IMKBIT"
		, "EXT_SRC"."IMDFENDITM" AS "IMDFENDITM"
		, "EXT_SRC"."IMKANEXLL" AS "IMKANEXLL"
		, "EXT_SRC"."IMSCPSELL" AS "IMSCPSELL"
		, "EXT_SRC"."IMMOPTH" AS "IMMOPTH"
		, "EXT_SRC"."IMMCUTH" AS "IMMCUTH"
		, "EXT_SRC"."IMCUMTH" AS "IMCUMTH"
		, "EXT_SRC"."IMATPRN" AS "IMATPRN"
		, "EXT_SRC"."IMATPCA" AS "IMATPCA"
		, "EXT_SRC"."IMATPAC" AS "IMATPAC"
		, "EXT_SRC"."IMCOORE" AS "IMCOORE"
		, "EXT_SRC"."IMVCPFC" AS "IMVCPFC"
		, "EXT_SRC"."IMPNYN" AS "IMPNYN"
	FROM {{ ref('JDEDWARDS_EXT_F4101') }} "EXT_SRC"
	INNER JOIN {{ source('JDEDWARDS_MTD', 'MTD_EXCEPTION_RECORDS') }} "MEX_SRC" ON  "MEX_SRC"."RECORD_TYPE" = 'U'

) final 
where '{{ var("load_type") }}' = 'INIT' and '{{ var("source") }}' = 'JDEDWARDS'